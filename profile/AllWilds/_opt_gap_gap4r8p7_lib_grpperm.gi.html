<!DOCTYPE html><script src="sorttable.js"></script><html><body>
<style>
table { border-collapse: collapse }
tr:nth-child(odd)  { background-color: #EEE; }
tr:nth-child(even)  { background-color: #FFF; }
tr:nth-child(odd).exec  { background-color: #0F0; }
tr:nth-child(even).exec  { background-color: #3F3; }
tr:nth-child(odd).missed  { background-color: #F00; }
tr:nth-child(even).missed  { background-color: #F33; }
td, th {
    border: 1px solid #98bf21;
    padding: 3px 7px 2px 7px;
}
th {
    font-size: 1.1em;
    text-align: left;
    padding-top: 5px;
    padding-bottom: 4px;
    background-color: #A7C942;
    color: #ffffff;
}
table.sortable th:not(.sorttable_sorted):not(.sorttable_sorted_reverse):not(.sorttable_nosort):after {
    content: " \25B4\25BE"
}

/* HSV gradient made using http://www.perbang.dk/rgbgradient/ */
td.coverage00 { background-color: #FF0000; }
td.coverage10 { background-color: #F83100; }
td.coverage20 { background-color: #F25F00; }
td.coverage30 { background-color: #EB8B00; }
td.coverage40 { background-color: #E5B500; }
td.coverage50 { background-color: #DFDC00; }
td.coverage60 { background-color: #B0D800; }
td.coverage70 { background-color: #81D200; }
td.coverage80 { background-color: #55CB00; }
td.coverage90 { background-color: #2CC500; }
td.coverage100 { background-color: #04BF00; }
td:nth-child(1) { text-align: right; }
td:nth-child(2) { text-align: right; }
td:nth-child(3) { text-align: right; }
td:nth-child(4) { text-align: right; }
</style><p>This file was read by GAP before profiling was actived, so lines which were not read but not executed are not marked.</p><table class="sortable">
<thead><tr><th>Line</th><th>Execs</th><th>Time</th><th>Time+Childs</th><th>Code</th><th>Called Functions</th>
</tr></thead>
<tbody>
<tr class='ignore'><td><a name="line1"></a>1</td><td></td><td></td><td></td><td><span><tt>############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2"></a>2</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3"></a>3</td><td></td><td></td><td></td><td><span><tt>#W&nbsp;&nbsp;grpperm.gi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GAP&nbsp;library&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Heiko&nbsp;Theißen
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4"></a>4</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5"></a>5</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line6"></a>6</td><td></td><td></td><td></td><td><span><tt>#Y&nbsp;&nbsp;Copyright&nbsp;(C)&nbsp;&nbsp;1996,&nbsp;&nbsp;Lehrstuhl&nbsp;D&nbsp;für&nbsp;Mathematik,&nbsp;&nbsp;RWTH&nbsp;Aachen,&nbsp;&nbsp;Germany
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line7"></a>7</td><td></td><td></td><td></td><td><span><tt>#Y&nbsp;&nbsp;(C)&nbsp;1998&nbsp;School&nbsp;Math&nbsp;and&nbsp;Comp.&nbsp;Sci.,&nbsp;University&nbsp;of&nbsp;St&nbsp;Andrews,&nbsp;Scotland
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line8"></a>8</td><td></td><td></td><td></td><td><span><tt>#Y&nbsp;&nbsp;Copyright&nbsp;(C)&nbsp;2002&nbsp;The&nbsp;GAP&nbsp;Group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line9"></a>9</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line10"></a>10</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line11"></a>11</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line12"></a>12</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line13"></a>13</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line14"></a>14</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;CanEasilyTestMembership(&nbsp;&lt;permgroup>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line15"></a>15</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line16"></a>16</td><td></td><td></td><td></td><td><span><tt>InstallTrueMethod(CanEasilyTestMembership,IsPermGroup);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line17"></a>17</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line18"></a>18</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line19"></a>19</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line20"></a>20</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line21"></a>21</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;CanEasilyComputePcgs(&nbsp;&lt;permgroup>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line22"></a>22</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line23"></a>23</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;solvable&nbsp;permgroups&nbsp;can&nbsp;compute&nbsp;a&nbsp;pcgs.&nbsp;(The&nbsp;group&nbsp;may&nbsp;have&nbsp;been&nbsp;told&nbsp;it
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line24"></a>24</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;is&nbsp;solvable&nbsp;without&nbsp;actually&nbsp;doing&nbsp;a&nbsp;solvability&nbsp;test,&nbsp;so&nbsp;we&nbsp;need&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line25"></a>25</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;implication.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line26"></a>26</td><td></td><td></td><td></td><td><span><tt>InstallTrueMethod(CanEasilyComputePcgs,IsPermGroup&nbsp;and&nbsp;IsSolvableGroup);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line27"></a>27</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line28"></a>28</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;CanComputeSizeAnySubgroup
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line29"></a>29</td><td></td><td></td><td></td><td><span><tt>InstallTrueMethod(CanComputeSizeAnySubgroup,IsPermGroup);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line30"></a>30</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line31"></a>31</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line32"></a>32</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line33"></a>33</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;AsSubgroup(&nbsp;&lt;G>,&nbsp;&lt;U>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;with&nbsp;stab&nbsp;chain&nbsp;transfer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line34"></a>34</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line35"></a>35</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;AsSubgroup,"perm&nbsp;groups",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line36"></a>36</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,&nbsp;[&nbsp;IsPermGroup,&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line37"></a>37</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G,&nbsp;U&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line38"></a>38</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;S;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line39"></a>39</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;test&nbsp;if&nbsp;the&nbsp;parent&nbsp;is&nbsp;already&nbsp;alright
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line40"></a>40</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasParent(U)&nbsp;and&nbsp;IsIdenticalObj(Parent(U),G)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line41"></a>41</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;U;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line42"></a>42</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line43"></a>43</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line44"></a>44</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsSubset(&nbsp;G,&nbsp;U&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line45"></a>45</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line46"></a>46</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line47"></a>47</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;S:=&nbsp;SubgroupNC(&nbsp;G,&nbsp;GeneratorsOfGroup(&nbsp;U&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line48"></a>48</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;UseIsomorphismRelation(&nbsp;U,&nbsp;S&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line49"></a>49</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;UseSubsetRelation(&nbsp;U,&nbsp;S&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line50"></a>50</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasStabChainMutable(&nbsp;U&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line51"></a>51</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetStabChainMutable(&nbsp;S,&nbsp;StabChainMutable(&nbsp;U&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line52"></a>52</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line53"></a>53</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;S;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line54"></a>54</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line55"></a>55</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line56"></a>56</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line57"></a>57</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line58"></a>58</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;CanEasilyComputeWithIndependentGensAbelianGroup(&nbsp;&lt;permgroup>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line59"></a>59</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line60"></a>60</td><td></td><td></td><td></td><td><span><tt>InstallTrueMethod(CanEasilyComputeWithIndependentGensAbelianGroup,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line61"></a>61</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsPermGroup&nbsp;and&nbsp;IsAbelian);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line62"></a>62</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line63"></a>63</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line64"></a>64</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line65"></a>65</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;IndependentGeneratorsAbelianPPermGroup(&nbsp;&lt;P>,&nbsp;&lt;p>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;nice&nbsp;generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line66"></a>66</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line67"></a>67</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;IndependentGeneratorsAbelianPPermGroup,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line68"></a>68</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;P,&nbsp;p&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line69"></a>69</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;inds,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;independent&nbsp;generators,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line70"></a>70</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pows,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;their&nbsp;powers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line71"></a>71</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;base&nbsp;of&nbsp;the&nbsp;vectorspace
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line72"></a>72</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;group&nbsp;generated&nbsp;by&nbsp;&lt;inds>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line73"></a>73</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orbs,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;orbits
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line74"></a>74</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trns,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;transversal
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line75"></a>75</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gens,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;remaining&nbsp;generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line76"></a>76</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;identity&nbsp;of&nbsp;`P'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line77"></a>77</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gens2,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;remaining&nbsp;generators&nbsp;for&nbsp;next&nbsp;round
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line78"></a>78</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;exponent&nbsp;of&nbsp;&lt;P>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line79"></a>79</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;generator&nbsp;from&nbsp;&lt;gens>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line80"></a>80</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;its&nbsp;power
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line81"></a>81</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;basepoint
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line82"></a>82</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;other&nbsp;point&nbsp;in&nbsp;orbit
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line83"></a>83</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;j,&nbsp;k;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;variables
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line84"></a>84</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line85"></a>85</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;initialize&nbsp;the&nbsp;list&nbsp;of&nbsp;independent&nbsp;generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line86"></a>86</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;inds&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line87"></a>87</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pows&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line88"></a>88</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;base&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line89"></a>89</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;size&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line90"></a>90</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;orbs&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line91"></a>91</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;trns&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line92"></a>92</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line93"></a>93</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;gens&nbsp;are&nbsp;the&nbsp;generators&nbsp;for&nbsp;the&nbsp;remaining&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line94"></a>94</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;gens&nbsp;:=&nbsp;GeneratorsOfGroup(&nbsp;P&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line95"></a>95</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;one:=&nbsp;One(&nbsp;P&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line96"></a>96</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line97"></a>97</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;the&nbsp;exponents
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line98"></a>98</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;exp&nbsp;:=&nbsp;Maximum(&nbsp;List(&nbsp;gens,&nbsp;g&nbsp;->&nbsp;LogInt(&nbsp;Order(&nbsp;g&nbsp;),&nbsp;p&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line99"></a>99</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[exp,exp-1..1]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line100"></a>100</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line101"></a>101</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;the&nbsp;remaining&nbsp;generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line102"></a>102</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gens2&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line103"></a>103</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;&nbsp;in&nbsp;[1..Length(gens)]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line104"></a>104</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g&nbsp;:=&nbsp;gens[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line105"></a>105</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;:=&nbsp;g&nbsp;^&nbsp;(p^(i-1));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line106"></a>106</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line107"></a>107</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;reduce&nbsp;&lt;g>&nbsp;and&nbsp;&lt;h>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line108"></a>108</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;h&nbsp;&lt;>&nbsp;h^0
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line109"></a>109</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;IsBound(trns[SmallestMovedPoint(h)^h])
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line110"></a>110</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line111"></a>111</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g&nbsp;:=&nbsp;g&nbsp;/&nbsp;pows[&nbsp;trns[SmallestMovedPoint(h)^h]&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line112"></a>112</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;:=&nbsp;h&nbsp;/&nbsp;base[&nbsp;trns[SmallestMovedPoint(h)^h]&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line113"></a>113</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line114"></a>114</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line115"></a>115</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;this&nbsp;is&nbsp;linear&nbsp;indepenent,&nbsp;add&nbsp;it&nbsp;to&nbsp;the&nbsp;generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line116"></a>116</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;h&nbsp;&lt;>&nbsp;h^0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line117"></a>117</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;inds,&nbsp;g&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line118"></a>118</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;pows,&nbsp;g&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line119"></a>119</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;base,&nbsp;h&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line120"></a>120</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size&nbsp;:=&nbsp;size&nbsp;*&nbsp;p^i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line121"></a>121</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;:=&nbsp;SmallestMovedPoint(h);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line122"></a>122</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsBound(&nbsp;orbs[b]&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line123"></a>123</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orbs[b]&nbsp;:=&nbsp;[&nbsp;b&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line124"></a>124</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trns[b]&nbsp;:=&nbsp;[&nbsp;one&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line125"></a>125</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line126"></a>126</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;c&nbsp;&nbsp;in&nbsp;ShallowCopy(orbs[b])&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line127"></a>127</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;&nbsp;in&nbsp;[1..p-1]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line128"></a>128</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;orbs[b],&nbsp;c&nbsp;^&nbsp;(h^k)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line129"></a>129</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trns[c^(h^k)]&nbsp;:=&nbsp;Length(base);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line130"></a>130</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line131"></a>131</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line132"></a>132</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line133"></a>133</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;otherwise&nbsp;reduce&nbsp;and&nbsp;add&nbsp;to&nbsp;gens2
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line134"></a>134</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line135"></a>135</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;gens2,&nbsp;g&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line136"></a>136</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line137"></a>137</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line138"></a>138</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line139"></a>139</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line140"></a>140</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line141"></a>141</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;prepare&nbsp;for&nbsp;the&nbsp;next&nbsp;round
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line142"></a>142</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gens&nbsp;:=&nbsp;gens2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line143"></a>143</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pows&nbsp;:=&nbsp;List(&nbsp;pows,i->i^&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line144"></a>144</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line145"></a>145</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line146"></a>146</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line147"></a>147</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;return&nbsp;the&nbsp;indepenent&nbsp;generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line148"></a>148</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;inds;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line149"></a>149</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line150"></a>150</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line151"></a>151</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line152"></a>152</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line153"></a>153</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IndependentGeneratorsOfAbelianGroup(&nbsp;&lt;G>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;nice&nbsp;generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line154"></a>154</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line155"></a>155</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IndependentGeneratorsOfAbelianGroup,&nbsp;"for&nbsp;perm&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line156"></a>156</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup&nbsp;and&nbsp;IsAbelian&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line157"></a>157</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line158"></a>158</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;inds,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;independent&nbsp;generators,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line159"></a>159</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;identity&nbsp;of&nbsp;`G'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line160"></a>160</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;prime&nbsp;factor&nbsp;of&nbsp;group&nbsp;size
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line161"></a>161</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gens,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;generators&nbsp;of&nbsp;&lt;p>-Sylowsubgroup
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line162"></a>162</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;generator
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line163"></a>163</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;its&nbsp;order
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line164"></a>164</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line165"></a>165</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;all&nbsp;primes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line166"></a>166</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;inds&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line167"></a>167</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;one:=&nbsp;One(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line168"></a>168</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;p&nbsp;&nbsp;in&nbsp;Union(&nbsp;List(&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line169"></a>169</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g&nbsp;->&nbsp;Factors(Order(g))&nbsp;)&nbsp;)&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line170"></a>170</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;p&nbsp;&lt;>&nbsp;1&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line171"></a>171</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line172"></a>172</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;compute&nbsp;the&nbsp;generators&nbsp;for&nbsp;the&nbsp;Sylow&nbsp;&lt;p>&nbsp;subgroup
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line173"></a>173</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gens&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line174"></a>174</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;g&nbsp;&nbsp;in&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;)&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line175"></a>175</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o&nbsp;:=&nbsp;Order(g);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line176"></a>176</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;o&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;&nbsp;do&nbsp;o&nbsp;:=&nbsp;o&nbsp;/&nbsp;p;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line177"></a>177</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;g^o&nbsp;&lt;>&nbsp;g^0&nbsp;&nbsp;then&nbsp;Add(&nbsp;gens,&nbsp;g^o&nbsp;);&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line178"></a>178</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line179"></a>179</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line180"></a>180</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;append&nbsp;the&nbsp;independent&nbsp;generators&nbsp;for&nbsp;the&nbsp;Sylow&nbsp;&lt;p>&nbsp;subgroup
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line181"></a>181</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;inds,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line182"></a>182</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IndependentGeneratorsAbelianPPermGroup(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line183"></a>183</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GroupByGenerators(&nbsp;gens,&nbsp;one&nbsp;),&nbsp;p&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line184"></a>184</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line185"></a>185</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line186"></a>186</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line187"></a>187</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line188"></a>188</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Sort&nbsp;the&nbsp;independent&nbsp;generators&nbsp;by&nbsp;increasing&nbsp;order
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line189"></a>189</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Sort(&nbsp;inds,&nbsp;function&nbsp;(a,b)&nbsp;return&nbsp;Order(a)&nbsp;&lt;&nbsp;Order(b);&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line190"></a>190</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line191"></a>191</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;return&nbsp;the&nbsp;independent&nbsp;generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line192"></a>192</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;inds;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line193"></a>193</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line194"></a>194</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line195"></a>195</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line196"></a>196</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line197"></a>197</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;OrbitPerms(&nbsp;&lt;gens>,&nbsp;&lt;d>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;orbit&nbsp;of&nbsp;permutations
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line198"></a>198</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line199"></a>199</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;OrbitPerms,&nbsp;function(&nbsp;gens,&nbsp;d&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line200"></a>200</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;max,&nbsp;&nbsp;orb,&nbsp;&nbsp;new,&nbsp;&nbsp;pnt,&nbsp;&nbsp;img,&nbsp;&nbsp;gen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line201"></a>201</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line202"></a>202</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;get&nbsp;the&nbsp;largest&nbsp;point&nbsp;&lt;max>&nbsp;moved&nbsp;by&nbsp;the&nbsp;group&nbsp;&lt;G>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line203"></a>203</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max&nbsp;:=&nbsp;LargestMovedPoint(&nbsp;gens&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line204"></a>204</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line205"></a>205</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;handle&nbsp;fixpoints
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line206"></a>206</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;d&nbsp;in&nbsp;[1..max]&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line207"></a>207</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;d&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line208"></a>208</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line209"></a>209</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line210"></a>210</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;start&nbsp;with&nbsp;the&nbsp;singleton&nbsp;orbit
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line211"></a>211</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orb&nbsp;:=&nbsp;[&nbsp;d&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line212"></a>212</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;:=&nbsp;BlistList(&nbsp;[1..max],&nbsp;[1..max]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line213"></a>213</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new[d]&nbsp;:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line214"></a>214</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line215"></a>215</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;all&nbsp;points&nbsp;found
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line216"></a>216</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pnt&nbsp;&nbsp;in&nbsp;orb&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line217"></a>217</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line218"></a>218</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;apply&nbsp;all&nbsp;generators&nbsp;&lt;gen>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line219"></a>219</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gen&nbsp;&nbsp;in&nbsp;gens&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line220"></a>220</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img&nbsp;:=&nbsp;pnt&nbsp;^&nbsp;gen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line221"></a>221</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line222"></a>222</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;add&nbsp;the&nbsp;image&nbsp;&lt;img>&nbsp;to&nbsp;the&nbsp;orbit&nbsp;if&nbsp;it&nbsp;is&nbsp;new
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line223"></a>223</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;new[img]&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line224"></a>224</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;orb,&nbsp;img&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line225"></a>225</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new[img]&nbsp;:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line226"></a>226</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line227"></a>227</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line228"></a>228</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line229"></a>229</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line230"></a>230</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line231"></a>231</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;orb;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line232"></a>232</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line233"></a>233</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line234"></a>234</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line235"></a>235</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line236"></a>236</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;OrbitsPerms(&nbsp;&lt;gens>,&nbsp;&lt;D>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;orbits&nbsp;of&nbsp;permutations
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line237"></a>237</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line238"></a>238</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;OrbitsPerms,&nbsp;function(&nbsp;gens,&nbsp;D&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line239"></a>239</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;max,&nbsp;&nbsp;dom,&nbsp;&nbsp;new,&nbsp;&nbsp;orbs,&nbsp;&nbsp;fst,&nbsp;&nbsp;orb,&nbsp;&nbsp;pnt,&nbsp;&nbsp;gen,&nbsp;&nbsp;img;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line240"></a>240</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line241"></a>241</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;get&nbsp;the&nbsp;largest&nbsp;point&nbsp;&lt;max>&nbsp;moved&nbsp;by&nbsp;the&nbsp;group&nbsp;&lt;G>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line242"></a>242</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max&nbsp;:=&nbsp;LargestMovedPoint(&nbsp;gens&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line243"></a>243</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dom&nbsp;:=&nbsp;BlistList(&nbsp;[1..max],&nbsp;D&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line244"></a>244</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;:=&nbsp;BlistList(&nbsp;[1..max],&nbsp;[1..max]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line245"></a>245</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orbs&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line246"></a>246</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line247"></a>247</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;repeat&nbsp;until&nbsp;the&nbsp;domain&nbsp;is&nbsp;exhausted
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line248"></a>248</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fst&nbsp;:=&nbsp;Position(&nbsp;dom,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line249"></a>249</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;fst&nbsp;&lt;>&nbsp;fail&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line250"></a>250</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line251"></a>251</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;start&nbsp;with&nbsp;the&nbsp;singleton&nbsp;orbit
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line252"></a>252</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orb&nbsp;:=&nbsp;[&nbsp;fst&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line253"></a>253</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new[fst]&nbsp;:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line254"></a>254</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dom[fst]&nbsp;:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line255"></a>255</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line256"></a>256</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;all&nbsp;points&nbsp;found
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line257"></a>257</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pnt&nbsp;&nbsp;in&nbsp;orb&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line258"></a>258</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line259"></a>259</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;apply&nbsp;all&nbsp;generators&nbsp;&lt;gen>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line260"></a>260</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gen&nbsp;&nbsp;in&nbsp;gens&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line261"></a>261</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img&nbsp;:=&nbsp;pnt&nbsp;^&nbsp;gen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line262"></a>262</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line263"></a>263</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;add&nbsp;the&nbsp;image&nbsp;&lt;img>&nbsp;to&nbsp;the&nbsp;orbit&nbsp;if&nbsp;it&nbsp;is&nbsp;new
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line264"></a>264</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;new[img]&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line265"></a>265</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;orb,&nbsp;img&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line266"></a>266</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new[img]&nbsp;:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line267"></a>267</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dom[img]&nbsp;:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line268"></a>268</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line269"></a>269</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line270"></a>270</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line271"></a>271</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line272"></a>272</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line273"></a>273</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line274"></a>274</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;add&nbsp;the&nbsp;orbit&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;orbits&nbsp;and&nbsp;take&nbsp;next&nbsp;point
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line275"></a>275</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;orbs,&nbsp;orb&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line276"></a>276</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fst&nbsp;:=&nbsp;Position(&nbsp;dom,&nbsp;true,&nbsp;fst&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line277"></a>277</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line278"></a>278</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line279"></a>279</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line280"></a>280</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;add&nbsp;the&nbsp;remaining&nbsp;points&nbsp;of&nbsp;&lt;D>,&nbsp;they&nbsp;are&nbsp;fixed
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line281"></a>281</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pnt&nbsp;&nbsp;in&nbsp;D&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line282"></a>282</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;if&nbsp;pnt>max&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line283"></a>283</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;orbs,&nbsp;[&nbsp;pnt&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line284"></a>284</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line285"></a>285</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line286"></a>286</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line287"></a>287</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;orbs;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line288"></a>288</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line289"></a>289</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line290"></a>290</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line291"></a>291</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line292"></a>292</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line293"></a>293</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;SmallestMovedPoint(&nbsp;&lt;C>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;a&nbsp;collection&nbsp;of&nbsp;permutations
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line294"></a>294</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line295"></a>295</td><td></td><td></td><td></td><td><span><tt>SmallestMovedPointPerms&nbsp;:=&nbsp;function(&nbsp;C&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line296"></a>296</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;min,&nbsp;&nbsp;m,&nbsp;&nbsp;gen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line297"></a>297</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line298"></a>298</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;min&nbsp;:=&nbsp;infinity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line299"></a>299</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gen&nbsp;&nbsp;in&nbsp;C&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line300"></a>300</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsOne(&nbsp;gen&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line301"></a>301</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;SmallestMovedPointPerm(&nbsp;gen&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line302"></a>302</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;&lt;&nbsp;min&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line303"></a>303</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min&nbsp;:=&nbsp;m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line304"></a>304</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line305"></a>305</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line306"></a>306</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line307"></a>307</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;min;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line308"></a>308</td><td></td><td></td><td></td><td><span><tt>end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line309"></a>309</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line310"></a>310</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;SmallestMovedPoint,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line311"></a>311</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;collection&nbsp;of&nbsp;permutations",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line312"></a>312</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line313"></a>313</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermCollection&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line314"></a>314</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SmallestMovedPointPerms&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line315"></a>315</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line316"></a>316</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;SmallestMovedPoint,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line317"></a>317</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;empty&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line318"></a>318</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line319"></a>319</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList&nbsp;and&nbsp;IsEmpty&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line320"></a>320</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SmallestMovedPointPerms&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line321"></a>321</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line322"></a>322</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line323"></a>323</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line324"></a>324</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line325"></a>325</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;LargestMovedPoint(&nbsp;&lt;C>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;a&nbsp;collection&nbsp;of&nbsp;permutations&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line326"></a>326</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line327"></a>327</td><td></td><td></td><td></td><td><span><tt>LargestMovedPointPerms&nbsp;:=&nbsp;function(&nbsp;C&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line328"></a>328</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;max,&nbsp;&nbsp;m,&nbsp;&nbsp;gen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line329"></a>329</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line330"></a>330</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;max&nbsp;:=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line331"></a>331</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gen&nbsp;&nbsp;in&nbsp;C&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line332"></a>332</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsOne(&nbsp;gen&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line333"></a>333</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;LargestMovedPointPerm(&nbsp;gen&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line334"></a>334</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;max&nbsp;&lt;&nbsp;m&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line335"></a>335</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max&nbsp;:=&nbsp;m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line336"></a>336</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line337"></a>337</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line338"></a>338</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line339"></a>339</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;max;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line340"></a>340</td><td></td><td></td><td></td><td><span><tt>end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line341"></a>341</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line342"></a>342</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;LargestMovedPoint,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line343"></a>343</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;collection&nbsp;of&nbsp;permutations",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line344"></a>344</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line345"></a>345</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermCollection&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line346"></a>346</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;LargestMovedPointPerms&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line347"></a>347</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line348"></a>348</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;LargestMovedPoint,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line349"></a>349</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;empty&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line350"></a>350</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line351"></a>351</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList&nbsp;and&nbsp;IsEmpty&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line352"></a>352</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;LargestMovedPointPerms&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line353"></a>353</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line354"></a>354</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line355"></a>355</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line356"></a>356</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line357"></a>357</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;MovedPoints(&nbsp;&lt;C>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;a&nbsp;collection&nbsp;of&nbsp;permutations&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line358"></a>358</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line359"></a>359</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(MovedPointsPerms,function(&nbsp;C&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line360"></a>360</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;mov,&nbsp;&nbsp;gen,&nbsp;&nbsp;pnt;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line361"></a>361</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line362"></a>362</td><td>84,188</td><td>76,722</td><td>76,722</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;:=&nbsp;[&nbsp;&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line363"></a>363</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gen&nbsp;&nbsp;in&nbsp;C&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line364"></a>364</td><td>252,564</td><td>596,976</td><td>1,247,733</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;gen&nbsp;&lt;>&nbsp;One(&nbsp;gen&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span><a href="_opt_gap_gap4r8p7_lib_arith.gi.html#line318">/opt/gap/gap4r8p7/lib/arith.gi:318</a> </span></td></tr>
<tr class='exec'><td><a name="line365"></a>365</td><td>252,564</td><td>549,074</td><td>2,588,346</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pnt&nbsp;&nbsp;in&nbsp;[&nbsp;SmallestMovedPoint(&nbsp;gen&nbsp;)&nbsp;..
</tt></span></td><td><span><a href="_opt_gap_gap4r8p7_lib_permutat.g.html#line593">/opt/gap/gap4r8p7/lib/permutat.g:593</a> </span></td></tr>
<tr class='exec'><td><a name="line366"></a>366</td><td>505,128</td><td>394,093</td><td>394,093</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LargestMovedPoint(&nbsp;gen&nbsp;)&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line367"></a>367</td><td>3,535,896</td><td>2,531,127</td><td>2,531,127</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pnt&nbsp;^&nbsp;gen&nbsp;&lt;>&nbsp;pnt&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line368"></a>368</td><td>3,535,896</td><td>2,640,579</td><td>2,640,579</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov[&nbsp;pnt&nbsp;]&nbsp;:=&nbsp;pnt;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line369"></a>369</td><td>3,535,896</td><td>2,590,070</td><td>2,590,070</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line370"></a>370</td><td>252,564</td><td>184,786</td><td>184,786</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line371"></a>371</td><td>252,564</td><td>209,275</td><td>209,275</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line372"></a>372</td><td>84,188</td><td>66,980</td><td>66,980</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line373"></a>373</td><td>84,188</td><td>409,323</td><td>409,323</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Set(&nbsp;mov&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line374"></a>374</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line375"></a>375</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line376"></a>376</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;MovedPoints,&nbsp;"for&nbsp;a&nbsp;collection&nbsp;of&nbsp;permutations",&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line377"></a>377</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermCollection&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line378"></a>378</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;MovedPointsPerms&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line379"></a>379</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line380"></a>380</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;MovedPoints,&nbsp;"for&nbsp;an&nbsp;empty&nbsp;list",&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line381"></a>381</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList&nbsp;and&nbsp;IsEmpty&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line382"></a>382</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;MovedPointsPerms&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line383"></a>383</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line384"></a>384</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;MovedPoints,&nbsp;"for&nbsp;a&nbsp;permutation",&nbsp;true,&nbsp;[&nbsp;IsPerm&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line385"></a>385</td><td></td><td></td><td></td><td><span><tt>function(p)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line386"></a>386</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;MovedPointsPerms([p]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line387"></a>387</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line388"></a>388</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line389"></a>389</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line390"></a>390</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line391"></a>391</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line392"></a>392</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;NrMovedPoints(&nbsp;&lt;C>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;a&nbsp;collection&nbsp;of&nbsp;permutations&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line393"></a>393</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line394"></a>394</td><td></td><td></td><td></td><td><span><tt>NrMovedPointsPerms&nbsp;:=&nbsp;function(&nbsp;C&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line395"></a>395</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;mov,&nbsp;sma,&nbsp;pnt,&nbsp;gen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line396"></a>396</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line397"></a>397</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;:=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line398"></a>398</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;sma&nbsp;:=&nbsp;SmallestMovedPoint(&nbsp;C&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line399"></a>399</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sma&nbsp;=&nbsp;infinity&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line400"></a>400</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line401"></a>401</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line402"></a>402</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pnt&nbsp;&nbsp;in&nbsp;[&nbsp;sma&nbsp;..&nbsp;LargestMovedPoint(&nbsp;C&nbsp;)&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line403"></a>403</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gen&nbsp;in&nbsp;C&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line404"></a>404</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pnt&nbsp;^&nbsp;gen&nbsp;&lt;>&nbsp;pnt&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line405"></a>405</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov:=&nbsp;mov&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line406"></a>406</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line407"></a>407</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line408"></a>408</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line409"></a>409</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line410"></a>410</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;mov;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line411"></a>411</td><td></td><td></td><td></td><td><span><tt>end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line412"></a>412</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line413"></a>413</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;NrMovedPoints,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line414"></a>414</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;collection&nbsp;of&nbsp;permutations",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line415"></a>415</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermCollection&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line416"></a>416</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;NrMovedPointsPerms&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line417"></a>417</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line418"></a>418</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;NrMovedPoints,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line419"></a>419</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;empty&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line420"></a>420</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList&nbsp;and&nbsp;IsEmpty&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line421"></a>421</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;NrMovedPointsPerms&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line422"></a>422</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line423"></a>423</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line424"></a>424</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line425"></a>425</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line426"></a>426</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;LargestMovedPoint(&nbsp;&lt;G>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;for&nbsp;a&nbsp;permutation&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line427"></a>427</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line428"></a>428</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;LargestMovedPoint,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line429"></a>429</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;permutation&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line430"></a>430</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line431"></a>431</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line432"></a>432</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;->&nbsp;LargestMovedPoint(&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line433"></a>433</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line434"></a>434</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line435"></a>435</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line436"></a>436</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line437"></a>437</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;SmallestMovedPoint(&nbsp;&lt;G>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;for&nbsp;a&nbsp;permutation&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line438"></a>438</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line439"></a>439</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;SmallestMovedPoint,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line440"></a>440</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;permutation&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line441"></a>441</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line442"></a>442</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line443"></a>443</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;->&nbsp;SmallestMovedPoint(&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line444"></a>444</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line445"></a>445</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line446"></a>446</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line447"></a>447</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line448"></a>448</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;MovedPoints(&nbsp;&lt;G>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;for&nbsp;a&nbsp;permutation&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line449"></a>449</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line450"></a>450</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;MovedPoints,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line451"></a>451</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;permutation&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line452"></a>452</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line453"></a>453</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line454"></a>454</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;->&nbsp;MovedPoints(&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line455"></a>455</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line456"></a>456</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line457"></a>457</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line458"></a>458</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line459"></a>459</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;NrMovedPoints(&nbsp;&lt;G>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;for&nbsp;a&nbsp;permutation&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line460"></a>460</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line461"></a>461</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;NrMovedPoints,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line462"></a>462</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;permutation&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line463"></a>463</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line464"></a>464</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line465"></a>465</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;->&nbsp;NrMovedPoints(&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line466"></a>466</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line467"></a>467</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line468"></a>468</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line469"></a>469</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line470"></a>470</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;BaseOfGroup(&nbsp;&lt;G>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line471"></a>471</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line472"></a>472</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;BaseOfGroup,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line473"></a>473</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;permutation&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line474"></a>474</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line475"></a>475</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line476"></a>476</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;->&nbsp;BaseStabChain(&nbsp;StabChainMutable(&nbsp;G&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line477"></a>477</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line478"></a>478</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line479"></a>479</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line480"></a>480</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line481"></a>481</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Size(&nbsp;&lt;G>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;size&nbsp;of&nbsp;permutation&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line482"></a>482</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line483"></a>483</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Size,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line484"></a>484</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;permutation&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line485"></a>485</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line486"></a>486</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line487"></a>487</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;->&nbsp;SizeStabChain(&nbsp;StabChainMutable(&nbsp;G&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line488"></a>488</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line489"></a>489</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line490"></a>490</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line491"></a>491</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line492"></a>492</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Enumerator(&nbsp;&lt;G>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;enumerator&nbsp;of&nbsp;permutation&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line493"></a>493</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line494"></a>494</td><td></td><td></td><td></td><td><span><tt>BindGlobal(&nbsp;"ElementNumber_PermGroup",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line495"></a>495</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;enum,&nbsp;pos&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line496"></a>496</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;elm,&nbsp;&nbsp;S,&nbsp;&nbsp;len,&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line497"></a>497</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line498"></a>498</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;:=&nbsp;enum!.stabChain;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line499"></a>499</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elm&nbsp;:=&nbsp;S.identity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line500"></a>500</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;pos;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line501"></a>501</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;:=&nbsp;pos&nbsp;-&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line502"></a>502</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;Length(&nbsp;S.genlabels&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line503"></a>503</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;:=&nbsp;Length(&nbsp;S.orbit&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line504"></a>504</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elm&nbsp;:=&nbsp;LeftQuotient(&nbsp;InverseRepresentative
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line505"></a>505</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;S,&nbsp;S.orbit[&nbsp;pos&nbsp;mod&nbsp;len&nbsp;+&nbsp;1&nbsp;]&nbsp;),&nbsp;elm&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line506"></a>506</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;:=&nbsp;QuoInt(&nbsp;pos,&nbsp;len&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line507"></a>507</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;:=&nbsp;S.stabilizer;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line508"></a>508</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line509"></a>509</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line510"></a>510</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pos&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line511"></a>511</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;enum>[",&nbsp;n,&nbsp;"]&nbsp;must&nbsp;have&nbsp;an&nbsp;assigned&nbsp;value"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line512"></a>512</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line513"></a>513</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;elm;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line514"></a>514</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line515"></a>515</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line516"></a>516</td><td></td><td></td><td></td><td><span><tt>BindGlobal(&nbsp;"NumberElement_PermGroup",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line517"></a>517</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;enum,&nbsp;elm&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line518"></a>518</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;pos,&nbsp;&nbsp;val,&nbsp;&nbsp;S,&nbsp;&nbsp;img;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line519"></a>519</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line520"></a>520</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsPerm(&nbsp;elm&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line521"></a>521</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line522"></a>522</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line523"></a>523</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line524"></a>524</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line525"></a>525</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line526"></a>526</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;:=&nbsp;enum!.stabChain;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line527"></a>527</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;Length(&nbsp;S.genlabels&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line528"></a>528</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img&nbsp;:=&nbsp;S.orbit[&nbsp;1&nbsp;]&nbsp;^&nbsp;elm;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line529"></a>529</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#pos&nbsp;:=&nbsp;pos&nbsp;+&nbsp;val&nbsp;*&nbsp;(&nbsp;Position(&nbsp;S.orbit,&nbsp;img&nbsp;)&nbsp;-&nbsp;1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line530"></a>530</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(S.orbitpos[img])&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line531"></a>531</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;:=&nbsp;pos&nbsp;+&nbsp;val&nbsp;*&nbsp;S.orbitpos[img];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line532"></a>532</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#val&nbsp;:=&nbsp;val&nbsp;*&nbsp;Length(&nbsp;S.orbit&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line533"></a>533</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;:=&nbsp;val&nbsp;*&nbsp;S.ol;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line534"></a>534</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elm&nbsp;:=&nbsp;elm&nbsp;*&nbsp;InverseRepresentative(&nbsp;S,&nbsp;img&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line535"></a>535</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;:=&nbsp;S.stabilizer;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line536"></a>536</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line537"></a>537</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line538"></a>538</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line539"></a>539</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line540"></a>540</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;elm&nbsp;&lt;>&nbsp;S.identity&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line541"></a>541</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line542"></a>542</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line543"></a>543</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;pos;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line544"></a>544</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line545"></a>545</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line546"></a>546</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Enumerator,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line547"></a>547</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;permutation&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line548"></a>548</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line549"></a>549</td><td></td><td></td><td></td><td><span><tt>function(G)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line550"></a>550</td><td></td><td></td><td></td><td><span><tt>local&nbsp;e,S,i,p;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line551"></a>551</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;get&nbsp;a&nbsp;good&nbsp;base
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line552"></a>552</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;S:=G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line553"></a>553</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;p:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line554"></a>554</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;Size(S)>1&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line555"></a>555</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e:=Orbits(S,MovedPoints(S));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line556"></a>556</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i:=List(e,Length);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line557"></a>557</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i:=Position(i,Maximum(i));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line558"></a>558</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(p,e[i][1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line559"></a>559</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S:=Stabilizer(S,e[i][1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line560"></a>560</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line561"></a>561</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Info(InfoGroup,1,"choose&nbsp;base&nbsp;",p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line562"></a>562</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line563"></a>563</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;S:=StabChainOp(G,rec(base:=p));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line564"></a>564</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;e:=EnumeratorByFunctions(&nbsp;G,&nbsp;rec(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line565"></a>565</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ElementNumber&nbsp;:=&nbsp;ElementNumber_PermGroup,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line566"></a>566</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NumberElement&nbsp;:=&nbsp;NumberElement_PermGroup,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line567"></a>567</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Length&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;enum&nbsp;->&nbsp;SizeStabChain(&nbsp;enum!.stabChain&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line568"></a>568</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PrintObj&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;function(&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line569"></a>569</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"&lt;enumerator&nbsp;of&nbsp;perm&nbsp;group>"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line570"></a>570</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line571"></a>571</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line572"></a>572</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stabChain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=&nbsp;S&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line573"></a>573</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;while&nbsp;Length(S.genlabels)&lt;>0&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line574"></a>574</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;S.ol:=Length(S.orbit);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line575"></a>575</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;S.orbitpos:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line576"></a>576</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Maximum(S.orbit)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line577"></a>577</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p:=Position(S.orbit,i);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line578"></a>578</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;p&lt;>fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line579"></a>579</td><td></td><td></td><td></td><td><span><tt>	S.orbitpos[i]:=p-1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line580"></a>580</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line581"></a>581</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line582"></a>582</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;S:=S.stabilizer;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line583"></a>583</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line584"></a>584</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;e;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line585"></a>585</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line586"></a>586</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line587"></a>587</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line588"></a>588</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line589"></a>589</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Iterator(&nbsp;&lt;G>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;iterator&nbsp;of&nbsp;permutation&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line590"></a>590</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line591"></a>591</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Iterator,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line592"></a>592</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;trivial&nbsp;permutation&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line593"></a>593</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup&nbsp;and&nbsp;IsTrivial&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line594"></a>594</td><td></td><td></td><td></td><td><span><tt>function(G)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line595"></a>595</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;IteratorList([()]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line596"></a>596</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line597"></a>597</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line598"></a>598</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Iterator,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line599"></a>599</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;permutation&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line600"></a>600</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line601"></a>601</td><td></td><td></td><td></td><td><span><tt>function(G)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line602"></a>602</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;IteratorStabChain(StabChain(G));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line603"></a>603</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line604"></a>604</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line605"></a>605</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line606"></a>606</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line607"></a>607</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Random(&nbsp;&lt;G>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;random&nbsp;element
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line608"></a>608</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line609"></a>609</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Random,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line610"></a>610</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;permutation&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line611"></a>611</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;10,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line612"></a>612</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line613"></a>613</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;S,&nbsp;&nbsp;rnd;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line614"></a>614</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line615"></a>615</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;go&nbsp;down&nbsp;the&nbsp;stabchain&nbsp;and&nbsp;multiply&nbsp;random&nbsp;representatives
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line616"></a>616</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;:=&nbsp;StabChainMutable(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line617"></a>617</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;rnd&nbsp;:=&nbsp;S.identity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line618"></a>618</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;Length(&nbsp;S.genlabels&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line619"></a>619</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rnd&nbsp;:=&nbsp;LeftQuotient(&nbsp;InverseRepresentative(&nbsp;S,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line620"></a>620</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Random(&nbsp;S.orbit&nbsp;)&nbsp;),&nbsp;rnd&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line621"></a>621</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;:=&nbsp;S.stabilizer;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line622"></a>622</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line623"></a>623</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line624"></a>624</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;return&nbsp;the&nbsp;random&nbsp;element
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line625"></a>625</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rnd;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line626"></a>626</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line627"></a>627</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line628"></a>628</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line629"></a>629</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line630"></a>630</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line631"></a>631</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;&lt;g>&nbsp;in&nbsp;&lt;G>&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;membership&nbsp;test
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line632"></a>632</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line633"></a>633</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\in,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line634"></a>634</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;permutation,&nbsp;and&nbsp;a&nbsp;permutation&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line635"></a>635</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line636"></a>636</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPerm,&nbsp;IsPermGroup&nbsp;and&nbsp;HasGeneratorsOfGroup],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line637"></a>637</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;g,&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line638"></a>638</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;g&nbsp;=&nbsp;One(&nbsp;G&nbsp;)&nbsp;&nbsp;or&nbsp;&nbsp;g&nbsp;in&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line639"></a>639</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line640"></a>640</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line641"></a>641</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;:=&nbsp;StabChainMutable(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line642"></a>642</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;SiftedPermutation(&nbsp;G,&nbsp;g&nbsp;)&nbsp;=&nbsp;G.identity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line643"></a>643</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line644"></a>644</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line645"></a>645</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line646"></a>646</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line647"></a>647</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line648"></a>648</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line649"></a>649</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ClosureGroup(&nbsp;&lt;G>,&nbsp;&lt;gens>,&nbsp;&lt;options>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;closure&nbsp;with&nbsp;options
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line650"></a>650</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line651"></a>651</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;The&nbsp;following&nbsp;function&nbsp;implements&nbsp;the&nbsp;method&nbsp;and&nbsp;may&nbsp;be&nbsp;called&nbsp;even&nbsp;with
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line652"></a>652</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;incomplete&nbsp;(temp)&nbsp;stabilizer&nbsp;chains.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line653"></a>653</td><td></td><td></td><td></td><td><span><tt>BindGlobal("DoClosurePrmGp",function(&nbsp;G,&nbsp;gens,&nbsp;options&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line654"></a>654</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;C,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;closure&nbsp;of&nbsp;&lt;&nbsp;&lt;G>,&nbsp;&lt;obj>&nbsp;>,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line655"></a>655</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P,&nbsp;inpar,&nbsp;&nbsp;&nbsp;#&nbsp;parent&nbsp;of&nbsp;the&nbsp;closure
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line656"></a>656</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;an&nbsp;element&nbsp;of&nbsp;gens
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line657"></a>657</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;o,		#&nbsp;order
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line658"></a>658</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;newgens,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;new&nbsp;generator&nbsp;list
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line659"></a>659</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chain;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;stabilizer&nbsp;chain&nbsp;created
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line660"></a>660</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line661"></a>661</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;options:=ShallowCopy(options);&nbsp;#&nbsp;options&nbsp;will&nbsp;be&nbsp;overwritten
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line662"></a>662</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;all&nbsp;generators&nbsp;are&nbsp;in&nbsp;&lt;G>,&nbsp;&lt;G>&nbsp;is&nbsp;the&nbsp;closure
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line663"></a>663</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;gens&nbsp;:=&nbsp;Filtered(&nbsp;gens,&nbsp;gen&nbsp;->&nbsp;not&nbsp;gen&nbsp;in&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line664"></a>664</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;gens&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line665"></a>665</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line666"></a>666</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line667"></a>667</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line668"></a>668</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;is&nbsp;the&nbsp;closure&nbsp;normalizing?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line669"></a>669</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(gens)=1&nbsp;and&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line670"></a>670</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ForAll(gens,i->ForAll(GeneratorsOfGroup(G),j->j^i&nbsp;in&nbsp;G))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line671"></a>671</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g:=gens[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line672"></a>672</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Size(G)>1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line673"></a>673</td><td></td><td></td><td></td><td><span><tt>	o:=First(Difference(DivisorsInt(Order(g)),[1]),j->g^j&nbsp;in&nbsp;G);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line674"></a>674</td><td></td><td></td><td></td><td><span><tt>	options.limit:=Size(G)*o;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line675"></a>675</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line676"></a>676</td><td></td><td></td><td></td><td><span><tt>	o:=First(Difference(DivisorsInt(Order(g)),[1]),j->IsOne(g^j));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line677"></a>677</td><td></td><td></td><td></td><td><span><tt>	options.limit:=o;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line678"></a>678</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line679"></a>679</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options.size:=options.limit;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line680"></a>680</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Print(options.limit,"&lt;&lt;\n");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line681"></a>681</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line682"></a>682</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line683"></a>683</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;otherwise&nbsp;decide&nbsp;between&nbsp;random&nbsp;and&nbsp;deterministic&nbsp;methods
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line684"></a>684</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;P&nbsp;:=&nbsp;Parent(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line685"></a>685</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;inpar&nbsp;:=&nbsp;IsSubset(&nbsp;P,&nbsp;gens&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line686"></a>686</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;not&nbsp;inpar&nbsp;&nbsp;and&nbsp;&nbsp;not&nbsp;IsIdenticalObj(&nbsp;P,&nbsp;Parent(&nbsp;P&nbsp;)&nbsp;)&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line687"></a>687</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P&nbsp;:=&nbsp;Parent(&nbsp;P&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line688"></a>688</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inpar&nbsp;:=&nbsp;IsSubset(&nbsp;P,&nbsp;gens&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line689"></a>689</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line690"></a>690</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;inpar&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line691"></a>691</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CopyOptionsDefaults(&nbsp;P,&nbsp;options&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line692"></a>692</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;not&nbsp;IsBound(&nbsp;options.random&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line693"></a>693</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options.random&nbsp;:=&nbsp;DefaultStabChainOptions.random;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line694"></a>694</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line695"></a>695</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line696"></a>696</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;perhaps&nbsp;&lt;G>&nbsp;is&nbsp;normal&nbsp;in&nbsp;&lt;C>&nbsp;with&nbsp;solvable&nbsp;factor&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line697"></a>697</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line698"></a>698</td><td></td><td></td><td></td><td><span><tt>#AH&nbsp;5-feb-96:&nbsp;Disabled&nbsp;(see&nbsp;gap-dev&nbsp;discussion).
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line699"></a>699</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;DefaultStabChainOptions.tryPcgs
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line700"></a>700</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ForAll(&nbsp;gens,&nbsp;gen&nbsp;->&nbsp;ForAll(&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line701"></a>701</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g&nbsp;->&nbsp;g&nbsp;^&nbsp;gen&nbsp;in&nbsp;G&nbsp;)&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line702"></a>702</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;inpar&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line703"></a>703</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;:=&nbsp;SubgroupNC(&nbsp;P,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line704"></a>704</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Concatenation(&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;),&nbsp;gens&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line705"></a>705</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line706"></a>706</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;:=&nbsp;GroupByGenerators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line707"></a>707</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;Concatenation(&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;),&nbsp;gens&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line708"></a>708</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line709"></a>709</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pcgs:=TryPcgsPermGroup(&nbsp;[&nbsp;C,&nbsp;G&nbsp;],&nbsp;false,&nbsp;false,&nbsp;false&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line710"></a>710</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsPcgs(&nbsp;pcgs&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line711"></a>711</td><td></td><td></td><td></td><td><span><tt>#	&nbsp;&nbsp;chain:=pcgs!.stabChain;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line712"></a>712</td><td></td><td></td><td></td><td><span><tt>#	&nbsp;&nbsp;if&nbsp;inpar&nbsp;&nbsp;then&nbsp;&nbsp;C&nbsp;:=&nbsp;GroupStabChain(&nbsp;P,&nbsp;chain,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line713"></a>713</td><td></td><td></td><td></td><td><span><tt>#		&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;C&nbsp;:=&nbsp;GroupStabChain(&nbsp;chain&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line714"></a>714</td><td></td><td></td><td></td><td><span><tt>#	&nbsp;&nbsp;SetStabChainOptions(&nbsp;C,&nbsp;rec(&nbsp;random&nbsp;:=&nbsp;options.random&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line715"></a>715</td><td></td><td></td><td></td><td><span><tt>#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line716"></a>716</td><td></td><td></td><td></td><td><span><tt>#	&nbsp;&nbsp;UseSubsetRelation(&nbsp;C,&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line717"></a>717</td><td></td><td></td><td></td><td><span><tt>#	&nbsp;&nbsp;return&nbsp;C;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line718"></a>718</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line719"></a>719</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line720"></a>720</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line721"></a>721</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;the&nbsp;base&nbsp;of&nbsp;G&nbsp;compatible&nbsp;with&nbsp;options.base
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line722"></a>722</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chain&nbsp;:=&nbsp;StructuralCopy(&nbsp;StabChainMutable(&nbsp;G&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line723"></a>723</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(&nbsp;options.base&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line724"></a>724</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ChangeStabChain(&nbsp;chain,&nbsp;options.base,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line725"></a>725</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsBound(&nbsp;options.reduced&nbsp;)&nbsp;and&nbsp;options.reduced&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line726"></a>726</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line727"></a>727</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line728"></a>728</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;LargestMovedPoint(&nbsp;Concatenation(&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line729"></a>729</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gens&nbsp;)&nbsp;)&nbsp;&lt;=&nbsp;100&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line730"></a>730</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options&nbsp;:=&nbsp;ShallowCopy(&nbsp;options&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line731"></a>731</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options.base&nbsp;:=&nbsp;BaseStabChain(&nbsp;chain&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line732"></a>732</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;g&nbsp;&nbsp;in&nbsp;gens&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line733"></a>733</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;SiftedPermutation(&nbsp;chain,&nbsp;g&nbsp;)&nbsp;&lt;>&nbsp;chain.identity&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line734"></a>734</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StabChainStrong(&nbsp;chain,&nbsp;[&nbsp;g&nbsp;],&nbsp;options&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line735"></a>735</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line736"></a>736</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line737"></a>737</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line738"></a>738</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chain&nbsp;:=&nbsp;ClosureRandomPermGroup(&nbsp;chain,&nbsp;gens,&nbsp;options&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line739"></a>739</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line740"></a>740</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line741"></a>741</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;newgens:=Concatenation(GeneratorsOfGroup(G),gens);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line742"></a>742</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(chain.generators)&lt;=Length(newgens)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line743"></a>743</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;inpar&nbsp;&nbsp;then&nbsp;&nbsp;C&nbsp;:=&nbsp;GroupStabChain(&nbsp;P,&nbsp;chain,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line744"></a>744</td><td></td><td></td><td></td><td><span><tt>		else&nbsp;&nbsp;C&nbsp;:=&nbsp;GroupStabChain(&nbsp;chain&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line745"></a>745</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line746"></a>746</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;inpar&nbsp;&nbsp;then&nbsp;&nbsp;C&nbsp;:=&nbsp;SubgroupNC(P,newgens);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line747"></a>747</td><td></td><td></td><td></td><td><span><tt>		else&nbsp;&nbsp;C&nbsp;:=&nbsp;Group(&nbsp;newgens,One(G)&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line748"></a>748</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetStabChainMutable(C,chain);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line749"></a>749</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line750"></a>750</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetStabChainOptions(&nbsp;C,&nbsp;rec(&nbsp;random&nbsp;:=&nbsp;options.random&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line751"></a>751</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line752"></a>752</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;UseSubsetRelation(&nbsp;C,&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line753"></a>753</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;C;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line754"></a>754</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line755"></a>755</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line756"></a>756</td><td></td><td></td><td></td><td><span><tt>BindGlobal("PG_EMPTY_OPT",rec());
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line757"></a>757</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line758"></a>758</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;ClosureGroup,"permgroup,&nbsp;elements,&nbsp;options",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line759"></a>759</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line760"></a>760</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup,&nbsp;IsList&nbsp;and&nbsp;IsPermCollection,&nbsp;IsRecord&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line761"></a>761</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;DoClosurePrmGp);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line762"></a>762</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line763"></a>763</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;ClosureGroup,&nbsp;"empty&nbsp;list",true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line764"></a>764</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup,&nbsp;IsList&nbsp;and&nbsp;IsEmpty&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line765"></a>765</td><td></td><td></td><td></td><td><span><tt>function(&nbsp;G,&nbsp;nogens&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line766"></a>766</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line767"></a>767</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line768"></a>768</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line769"></a>769</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ClosureGroup,&nbsp;"permgroup,&nbsp;element",true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line770"></a>770</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[&nbsp;IsPermGroup,&nbsp;IsPerm&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line771"></a>771</td><td></td><td></td><td></td><td><span><tt>function(&nbsp;G,&nbsp;g&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line772"></a>772</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;DoClosurePrmGp(&nbsp;G,&nbsp;[&nbsp;g&nbsp;],&nbsp;PG_EMPTY_OPT&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line773"></a>773</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line774"></a>774</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line775"></a>775</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ClosureGroup,&nbsp;"permgroup,&nbsp;elements",true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line776"></a>776</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup,&nbsp;IsList&nbsp;and&nbsp;IsPermCollection&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line777"></a>777</td><td></td><td></td><td></td><td><span><tt>function(&nbsp;G,&nbsp;gens&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line778"></a>778</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;DoClosurePrmGp(&nbsp;G,&nbsp;gens,&nbsp;PG_EMPTY_OPT&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line779"></a>779</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line780"></a>780</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line781"></a>781</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;ClosureGroup,&nbsp;"permgroup,&nbsp;element,&nbsp;options",true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line782"></a>782</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[&nbsp;IsPermGroup,&nbsp;IsPerm,&nbsp;IsRecord&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line783"></a>783</td><td></td><td></td><td></td><td><span><tt>function(&nbsp;G,&nbsp;g,&nbsp;options&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line784"></a>784</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;DoClosurePrmGp(&nbsp;G,&nbsp;[&nbsp;g&nbsp;],&nbsp;options&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line785"></a>785</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line786"></a>786</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line787"></a>787</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;ClosureGroup,&nbsp;"permgroup,&nbsp;permgroup,&nbsp;options",&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line788"></a>788</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[&nbsp;IsPermGroup,&nbsp;IsPermGroup,&nbsp;IsRecord&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line789"></a>789</td><td></td><td></td><td></td><td><span><tt>function(&nbsp;G,&nbsp;H,&nbsp;options&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line790"></a>790</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;DoClosurePrmGp(&nbsp;G,&nbsp;GeneratorsOfGroup(&nbsp;H&nbsp;),&nbsp;options&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line791"></a>791</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line792"></a>792</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line793"></a>793</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;ClosureGroup,&nbsp;"empty&nbsp;list&nbsp;and&nbsp;options",true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line794"></a>794</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup,&nbsp;IsList&nbsp;and&nbsp;IsEmpty,&nbsp;IsRecord&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line795"></a>795</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G,&nbsp;nogens,&nbsp;options&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line796"></a>796</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line797"></a>797</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line798"></a>798</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line799"></a>799</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line800"></a>800</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line801"></a>801</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;NormalClosureOp(&nbsp;&lt;G>,&nbsp;&lt;U>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;in&nbsp;perm&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line802"></a>802</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line803"></a>803</td><td></td><td></td><td></td><td><span><tt>BindGlobal("DoNormalClosurePermGroup",function&nbsp;(&nbsp;G,&nbsp;U&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line804"></a>804</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;N,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;normal&nbsp;closure&nbsp;of&nbsp;&lt;U>&nbsp;in&nbsp;&lt;G>,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line805"></a>805</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chain,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;stabilizer&nbsp;chain&nbsp;for&nbsp;the&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line806"></a>806</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rchain,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;restored&nbsp;version&nbsp;of&nbsp;&lt;chain>,&nbsp;for&nbsp;`VerifySGS'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line807"></a>807</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;options&nbsp;record&nbsp;for&nbsp;stabilizer&nbsp;chain&nbsp;construction
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line808"></a>808</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gensG,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;generators&nbsp;of&nbsp;the&nbsp;group&nbsp;&lt;G>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line809"></a>809</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genG,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;generator&nbsp;of&nbsp;the&nbsp;group&nbsp;&lt;G>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line810"></a>810</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gensN,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;generators&nbsp;of&nbsp;the&nbsp;group&nbsp;&lt;N>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line811"></a>811</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genN,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;generator&nbsp;of&nbsp;the&nbsp;group&nbsp;&lt;N>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line812"></a>812</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnj,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;conjugated&nbsp;of&nbsp;a&nbsp;generator&nbsp;of&nbsp;&lt;U>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line813"></a>813</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;random,&nbsp;&nbsp;k,&nbsp;#&nbsp;values&nbsp;measuring&nbsp;randomness&nbsp;of&nbsp;&lt;chain>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line814"></a>814</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param,&nbsp;&nbsp;missing,&nbsp;&nbsp;correct,&nbsp;&nbsp;result,&nbsp;&nbsp;i,&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line815"></a>815</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line816"></a>816</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;get&nbsp;a&nbsp;set&nbsp;of&nbsp;monoid&nbsp;generators&nbsp;of&nbsp;&lt;G>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line817"></a>817</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;gensG&nbsp;:=&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line818"></a>818</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;one:=&nbsp;One(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line819"></a>819</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line820"></a>820</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;group&nbsp;to&nbsp;be&nbsp;closed
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line821"></a>821</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;N&nbsp;:=&nbsp;SubgroupNC(&nbsp;G,&nbsp;GeneratorsOfGroup(U)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line822"></a>822</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;UseIsomorphismRelation(U,N);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line823"></a>823</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;UseSubsetRelation(U,N);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line824"></a>824</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetStabChainMutable(&nbsp;N,&nbsp;StabChainMutable(&nbsp;U&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line825"></a>825</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;options&nbsp;:=&nbsp;ShallowCopy(&nbsp;StabChainOptions(&nbsp;U&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line826"></a>826</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(&nbsp;options.random&nbsp;)&nbsp;&nbsp;then&nbsp;&nbsp;random&nbsp;:=&nbsp;options.random;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line827"></a>827</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;random&nbsp;:=&nbsp;1000;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line828"></a>828</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;options.temp&nbsp;&nbsp;&nbsp;:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line829"></a>829</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line830"></a>830</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;list&nbsp;of&nbsp;conjugates&nbsp;to&nbsp;be&nbsp;added&nbsp;to&nbsp;N
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line831"></a>831</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line832"></a>832</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gensN&nbsp;:=&nbsp;[&nbsp;&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line833"></a>833</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;10&nbsp;]&nbsp;&nbsp;do&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line834"></a>834</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;genG&nbsp;:=&nbsp;SCRRandomSubproduct(&nbsp;gensG,&nbsp;One(&nbsp;G&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line835"></a>835</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnj&nbsp;&nbsp;:=&nbsp;SCRRandomSubproduct(&nbsp;Concatenation(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line836"></a>836</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneratorsOfGroup(&nbsp;N&nbsp;),&nbsp;gensN&nbsp;),&nbsp;One(&nbsp;G&nbsp;)&nbsp;)&nbsp;^&nbsp;genG;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line837"></a>837</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;cnj&nbsp;in&nbsp;N&nbsp;&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line838"></a>838</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;gensN,&nbsp;cnj&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line839"></a>839</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line840"></a>840</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line841"></a>841</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsEmpty(&nbsp;gensN&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line842"></a>842</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N&nbsp;:=&nbsp;ClosureGroup(&nbsp;N,&nbsp;gensN,&nbsp;options&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line843"></a>843</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line844"></a>844</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;IsEmpty(&nbsp;gensN&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line845"></a>845</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line846"></a>846</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Guarantee&nbsp;that&nbsp;all&nbsp;conjugates&nbsp;are&nbsp;in&nbsp;the&nbsp;normal&nbsp;&nbsp;closure:&nbsp;Loop&nbsp;over&nbsp;all
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line847"></a>847</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;generators&nbsp;of&nbsp;N
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line848"></a>848</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;gensN&nbsp;:=&nbsp;ShallowCopy(&nbsp;GeneratorsOfGroup(&nbsp;N&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line849"></a>849</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;genN&nbsp;&nbsp;in&nbsp;gensN&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line850"></a>850</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line851"></a>851</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;the&nbsp;generators&nbsp;of&nbsp;G
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line852"></a>852</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;genG&nbsp;&nbsp;in&nbsp;gensG&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line853"></a>853</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line854"></a>854</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;make&nbsp;sure&nbsp;that&nbsp;the&nbsp;conjugated&nbsp;element&nbsp;is&nbsp;in&nbsp;the&nbsp;closure
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line855"></a>855</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnj&nbsp;:=&nbsp;genN&nbsp;^&nbsp;genG;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line856"></a>856</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;cnj&nbsp;in&nbsp;N&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line857"></a>857</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N&nbsp;:=&nbsp;ClosureGroup(&nbsp;N,&nbsp;[&nbsp;cnj&nbsp;],&nbsp;options&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line858"></a>858</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;gensN,&nbsp;cnj&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line859"></a>859</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line860"></a>860</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line861"></a>861</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line862"></a>862</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line863"></a>863</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line864"></a>864</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line865"></a>865</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Verify&nbsp;the&nbsp;stabilizer&nbsp;chain.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line866"></a>866</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chain&nbsp;:=&nbsp;StabChainMutable(&nbsp;N&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line867"></a>867</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsBound(&nbsp;chain.orbits&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line868"></a>868</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(&nbsp;chain.aux&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line869"></a>869</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chain&nbsp;:=&nbsp;SCRRestoredRecord(&nbsp;chain&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line870"></a>870</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line871"></a>871</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;chain.identity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line872"></a>872</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;random&nbsp;=&nbsp;1000&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line873"></a>873</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;missing&nbsp;:=&nbsp;chain.missing;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line874"></a>874</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;correct&nbsp;:=&nbsp;chain.correct;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line875"></a>875</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rchain&nbsp;&nbsp;:=&nbsp;SCRRestoredRecord(&nbsp;chain&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line876"></a>876</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;&nbsp;:=&nbsp;VerifySGS(&nbsp;rchain,&nbsp;missing,&nbsp;correct&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line877"></a>877</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsPerm(result)&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line878"></a>878</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line879"></a>879</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;SCRStrongGenTest2(chain,[0,0,1,10/chain.diam,0,0]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line880"></a>880</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;result&nbsp;&lt;>&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line881"></a>881</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line882"></a>882</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chain&nbsp;:=&nbsp;rchain;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line883"></a>883</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line884"></a>884</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;:=&nbsp;First([0..14],x->(3/5)^x&nbsp;&lt;=&nbsp;1-random/1000);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line885"></a>885</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(options.knownBase)&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line886"></a>886</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param&nbsp;:=&nbsp;[k,4,0,0,0,0];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line887"></a>887</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line888"></a>888</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param&nbsp;:=&nbsp;[QuoInt(k,2),4,QuoInt(k+1,2),4,50,5];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line889"></a>889</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line890"></a>890</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;options.random&nbsp;&lt;=&nbsp;200&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line891"></a>891</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param[2]&nbsp;:=&nbsp;2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line892"></a>892</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param[4]&nbsp;:=&nbsp;2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line893"></a>893</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line894"></a>894</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;SCRStrongGenTest(&nbsp;chain,&nbsp;param,&nbsp;chain.orbits,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line895"></a>895</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chain.basesize,&nbsp;chain.base,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line896"></a>896</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chain.correct,&nbsp;chain.missing&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line897"></a>897</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;result&nbsp;=&nbsp;chain.identity&nbsp;&nbsp;and&nbsp;&nbsp;not&nbsp;chain.correct&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line898"></a>898</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;:=&nbsp;SCRStrongGenTest2(&nbsp;chain,&nbsp;param&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line899"></a>899</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line900"></a>900</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chain&nbsp;:=&nbsp;SCRRestoredRecord(&nbsp;chain&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line901"></a>901</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line902"></a>902</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetStabChainMutable(&nbsp;N,&nbsp;chain&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line903"></a>903</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;result&nbsp;&lt;>&nbsp;chain.identity&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line904"></a>904</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N&nbsp;:=&nbsp;ClosureGroup(&nbsp;N,&nbsp;[&nbsp;result&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line905"></a>905</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line906"></a>906</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line907"></a>907</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;give&nbsp;N&nbsp;the&nbsp;proper&nbsp;randomness
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line908"></a>908</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;StabChainOptions(N).random:=random;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line909"></a>909</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line910"></a>910</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;return&nbsp;the&nbsp;normal&nbsp;closure
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line911"></a>911</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;UseSubsetRelation(&nbsp;N,&nbsp;U&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line912"></a>912</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;N;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line913"></a>913</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line914"></a>914</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line915"></a>915</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;NormalClosureOp,&nbsp;"subgroup&nbsp;of&nbsp;perm&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line916"></a>916</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;IsIdenticalObj,&nbsp;[&nbsp;IsPermGroup,&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line917"></a>917</td><td></td><td></td><td></td><td><span><tt>function(G,U)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line918"></a>918</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;test&nbsp;applicability
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line919"></a>919</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;IsSubset(G,U)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line920"></a>920</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line921"></a>921</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line922"></a>922</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;DoNormalClosurePermGroup(G,U);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line923"></a>923</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line924"></a>924</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line925"></a>925</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line926"></a>926</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line927"></a>927</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ConjugateGroup(&nbsp;&lt;G>,&nbsp;&lt;g>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;of&nbsp;permutation&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line928"></a>928</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line929"></a>929</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ConjugateGroup,&nbsp;"&lt;P>,&nbsp;&lt;g>",&nbsp;true,&nbsp;[&nbsp;IsPermGroup,&nbsp;IsPerm&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line930"></a>930</td><td></td><td></td><td></td><td><span><tt>function(&nbsp;G,&nbsp;g&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line931"></a>931</td><td></td><td></td><td></td><td><span><tt>local&nbsp;&nbsp;&nbsp;H,&nbsp;&nbsp;S;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line932"></a>932</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line933"></a>933</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;H&nbsp;:=&nbsp;GroupByGenerators(&nbsp;OnTuples(&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;),&nbsp;g&nbsp;),&nbsp;One(&nbsp;G&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line934"></a>934</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasStabChainMutable(G)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line935"></a>935</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;:=&nbsp;EmptyStabChain(&nbsp;[&nbsp;&nbsp;],&nbsp;One(&nbsp;H&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line936"></a>936</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConjugateStabChain(&nbsp;StabChainMutable(&nbsp;G&nbsp;),&nbsp;S,&nbsp;g,&nbsp;g&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line937"></a>937</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetStabChainMutable(&nbsp;H,&nbsp;S&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line938"></a>938</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;HasSize(G)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line939"></a>939</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetSize(H,Size(G));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line940"></a>940</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line941"></a>941</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;UseIsomorphismRelation(&nbsp;G,&nbsp;H&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line942"></a>942</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;H;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line943"></a>943</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line944"></a>944</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line945"></a>945</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line946"></a>946</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line947"></a>947</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;CommutatorSubgroup(&nbsp;&lt;U>,&nbsp;&lt;V>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;for&nbsp;perm&nbsp;groups
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line948"></a>948</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line949"></a>949</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;CommutatorSubgroup,&nbsp;"permgroups",&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line950"></a>950</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup,&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line951"></a>951</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;U,&nbsp;V&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line952"></a>952</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;C,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;commutator&nbsp;subgroup
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line953"></a>953</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CUV,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;closure&nbsp;of&nbsp;U,V
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line954"></a>954</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doneCUV,&nbsp;#&nbsp;boolean;&nbsp;true&nbsp;if&nbsp;CUV&nbsp;is&nbsp;computed
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line955"></a>955</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;random&nbsp;subproduct&nbsp;of&nbsp;U.generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line956"></a>956</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;random&nbsp;subproduct&nbsp;of&nbsp;V.generators&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line957"></a>957</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;commutator&nbsp;of&nbsp;u,v
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line958"></a>958</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;commutators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line959"></a>959</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;variable
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line960"></a>960</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line961"></a>961</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;[&nbsp;&lt;U>,&nbsp;&lt;V>&nbsp;]&nbsp;=&nbsp;normal&nbsp;closure&nbsp;of&nbsp;&lt;&nbsp;[&nbsp;&lt;u>,&nbsp;&lt;v>&nbsp;]&nbsp;>.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line962"></a>962</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;:=&nbsp;TrivialSubgroup(&nbsp;U&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line963"></a>963</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;doneCUV&nbsp;:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line964"></a>964</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line965"></a>965</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;there&nbsp;are&nbsp;lot&nbsp;of&nbsp;generators,&nbsp;use&nbsp;random&nbsp;subproducts
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line966"></a>966</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;GeneratorsOfGroup(&nbsp;U&nbsp;)&nbsp;)&nbsp;*
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line967"></a>967</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Length(&nbsp;GeneratorsOfGroup(&nbsp;V&nbsp;)&nbsp;)&nbsp;>&nbsp;10&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line968"></a>968</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line969"></a>969</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line970"></a>970</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..10]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line971"></a>971</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u&nbsp;:=&nbsp;SCRRandomSubproduct(&nbsp;GeneratorsOfGroup(&nbsp;U&nbsp;),&nbsp;One(&nbsp;U&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line972"></a>972</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;:=&nbsp;SCRRandomSubproduct(&nbsp;GeneratorsOfGroup(&nbsp;V&nbsp;),&nbsp;One(&nbsp;V&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line973"></a>973</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm&nbsp;:=&nbsp;Comm(&nbsp;u,&nbsp;v&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line974"></a>974</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;comm&nbsp;in&nbsp;C&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line975"></a>975</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;list,&nbsp;comm&nbsp;)&nbsp;;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line976"></a>976</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line977"></a>977</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line978"></a>978</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(list)&nbsp;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line979"></a>979</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;:=&nbsp;ClosureGroup(&nbsp;C,&nbsp;list,&nbsp;rec(&nbsp;random&nbsp;:=&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line980"></a>980</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp&nbsp;:=&nbsp;true&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line981"></a>981</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;doneCUV&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line982"></a>982</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CUV&nbsp;:=&nbsp;ClosureGroup(&nbsp;U,&nbsp;V&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line983"></a>983</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doneCUV&nbsp;:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line984"></a>984</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line985"></a>985</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;force&nbsp;closure&nbsp;test
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line986"></a>986</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StabChainOptions(C).random:=DefaultStabChainOptions.random;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line987"></a>987</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;:=&nbsp;DoNormalClosurePermGroup(&nbsp;CUV,&nbsp;C&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line988"></a>988</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line989"></a>989</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;IsEmpty(&nbsp;list&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line990"></a>990</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line991"></a>991</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line992"></a>992</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;do&nbsp;the&nbsp;deterministic&nbsp;method;&nbsp;it&nbsp;will&nbsp;also&nbsp;check&nbsp;correctness&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line993"></a>993</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;list&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line994"></a>994</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;u&nbsp;&nbsp;in&nbsp;GeneratorsOfGroup(&nbsp;U&nbsp;)&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line995"></a>995</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;v&nbsp;&nbsp;in&nbsp;GeneratorsOfGroup(&nbsp;V&nbsp;)&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line996"></a>996</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm&nbsp;:=&nbsp;Comm(&nbsp;u,&nbsp;v&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line997"></a>997</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;comm&nbsp;in&nbsp;C&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line998"></a>998</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;list,&nbsp;comm&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line999"></a>999</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1000"></a>1000</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1001"></a>1001</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1002"></a>1002</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsEmpty(&nbsp;list&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1003"></a>1003</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;:=&nbsp;ClosureGroup(&nbsp;C,&nbsp;list,&nbsp;rec(&nbsp;random&nbsp;:=&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1004"></a>1004</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp&nbsp;:=&nbsp;true&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1005"></a>1005</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;doneCUV&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1006"></a>1006</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CUV&nbsp;:=&nbsp;ClosureGroup(&nbsp;U,&nbsp;V&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1007"></a>1007</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doneCUV&nbsp;:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1008"></a>1008</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1009"></a>1009</td><td></td><td></td><td></td><td><span><tt>	#&nbsp;force&nbsp;closure&nbsp;test
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1010"></a>1010</td><td></td><td></td><td></td><td><span><tt>	StabChainOptions(C).random:=DefaultStabChainOptions.random;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1011"></a>1011</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;:=&nbsp;DoNormalClosurePermGroup(&nbsp;CUV,&nbsp;C&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1012"></a>1012</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1013"></a>1013</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1014"></a>1014</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;C;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1015"></a>1015</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1016"></a>1016</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1017"></a>1017</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1018"></a>1018</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1019"></a>1019</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DerivedSubgroup(&nbsp;&lt;G>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;of&nbsp;permutation&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1020"></a>1020</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1021"></a>1021</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DerivedSubgroup,"permgrps",true,&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1022"></a>1022</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1023"></a>1023</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;D,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;derived&nbsp;subgroup&nbsp;of&nbsp;&lt;G>,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1024"></a>1024</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g,&nbsp;h,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;random&nbsp;subproducts&nbsp;of&nbsp;generators&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1025"></a>1025</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;their&nbsp;commutator
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1026"></a>1026</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;commutators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1027"></a>1027</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,j;&nbsp;&nbsp;#&nbsp;loop&nbsp;variables
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1028"></a>1028</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1029"></a>1029</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;find&nbsp;the&nbsp;subgroup&nbsp;generated&nbsp;by&nbsp;the&nbsp;commutators&nbsp;of&nbsp;the&nbsp;generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1030"></a>1030</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;:=&nbsp;TrivialSubgroup(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1031"></a>1031</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1032"></a>1032</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;there&nbsp;are&nbsp;>4&nbsp;generators,&nbsp;use&nbsp;random&nbsp;subproducts
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1033"></a>1033</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;)&nbsp;)&nbsp;>&nbsp;4&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1034"></a>1034</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1035"></a>1035</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1036"></a>1036</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..10]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1037"></a>1037</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g&nbsp;:=&nbsp;SCRRandomSubproduct(&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;),&nbsp;One(&nbsp;G&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1038"></a>1038</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;:=&nbsp;SCRRandomSubproduct(&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;),&nbsp;One(&nbsp;G&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1039"></a>1039</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm&nbsp;:=&nbsp;Comm(&nbsp;g,&nbsp;h&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1040"></a>1040</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;comm&nbsp;in&nbsp;D&nbsp;then&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1041"></a>1041</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;list,&nbsp;comm&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1042"></a>1042</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1043"></a>1043</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1044"></a>1044</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(list)&nbsp;>&nbsp;0&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1045"></a>1045</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;:=&nbsp;ClosureGroup(D,list,rec(&nbsp;random&nbsp;:=&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1046"></a>1046</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp&nbsp;:=&nbsp;true&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1047"></a>1047</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;force&nbsp;closure&nbsp;test
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1048"></a>1048</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(StabChainOptions(G).random)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1049"></a>1049</td><td></td><td></td><td></td><td><span><tt>		StabChainOptions(D).random:=StabChainOptions(G).random;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1050"></a>1050</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1051"></a>1051</td><td></td><td></td><td></td><td><span><tt>		StabChainOptions(D).random:=DefaultStabChainOptions.random;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1052"></a>1052</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1053"></a>1053</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;:=&nbsp;DoNormalClosurePermGroup(&nbsp;G,&nbsp;D&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1054"></a>1054</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1055"></a>1055</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;list&nbsp;=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1056"></a>1056</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1057"></a>1057</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1058"></a>1058</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;do&nbsp;the&nbsp;deterministic&nbsp;method;&nbsp;it&nbsp;will&nbsp;also&nbsp;check&nbsp;random&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1059"></a>1059</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;list&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1060"></a>1060</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;2&nbsp;..&nbsp;Length(&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;)&nbsp;)&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1061"></a>1061</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;i&nbsp;-&nbsp;1&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1062"></a>1062</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;comm&nbsp;:=&nbsp;Comm(&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;)[i],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1063"></a>1063</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;)[j]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1064"></a>1064</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;comm&nbsp;in&nbsp;D&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1065"></a>1065</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;list,&nbsp;comm&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1066"></a>1066</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1067"></a>1067</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1068"></a>1068</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1069"></a>1069</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsEmpty(&nbsp;list&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1070"></a>1070</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;:=&nbsp;ClosureGroup(D,list,rec(&nbsp;random&nbsp;:=&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1071"></a>1071</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp&nbsp;:=&nbsp;true&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1072"></a>1072</td><td></td><td></td><td></td><td><span><tt>	#&nbsp;give&nbsp;D&nbsp;a&nbsp;proper&nbsp;randomness
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1073"></a>1073</td><td></td><td></td><td></td><td><span><tt>	if&nbsp;IsBound(StabChainOptions(G).random)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1074"></a>1074</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;StabChainOptions(D).random:=StabChainOptions(G).random;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1075"></a>1075</td><td></td><td></td><td></td><td><span><tt>	else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1076"></a>1076</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;StabChainOptions(D).random:=DefaultStabChainOptions.random;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1077"></a>1077</td><td></td><td></td><td></td><td><span><tt>	fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1078"></a>1078</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1079"></a>1079</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;:=&nbsp;DoNormalClosurePermGroup(&nbsp;G,&nbsp;D&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1080"></a>1080</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1081"></a>1081</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1082"></a>1082</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasIsNaturalSymmetricGroup(G)&nbsp;and&nbsp;Size(D)&lt;Size(G)&nbsp;then&nbsp;IsNaturalAlternatingGroup(D);fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1083"></a>1083</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1084"></a>1084</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;D;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1085"></a>1085</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1086"></a>1086</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1087"></a>1087</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1088"></a>1088</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1089"></a>1089</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsSimpleGroup(&nbsp;&lt;G>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;test&nbsp;if&nbsp;a&nbsp;permutation&nbsp;group&nbsp;is&nbsp;simple
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1090"></a>1090</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1091"></a>1091</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;This&nbsp;&nbsp;is&nbsp;&nbsp;a&nbsp;most&nbsp;interesting&nbsp;function.&nbsp;&nbsp;&nbsp;It&nbsp;&nbsp;tests&nbsp;whether&nbsp;&nbsp;a&nbsp;permutation
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1092"></a>1092</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;group&nbsp;is&nbsp;&nbsp;simple&nbsp;&nbsp;by&nbsp;testing&nbsp;whether&nbsp;the&nbsp;group&nbsp;is&nbsp;&nbsp;perfect&nbsp;and&nbsp;then&nbsp;&nbsp;only
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1093"></a>1093</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;looking&nbsp;at&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;group&nbsp;and&nbsp;the&nbsp;degree&nbsp;of&nbsp;a&nbsp;primitive&nbsp;operation.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1094"></a>1094</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Basically&nbsp;&nbsp;it&nbsp;uses&nbsp;&nbsp;the&nbsp;O'Nan--Scott&nbsp;theorem,&nbsp;which&nbsp;gives&nbsp;&nbsp;a&nbsp;pretty&nbsp;clear
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1095"></a>1095</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;description&nbsp;of&nbsp;perfect&nbsp;primitive&nbsp;groups.&nbsp;&nbsp;This&nbsp;algorithm&nbsp;is&nbsp;described&nbsp;&nbsp;in
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1096"></a>1096</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;William&nbsp;M.&nbsp;Kantor,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1097"></a>1097</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Finding&nbsp;Composition&nbsp;Factors&nbsp;of&nbsp;Permutation&nbsp;Groups&nbsp;of&nbsp;Degree&nbsp;$n\leq&nbsp;10^6$,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1098"></a>1098</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;J.&nbsp;Symbolic&nbsp;Computation,&nbsp;12:517--526,&nbsp;1991.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1099"></a>1099</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1100"></a>1100</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsSimpleGroup,"for&nbsp;permgrp",&nbsp;true,&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1101"></a>1101</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;(&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1102"></a>1102</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;D,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;operation&nbsp;domain&nbsp;of&nbsp;&lt;G>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1103"></a>1103</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hom,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;transitive&nbsp;constituent&nbsp;or&nbsp;blocks&nbsp;homomorphism
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1104"></a>1104</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;degree&nbsp;of&nbsp;&lt;G>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1105"></a>1105</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n,&nbsp;m,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;$d&nbsp;=&nbsp;n^m$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1106"></a>1106</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;simple,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;orders&nbsp;of&nbsp;simple&nbsp;groups
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1107"></a>1107</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transperf,&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;orders&nbsp;of&nbsp;transitive&nbsp;perfect&nbsp;groups
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1108"></a>1108</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s,&nbsp;t;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;variables
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1109"></a>1109</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1110"></a>1110</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;&lt;G>&nbsp;is&nbsp;the&nbsp;trivial&nbsp;group,&nbsp;it&nbsp;is&nbsp;not&nbsp;simple
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1111"></a>1111</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsTrivial(&nbsp;G&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1112"></a>1112</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1113"></a>1113</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1114"></a>1114</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1115"></a>1115</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;first&nbsp;find&nbsp;a&nbsp;transitive&nbsp;representation&nbsp;for&nbsp;&lt;G>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1116"></a>1116</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;:=&nbsp;Orbit(&nbsp;G,&nbsp;SmallestMovedPoint(&nbsp;G&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1117"></a>1117</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsEqualSet(&nbsp;MovedPoints(&nbsp;G&nbsp;),&nbsp;D&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1118"></a>1118</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hom&nbsp;:=&nbsp;ActionHomomorphism(&nbsp;G,&nbsp;D,"surjective"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1119"></a>1119</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Size(&nbsp;G&nbsp;)&nbsp;&lt;>&nbsp;Size(&nbsp;Image(&nbsp;hom&nbsp;)&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1120"></a>1120</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1121"></a>1121</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1122"></a>1122</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;:=&nbsp;Image(&nbsp;hom&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1123"></a>1123</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1124"></a>1124</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1125"></a>1125</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;next&nbsp;find&nbsp;a&nbsp;primitive&nbsp;representation&nbsp;for&nbsp;&lt;G>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1126"></a>1126</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;:=&nbsp;Blocks(&nbsp;G,&nbsp;MovedPoints(&nbsp;G&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1127"></a>1127</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;Length(&nbsp;D&nbsp;)&nbsp;&lt;>&nbsp;1&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1128"></a>1128</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hom&nbsp;:=&nbsp;ActionHomomorphism(&nbsp;G,&nbsp;D,&nbsp;OnSets,"surjective"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1129"></a>1129</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Size(&nbsp;G&nbsp;)&nbsp;&lt;>&nbsp;Size(&nbsp;Image(&nbsp;hom&nbsp;)&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1130"></a>1130</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1131"></a>1131</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1132"></a>1132</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;:=&nbsp;Image(&nbsp;hom&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1133"></a>1133</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;:=&nbsp;Blocks(&nbsp;G,&nbsp;MovedPoints(&nbsp;G&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1134"></a>1134</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1135"></a>1135</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1136"></a>1136</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;compute&nbsp;the&nbsp;degree&nbsp;$d$&nbsp;and&nbsp;express&nbsp;it&nbsp;as&nbsp;$d&nbsp;=&nbsp;n^m$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1137"></a>1137</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;:=&nbsp;MovedPoints(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1138"></a>1138</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;Length(&nbsp;D&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1139"></a>1139</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;:=&nbsp;SmallestRootInt(&nbsp;d&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1140"></a>1140</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;LogInt(&nbsp;d,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1141"></a>1141</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;10^6&nbsp;&lt;&nbsp;d&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1142"></a>1142</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error("cannot&nbsp;decide&nbsp;whether&nbsp;&lt;G>&nbsp;is&nbsp;simple&nbsp;or&nbsp;not");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1143"></a>1143</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1144"></a>1144</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1145"></a>1145</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;$G&nbsp;=&nbsp;C_p$,&nbsp;it&nbsp;is&nbsp;simple
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1146"></a>1146</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;&nbsp;IsPrimeInt(&nbsp;Size(&nbsp;G&nbsp;)&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1147"></a>1147</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1148"></a>1148</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1149"></a>1149</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;$G&nbsp;=&nbsp;A_d$,&nbsp;it&nbsp;is&nbsp;simple&nbsp;(unless&nbsp;$d&nbsp;&lt;&nbsp;5$)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1150"></a>1150</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;&nbsp;IsNaturalAlternatingGroup(G)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1151"></a>1151</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;5&nbsp;&lt;=&nbsp;d;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1152"></a>1152</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1153"></a>1153</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;$G&nbsp;=&nbsp;S_d$,&nbsp;it&nbsp;is&nbsp;not&nbsp;simple&nbsp;(except&nbsp;$S_2$)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1154"></a>1154</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;&nbsp;IsNaturalSymmetricGroup(G)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1155"></a>1155</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;2&nbsp;=&nbsp;d;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1156"></a>1156</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1157"></a>1157</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;$G$&nbsp;is&nbsp;not&nbsp;perfect,&nbsp;it&nbsp;is&nbsp;not&nbsp;simple&nbsp;(unless&nbsp;$G&nbsp;=&nbsp;C_p$,&nbsp;see&nbsp;above)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1158"></a>1158</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;&nbsp;Size(&nbsp;DerivedSubgroup(&nbsp;G&nbsp;)&nbsp;)&nbsp;&lt;&nbsp;Size(&nbsp;G&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1159"></a>1159</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1160"></a>1160</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1161"></a>1161</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;$\|G\|&nbsp;=&nbsp;d^2$,&nbsp;it&nbsp;is&nbsp;not&nbsp;simple&nbsp;(Kantor's&nbsp;Lemma&nbsp;4)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1162"></a>1162</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;&nbsp;Size(&nbsp;G&nbsp;)&nbsp;=&nbsp;d&nbsp;^&nbsp;2&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1163"></a>1163</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1164"></a>1164</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1165"></a>1165</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;$d$&nbsp;is&nbsp;a&nbsp;prime,&nbsp;&lt;G>&nbsp;is&nbsp;simple
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1166"></a>1166</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;&nbsp;IsPrimeInt(&nbsp;d&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1167"></a>1167</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1168"></a>1168</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1169"></a>1169</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;$G&nbsp;=&nbsp;U(4,2)$,&nbsp;it&nbsp;is&nbsp;simple&nbsp;(operation&nbsp;on&nbsp;27&nbsp;points)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1170"></a>1170</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;&nbsp;d&nbsp;=&nbsp;27&nbsp;and&nbsp;Size(&nbsp;G&nbsp;)&nbsp;=&nbsp;25920&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1171"></a>1171</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1172"></a>1172</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1173"></a>1173</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;$G&nbsp;=&nbsp;PSL(n,q)$,&nbsp;it&nbsp;is&nbsp;simple&nbsp;(operations&nbsp;on&nbsp;prime&nbsp;power&nbsp;points)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1174"></a>1174</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;&nbsp;(&nbsp;&nbsp;(d&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;and&nbsp;Size(G)&nbsp;=&nbsp;(7^3-7)/2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;&nbsp;#&nbsp;PSL(2,7)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1175"></a>1175</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;(d&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;and&nbsp;Size(G)&nbsp;=&nbsp;(8^3-8)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;&nbsp;#&nbsp;PSL(2,8)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1176"></a>1176</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;(d&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;32&nbsp;and&nbsp;Size(G)&nbsp;=&nbsp;(31^3-31)/2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;&nbsp;#&nbsp;PSL(2,31)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1177"></a>1177</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;(d&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;121&nbsp;and&nbsp;Size(G)&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;237783237120)&nbsp;&nbsp;#&nbsp;PSL(5,3)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1178"></a>1178</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;(d&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;128&nbsp;and&nbsp;Size(G)&nbsp;=&nbsp;(127^3-127)/2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;&nbsp;#&nbsp;PSL(2,127)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1179"></a>1179</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;(d&nbsp;=&nbsp;&nbsp;&nbsp;8192&nbsp;and&nbsp;Size(G)&nbsp;=&nbsp;(8191^3-8191)/2&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;&nbsp;#&nbsp;PSL(2,8191)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1180"></a>1180</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;(d&nbsp;=&nbsp;131072&nbsp;and&nbsp;Size(G)&nbsp;=&nbsp;(131071^3-131071)/2)&nbsp;&nbsp;#&nbsp;PSL(2,131071)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1181"></a>1181</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;(d&nbsp;=&nbsp;524288&nbsp;and&nbsp;Size(G)&nbsp;=&nbsp;(524287^3-524287)/2))&nbsp;#&nbsp;PSL(2,524287)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1182"></a>1182</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;IsTransitive(&nbsp;Stabilizer(&nbsp;G,&nbsp;D[1]&nbsp;),&nbsp;Difference(&nbsp;D,&nbsp;[&nbsp;D[1]&nbsp;]&nbsp;)&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1183"></a>1183</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1184"></a>1184</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1185"></a>1185</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1186"></a>1186</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;$d$&nbsp;is&nbsp;a&nbsp;prime&nbsp;power,&nbsp;&lt;G>&nbsp;is&nbsp;not&nbsp;simple&nbsp;(except&nbsp;the&nbsp;cases&nbsp;above)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1187"></a>1187</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;&nbsp;IsPrimePowerInt(&nbsp;d&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1188"></a>1188</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1189"></a>1189</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1190"></a>1190</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;we&nbsp;don't&nbsp;have&nbsp;at&nbsp;least&nbsp;an&nbsp;$A_5$&nbsp;acting&nbsp;on&nbsp;the&nbsp;top,&nbsp;&lt;G>&nbsp;is&nbsp;simple
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1191"></a>1191</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;&nbsp;m&nbsp;&lt;&nbsp;5&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1192"></a>1192</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1193"></a>1193</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1194"></a>1194</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;otherwise&nbsp;we&nbsp;must&nbsp;check&nbsp;for&nbsp;some&nbsp;special&nbsp;cases
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1195"></a>1195</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1196"></a>1196</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1197"></a>1197</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;orders&nbsp;of&nbsp;simple&nbsp;subgroups&nbsp;of&nbsp;$S_n$&nbsp;with&nbsp;primitive&nbsp;normalizer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1198"></a>1198</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;simple&nbsp;:=&nbsp;[&nbsp;,,,,,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1199"></a>1199</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[60,360],,,,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;5:&nbsp;A(5),&nbsp;A(6)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1200"></a>1200</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[60,360,1814400],,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;10:&nbsp;A(5),&nbsp;A(6),&nbsp;A(10)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1201"></a>1201</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[660,7920,95040,239500800],,&nbsp;&nbsp;#&nbsp;12:&nbsp;PSL(2,11),&nbsp;M(11),&nbsp;M(12),&nbsp;A(12)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1202"></a>1202</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1092,43589145600],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;14:&nbsp;PSL(2,13),&nbsp;A(14)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1203"></a>1203</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[360,2520,20160,653837184000]&nbsp;#&nbsp;15:&nbsp;A(6),&nbsp;A(7),&nbsp;A(8),&nbsp;A(15)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1204"></a>1204</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1205"></a>1205</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1206"></a>1206</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;orders&nbsp;of&nbsp;transitive&nbsp;perfect&nbsp;subgroups&nbsp;of&nbsp;$S_m$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1207"></a>1207</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transperf&nbsp;:=&nbsp;[&nbsp;,,,,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1208"></a>1208</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[60],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;5:&nbsp;A(5)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1209"></a>1209</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[60,360],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;6:&nbsp;A(5),&nbsp;A(6)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1210"></a>1210</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[168,2520],&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;7:&nbsp;PSL(3,2),&nbsp;A(7)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1211"></a>1211</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[168,8168,20160]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;8:&nbsp;PSL(3,2),&nbsp;AGL(3,2),&nbsp;A(8)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1212"></a>1212</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1213"></a>1213</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1214"></a>1214</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;test&nbsp;the&nbsp;special&nbsp;cases&nbsp;(Kantor's&nbsp;Lemma&nbsp;3)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1215"></a>1215</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;s&nbsp;&nbsp;in&nbsp;simple[n]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1216"></a>1216</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;t&nbsp;&nbsp;in&nbsp;transperf[m]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1217"></a>1217</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;&nbsp;Size(&nbsp;G&nbsp;)&nbsp;mod&nbsp;(t&nbsp;*&nbsp;s^m)&nbsp;=&nbsp;0
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1218"></a>1218</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;(((t&nbsp;*&nbsp;(2*s)^m)&nbsp;mod&nbsp;Size(&nbsp;G&nbsp;)&nbsp;=&nbsp;0&nbsp;and&nbsp;s&nbsp;&lt;>&nbsp;360)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1219"></a>1219</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;((t&nbsp;*&nbsp;(4*s)^m)&nbsp;mod&nbsp;Size(&nbsp;G&nbsp;)&nbsp;=&nbsp;0&nbsp;and&nbsp;s&nbsp;=&nbsp;&nbsp;360))
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1220"></a>1220</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1221"></a>1221</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1222"></a>1222</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1223"></a>1223</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1224"></a>1224</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1225"></a>1225</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1226"></a>1226</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;otherwise&nbsp;&lt;G>&nbsp;is&nbsp;simple
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1227"></a>1227</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1228"></a>1228</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1229"></a>1229</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1230"></a>1230</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1231"></a>1231</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1232"></a>1232</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1233"></a>1233</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1234"></a>1234</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1235"></a>1235</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsSolvableGroup(&nbsp;&lt;G>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;solvability&nbsp;test
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1236"></a>1236</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1237"></a>1237</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsSolvableGroup,"for&nbsp;permgrp",&nbsp;true,&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1238"></a>1238</td><td></td><td></td><td></td><td><span><tt>function(G)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1239"></a>1239</td><td></td><td></td><td></td><td><span><tt>local&nbsp;pcgs;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1240"></a>1240</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;pcgs:=TryPcgsPermGroup(&nbsp;G,&nbsp;false,&nbsp;false,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1241"></a>1241</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;IsPcgs(pcgs)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1242"></a>1242</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetIndicesEANormalSteps(pcgs,pcgs!.permpcgsNormalSteps);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1243"></a>1243</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetIsPcgsElementaryAbelianSeries(pcgs,true);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1244"></a>1244</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;HasPcgs(G)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1245"></a>1245</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetPcgs(G,pcgs);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1246"></a>1246</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1247"></a>1247</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;HasPcgsElementaryAbelianSeries(G)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1248"></a>1248</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetPcgsElementaryAbelianSeries(G,pcgs);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1249"></a>1249</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1250"></a>1250</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1251"></a>1251</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1252"></a>1252</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1253"></a>1253</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1254"></a>1254</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1255"></a>1255</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1256"></a>1256</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1257"></a>1257</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1258"></a>1258</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsNilpotentGroup(&nbsp;&lt;G>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;nilpotency&nbsp;test
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1259"></a>1259</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1260"></a>1260</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsNilpotentGroup,"for&nbsp;permgrp",&nbsp;true,&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1261"></a>1261</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;->&nbsp;IsPcgs(PcgsCentralSeries(G)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1262"></a>1262</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1263"></a>1263</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1264"></a>1264</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1265"></a>1265</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;PcgsCentralSeries(&nbsp;&lt;G>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1266"></a>1266</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1267"></a>1267</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;PcgsCentralSeries,"for&nbsp;permgrp",&nbsp;true,&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1268"></a>1268</td><td></td><td></td><td></td><td><span><tt>function(G)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1269"></a>1269</td><td></td><td></td><td></td><td><span><tt>local&nbsp;pcgs;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1270"></a>1270</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;pcgs:=TryPcgsPermGroup(&nbsp;G,&nbsp;true,&nbsp;false,&nbsp;false&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1271"></a>1271</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;IsPcgs(pcgs)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1272"></a>1272</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetIndicesCentralNormalSteps(pcgs,pcgs!.permpcgsNormalSteps);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1273"></a>1273</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetIsPcgsCentralSeries(pcgs,true);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1274"></a>1274</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;HasPcgs(G)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1275"></a>1275</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetPcgs(G,pcgs);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1276"></a>1276</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1277"></a>1277</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1278"></a>1278</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;pcgs;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1279"></a>1279</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1280"></a>1280</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1281"></a>1281</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1282"></a>1282</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1283"></a>1283</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;PcgsPCentralSeriesPGroup(&nbsp;&lt;G>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1284"></a>1284</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1285"></a>1285</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;PcgsPCentralSeriesPGroup,"for&nbsp;permgrp",&nbsp;true,&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1286"></a>1286</td><td></td><td></td><td></td><td><span><tt>function(G)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1287"></a>1287</td><td></td><td></td><td></td><td><span><tt>local&nbsp;pcgs;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1288"></a>1288</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;pcgs:=TryPcgsPermGroup(&nbsp;G,&nbsp;true,&nbsp;true,&nbsp;Factors(Size(G))[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1289"></a>1289</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;IsPcgs(pcgs)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1290"></a>1290</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetIndicesPCentralNormalStepsPGroup(pcgs,pcgs!.permpcgsNormalSteps);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1291"></a>1291</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetIsPcgsPCentralSeriesPGroup(pcgs,true);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1292"></a>1292</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1293"></a>1293</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;IsPcgs(pcgs)&nbsp;and&nbsp;not&nbsp;HasPcgs(G)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1294"></a>1294</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetPcgs(G,pcgs);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1295"></a>1295</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1296"></a>1296</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;pcgs;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1297"></a>1297</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1298"></a>1298</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1299"></a>1299</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;AH,&nbsp;3/26/07:&nbsp;This&nbsp;method&nbsp;triggers&nbsp;a&nbsp;bug&nbsp;with&nbsp;indices.&nbsp;It&nbsp;is&nbsp;not&nbsp;clear
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1300"></a>1300</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;form&nbsp;the&nbsp;description&nbsp;why&nbsp;TryPcgs...&nbsp;should&nbsp;also&nbsp;give&nbsp;a&nbsp;drived&nbsp;series.&nbsp;Thus
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1301"></a>1301</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;disabled.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1302"></a>1302</td><td></td><td></td><td></td><td><span><tt>#&nbsp;#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1303"></a>1303</td><td></td><td></td><td></td><td><span><tt>#&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1304"></a>1304</td><td></td><td></td><td></td><td><span><tt>#&nbsp;#M&nbsp;&nbsp;DerivedSeriesOfGroup(&nbsp;&lt;G>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;derived&nbsp;series
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1305"></a>1305</td><td></td><td></td><td></td><td><span><tt>#&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1306"></a>1306</td><td></td><td></td><td></td><td><span><tt>#&nbsp;InstallMethod(&nbsp;DerivedSeriesOfGroup,"for&nbsp;permgrp",&nbsp;true,&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1307"></a>1307</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1308"></a>1308</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;pcgs,&nbsp;&nbsp;series;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1309"></a>1309</td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1310"></a>1310</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;(not&nbsp;DefaultStabChainOptions.tryPcgs
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1311"></a>1311</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;(&nbsp;HasIsSolvableGroup(&nbsp;G&nbsp;)&nbsp;&nbsp;and&nbsp;&nbsp;not&nbsp;IsSolvableGroup(&nbsp;G&nbsp;)&nbsp;))
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1312"></a>1312</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;not&nbsp;(HasIsSolvableGroup(G)&nbsp;and&nbsp;IsSolvableGroup(G))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1313"></a>1313</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1314"></a>1314</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1315"></a>1315</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1316"></a>1316</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pcgs&nbsp;:=&nbsp;TryPcgsPermGroup(&nbsp;G,&nbsp;false,&nbsp;true,&nbsp;false&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1317"></a>1317</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsPcgs(&nbsp;pcgs&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1318"></a>1318</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1319"></a>1319</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1320"></a>1320</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetIndicesEANormalSteps(pcgs,pcgs!.permpcgsNormalSteps);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1321"></a>1321</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;series&nbsp;:=&nbsp;EANormalSeriesByPcgs(&nbsp;pcgs&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1322"></a>1322</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;HasDerivedSubgroup(&nbsp;G&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1323"></a>1323</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;series&nbsp;)&nbsp;>&nbsp;1&nbsp;&nbsp;then&nbsp;&nbsp;SetDerivedSubgroup(&nbsp;G,&nbsp;series[&nbsp;2&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1324"></a>1324</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;SetDerivedSubgroup(&nbsp;G,&nbsp;G&nbsp;);&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1325"></a>1325</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1326"></a>1326</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;series;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1327"></a>1327</td><td></td><td></td><td></td><td><span><tt>#&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1328"></a>1328</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1329"></a>1329</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1330"></a>1330</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1331"></a>1331</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;LowerCentralSeriesOfGroup(&nbsp;&lt;G>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;lower&nbsp;central&nbsp;series
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1332"></a>1332</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1333"></a>1333</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;LowerCentralSeriesOfGroup,"for&nbsp;permgrp",&nbsp;true,&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1334"></a>1334</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1335"></a>1335</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;pcgs,&nbsp;&nbsp;series;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1336"></a>1336</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1337"></a>1337</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;DefaultStabChainOptions.tryPcgs
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1338"></a>1338</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;HasIsNilpotentGroup(&nbsp;G&nbsp;)&nbsp;&nbsp;and&nbsp;&nbsp;not&nbsp;IsNilpotentGroup(&nbsp;G&nbsp;)&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1339"></a>1339</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;not&nbsp;(HasIsNilpotentGroup(G)&nbsp;and&nbsp;IsNilpotentGroup(G))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1340"></a>1340</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1341"></a>1341</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1342"></a>1342</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1343"></a>1343</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pcgs&nbsp;:=&nbsp;TryPcgsPermGroup(&nbsp;G,&nbsp;true,&nbsp;true,&nbsp;false&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1344"></a>1344</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsPcgs(&nbsp;pcgs&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1345"></a>1345</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1346"></a>1346</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1347"></a>1347</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetIndicesCentralNormalSteps(pcgs,pcgs!.permpcgsNormalSteps);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1348"></a>1348</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;series&nbsp;:=&nbsp;CentralNormalSeriesByPcgs(&nbsp;pcgs&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1349"></a>1349</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;HasDerivedSubgroup(&nbsp;G&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1350"></a>1350</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;series&nbsp;)&nbsp;>&nbsp;1&nbsp;&nbsp;then&nbsp;&nbsp;SetDerivedSubgroup(&nbsp;G,&nbsp;series[&nbsp;2&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1351"></a>1351</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;SetDerivedSubgroup(&nbsp;G,&nbsp;G&nbsp;);&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1352"></a>1352</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1353"></a>1353</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;series;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1354"></a>1354</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1355"></a>1355</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1356"></a>1356</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;ElementaryAbelianSeries,&nbsp;"perm&nbsp;group",&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1357"></a>1357</td><td></td><td></td><td></td><td><span><tt>&nbsp;[&nbsp;IsPermGroup&nbsp;and&nbsp;IsFinite],&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1358"></a>1358</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;we&nbsp;want&nbsp;this&nbsp;to&nbsp;come&nbsp;*before*&nbsp;the&nbsp;method&nbsp;for&nbsp;Pcgs&nbsp;computable&nbsp;groups
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1359"></a>1359</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;RankFilter(IsPermGroup&nbsp;and&nbsp;CanEasilyComputePcgs&nbsp;and&nbsp;IsFinite)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1360"></a>1360</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;-RankFilter(IsPermGroup&nbsp;and&nbsp;IsFinite),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1361"></a>1361</td><td></td><td></td><td></td><td><span><tt>function(G)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1362"></a>1362</td><td></td><td></td><td></td><td><span><tt>local&nbsp;pcgs;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1363"></a>1363</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;pcgs:=PcgsElementaryAbelianSeries(G);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1364"></a>1364</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;IsPcgs(pcgs)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1365"></a>1365</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1366"></a>1366</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1367"></a>1367</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;EANormalSeriesByPcgs(pcgs);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1368"></a>1368</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1369"></a>1369</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1370"></a>1370</td><td></td><td></td><td></td><td><span><tt>#InstallOtherMethod(&nbsp;ElementaryAbelianSeries,&nbsp;fam&nbsp;->&nbsp;IsIdenticalObj
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1371"></a>1371</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;fam,&nbsp;CollectionsFamily(&nbsp;CollectionsFamily(&nbsp;PermutationsFamily&nbsp;)&nbsp;)&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1372"></a>1372</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1373"></a>1373</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1374"></a>1374</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;pcgs;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1375"></a>1375</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1376"></a>1376</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;&nbsp;IsEmpty(&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1377"></a>1377</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;not&nbsp;DefaultStabChainOptions.tryPcgs
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1378"></a>1378</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HasIsSolvableGroup(&nbsp;list[&nbsp;1&nbsp;]&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1379"></a>1379</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;not&nbsp;IsSolvableGroup(&nbsp;list[&nbsp;1&nbsp;]&nbsp;)&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1380"></a>1380</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1381"></a>1381</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1382"></a>1382</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1383"></a>1383</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&nbsp;&nbsp;pcgs&nbsp;:=&nbsp;TryPcgsPermGroup(&nbsp;list,&nbsp;false,&nbsp;false,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1384"></a>1384</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsPcgs(&nbsp;pcgs&nbsp;)&nbsp;&nbsp;then&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1385"></a>1385</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;return&nbsp;ElementaryAbelianSeries(&nbsp;pcgs&nbsp;);&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1386"></a>1386</td><td></td><td></td><td></td><td><span><tt>#end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1387"></a>1387</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1388"></a>1388</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1389"></a>1389</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1390"></a>1390</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;PCentralSeries(&nbsp;&lt;G>,&nbsp;&lt;p>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;p-central&nbsp;series
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1391"></a>1391</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1392"></a>1392</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;PCentralSeriesOp,"for&nbsp;permgrp",&nbsp;true,&nbsp;[&nbsp;IsPermGroup,&nbsp;IsPosInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1393"></a>1393</td><td></td><td></td><td></td><td><span><tt>function(&nbsp;G,&nbsp;p&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1394"></a>1394</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;pcgs;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1395"></a>1395</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1396"></a>1396</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(Factors(Size(G)))>1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1397"></a>1397</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1398"></a>1398</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1399"></a>1399</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;pcgs:=PcgsPCentralSeriesPGroup(G);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1400"></a>1400</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;IsPcgs(pcgs)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1401"></a>1401</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1402"></a>1402</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1403"></a>1403</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;PCentralNormalSeriesByPcgsPGroup(pcgs);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1404"></a>1404</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1405"></a>1405</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1406"></a>1406</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1407"></a>1407</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1408"></a>1408</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;SylowSubgroup(&nbsp;&lt;G>,&nbsp;&lt;p>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;Sylow&nbsp;$p$-subgroup
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1409"></a>1409</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1410"></a>1410</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;SylowSubgroupOp,"permutation&nbsp;groups",&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1411"></a>1411</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[&nbsp;IsPermGroup,&nbsp;IsPosInt&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1412"></a>1412</td><td></td><td></td><td></td><td><span><tt>function(&nbsp;G,&nbsp;p&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1413"></a>1413</td><td></td><td></td><td></td><td><span><tt>local&nbsp;&nbsp;&nbsp;S;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1414"></a>1414</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;HasIsSolvableGroup(G)&nbsp;and&nbsp;IsSolvableGroup(G)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1415"></a>1415</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;enforce&nbsp;solvable&nbsp;methods&nbsp;if&nbsp;we&nbsp;detected&nbsp;anew&nbsp;that&nbsp;the&nbsp;group&nbsp;is
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1416"></a>1416</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;solvable.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1417"></a>1417</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;SylowSubgroupOp(G,p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1418"></a>1418</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1419"></a>1419</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;S&nbsp;:=&nbsp;SylowSubgroupPermGroup(&nbsp;G,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1420"></a>1420</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;S&nbsp;:=&nbsp;GroupStabChain(&nbsp;G,&nbsp;StabChainMutable(&nbsp;S&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1421"></a>1421</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;SetIsNilpotentGroup(&nbsp;S,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1422"></a>1422</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Size(S)&nbsp;>&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1423"></a>1423</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetIsPGroup(&nbsp;S,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1424"></a>1424</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetPrimePGroup(&nbsp;S,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1425"></a>1425</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1426"></a>1426</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;S;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1427"></a>1427</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1428"></a>1428</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1429"></a>1429</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;SylowSubgroupPermGroup,&nbsp;function(&nbsp;G,&nbsp;p&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1430"></a>1430</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;S,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&lt;p>-Sylow&nbsp;subgroup&nbsp;of&nbsp;&lt;G>,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1431"></a>1431</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;largest&nbsp;power&nbsp;of&nbsp;&lt;p>&nbsp;dividing&nbsp;the&nbsp;size&nbsp;of&nbsp;&lt;G>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1432"></a>1432</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;domain&nbsp;of&nbsp;operation&nbsp;of&nbsp;&lt;G>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1433"></a>1433</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;O,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;orbit&nbsp;of&nbsp;&lt;G>&nbsp;in&nbsp;this&nbsp;domain
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1434"></a>1434</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;blocks&nbsp;of&nbsp;the&nbsp;operation&nbsp;of&nbsp;&lt;G>&nbsp;on&nbsp;&lt;D>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1435"></a>1435</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;action&nbsp;homomorphism&nbsp;of&nbsp;&lt;G>&nbsp;on&nbsp;&lt;O>&nbsp;or&nbsp;&lt;B>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1436"></a>1436</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&lt;p>-Sylow&nbsp;subgroup&nbsp;in&nbsp;the&nbsp;image&nbsp;of&nbsp;&lt;f>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1437"></a>1437</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g,&nbsp;g2,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;&lt;p>&nbsp;element&nbsp;of&nbsp;&lt;G>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1438"></a>1438</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C,&nbsp;C2;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;centralizer&nbsp;of&nbsp;&lt;g>&nbsp;in&nbsp;&lt;G>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1439"></a>1439</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1440"></a>1440</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;get&nbsp;the&nbsp;size&nbsp;of&nbsp;the&nbsp;&lt;p>-Sylow&nbsp;subgroup
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1441"></a>1441</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;q&nbsp;:=&nbsp;1;&nbsp;&nbsp;while&nbsp;Size(&nbsp;G&nbsp;)&nbsp;mod&nbsp;(q&nbsp;*&nbsp;p)&nbsp;=&nbsp;0&nbsp;&nbsp;do&nbsp;q&nbsp;:=&nbsp;q&nbsp;*&nbsp;p;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1442"></a>1442</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1443"></a>1443</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;handle&nbsp;trivial&nbsp;subgroup
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1444"></a>1444</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;q&nbsp;=&nbsp;1&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1445"></a>1445</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;TrivialSubgroup(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1446"></a>1446</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1447"></a>1447</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;go&nbsp;down&nbsp;in&nbsp;stabilizers&nbsp;as&nbsp;long&nbsp;as&nbsp;possible
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1448"></a>1448</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;:=&nbsp;StabChainMutable(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1449"></a>1449</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;Length(&nbsp;S.orbit&nbsp;)&nbsp;mod&nbsp;p&nbsp;&lt;>&nbsp;0&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1450"></a>1450</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;:=&nbsp;S.stabilizer;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1451"></a>1451</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1452"></a>1452</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;:=&nbsp;GroupStabChain(&nbsp;G,&nbsp;S,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1453"></a>1453</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1454"></a>1454</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;handle&nbsp;full&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1455"></a>1455</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;q&nbsp;=&nbsp;Size(&nbsp;G&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1456"></a>1456</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1457"></a>1457</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1458"></a>1458</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1459"></a>1459</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;handle&nbsp;&lt;p>-Sylow&nbsp;subgroups&nbsp;of&nbsp;size&nbsp;&lt;p>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1460"></a>1460</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;q&nbsp;=&nbsp;p&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1461"></a>1461</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat&nbsp;g&nbsp;:=&nbsp;Random(&nbsp;G&nbsp;);&nbsp;&nbsp;until&nbsp;Order(&nbsp;g&nbsp;)&nbsp;mod&nbsp;p&nbsp;=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1462"></a>1462</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g&nbsp;:=&nbsp;g&nbsp;^&nbsp;(Order(&nbsp;g&nbsp;)&nbsp;/&nbsp;p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1463"></a>1463</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;SubgroupNC(&nbsp;G,&nbsp;[&nbsp;g&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1464"></a>1464</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1465"></a>1465</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1466"></a>1466</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;the&nbsp;group&nbsp;is&nbsp;not&nbsp;transitive&nbsp;work&nbsp;with&nbsp;the&nbsp;transitive&nbsp;constituents
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1467"></a>1467</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;:=&nbsp;MovedPoints(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1468"></a>1468</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsTransitive(&nbsp;G,&nbsp;D&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1469"></a>1469</td><td></td><td></td><td></td><td><span><tt>	Info(InfoGroup,1,"PermSylow:&nbsp;transitive");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1470"></a>1470</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;:=&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1471"></a>1471</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;:=&nbsp;ShallowCopy(&nbsp;D&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1472"></a>1472</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;q&nbsp;&lt;&nbsp;Size(&nbsp;S&nbsp;)&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1473"></a>1473</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;O&nbsp;:=&nbsp;Orbit(&nbsp;S,&nbsp;D[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1474"></a>1474</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;:=&nbsp;ActionHomomorphism(&nbsp;S,&nbsp;O,"surjective"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1475"></a>1475</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;:=&nbsp;SylowSubgroupPermGroup(&nbsp;Range(&nbsp;f&nbsp;),&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1476"></a>1476</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;:=&nbsp;PreImagesSet(&nbsp;f,&nbsp;T&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1477"></a>1477</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SubtractSet(&nbsp;D,&nbsp;O&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1478"></a>1478</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1479"></a>1479</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;S;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1480"></a>1480</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1481"></a>1481</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1482"></a>1482</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;the&nbsp;group&nbsp;is&nbsp;not&nbsp;primitive&nbsp;work&nbsp;in&nbsp;the&nbsp;image&nbsp;first
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1483"></a>1483</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;:=&nbsp;Blocks(&nbsp;G,&nbsp;D&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1484"></a>1484</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;B&nbsp;)&nbsp;&lt;>&nbsp;1&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1485"></a>1485</td><td></td><td></td><td></td><td><span><tt>	Info(InfoGroup,1,"PermSylow:&nbsp;blocks");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1486"></a>1486</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;:=&nbsp;ActionHomomorphism(&nbsp;G,&nbsp;B,&nbsp;OnSets,"surjective"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1487"></a>1487</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;:=&nbsp;SylowSubgroupPermGroup(&nbsp;Range(&nbsp;f&nbsp;),&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1488"></a>1488</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Size(&nbsp;T&nbsp;)&nbsp;&lt;&nbsp;Size(&nbsp;Range(&nbsp;f&nbsp;)&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1489"></a>1489</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;:=&nbsp;PreImagesSet(&nbsp;f,&nbsp;T&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1490"></a>1490</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;:=&nbsp;SylowSubgroupPermGroup(&nbsp;T&nbsp;,&nbsp;p)&nbsp;;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1491"></a>1491</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;S;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1492"></a>1492</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1493"></a>1493</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1494"></a>1494</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1495"></a>1495</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;find&nbsp;a&nbsp;&lt;p>&nbsp;element&nbsp;whose&nbsp;centralizer&nbsp;contains&nbsp;a&nbsp;full&nbsp;&lt;p>-Sylow&nbsp;subgroup
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1496"></a>1496</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Info(InfoGroup,1,"PermSylow:&nbsp;element");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1497"></a>1497</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;repeat&nbsp;g&nbsp;:=&nbsp;Random(&nbsp;G&nbsp;);&nbsp;&nbsp;until&nbsp;Order(&nbsp;g&nbsp;)&nbsp;mod&nbsp;p&nbsp;=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1498"></a>1498</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;g&nbsp;:=&nbsp;g&nbsp;^&nbsp;(Order(&nbsp;g&nbsp;)&nbsp;/&nbsp;p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1499"></a>1499</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;:=&nbsp;Centralizer(&nbsp;G,&nbsp;g&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1500"></a>1500</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;GcdInt(&nbsp;q,&nbsp;Size(&nbsp;C&nbsp;)&nbsp;)&nbsp;&lt;&nbsp;q&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1501"></a>1501</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat&nbsp;g2&nbsp;:=&nbsp;Random(&nbsp;C&nbsp;);&nbsp;&nbsp;until&nbsp;Order(&nbsp;g2&nbsp;)&nbsp;mod&nbsp;p&nbsp;=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1502"></a>1502</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g2&nbsp;:=&nbsp;g2&nbsp;^&nbsp;(Order(&nbsp;g2&nbsp;)&nbsp;/&nbsp;p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1503"></a>1503</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C2&nbsp;:=&nbsp;Centralizer(&nbsp;G,&nbsp;g2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1504"></a>1504</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;GcdInt(&nbsp;q,&nbsp;Size(&nbsp;C&nbsp;)&nbsp;)&nbsp;&lt;&nbsp;GcdInt(&nbsp;q,&nbsp;Size(&nbsp;C2&nbsp;)&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1505"></a>1505</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;:=&nbsp;C2;&nbsp;&nbsp;g&nbsp;:=&nbsp;g2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1506"></a>1506</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1507"></a>1507</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1508"></a>1508</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1509"></a>1509</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;centralizer&nbsp;acts&nbsp;on&nbsp;the&nbsp;cycles&nbsp;of&nbsp;the&nbsp;&lt;p>&nbsp;element
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1510"></a>1510</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;:=&nbsp;List(&nbsp;Cycles(&nbsp;g,&nbsp;D&nbsp;),&nbsp;Set&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1511"></a>1511</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Info(InfoGroup,1,"PermSylow:&nbsp;cycleaction");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1512"></a>1512</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;:=&nbsp;ActionHomomorphism(&nbsp;C,&nbsp;B,&nbsp;OnSets,"surjective"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1513"></a>1513</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;:=&nbsp;SylowSubgroupPermGroup(&nbsp;Range(&nbsp;f&nbsp;),&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1514"></a>1514</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;S&nbsp;:=&nbsp;PreImagesSet(&nbsp;f,&nbsp;T&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1515"></a>1515</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;S;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1516"></a>1516</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1517"></a>1517</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1518"></a>1518</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1519"></a>1519</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1520"></a>1520</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1521"></a>1521</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Socle(&nbsp;&lt;G>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;socle&nbsp;of&nbsp;primitive&nbsp;permutation&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1522"></a>1522</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1523"></a>1523</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Socle,"for&nbsp;permgrp",&nbsp;true,&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1524"></a>1524</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1525"></a>1525</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;Omega,&nbsp;&nbsp;deg,&nbsp;&nbsp;shortcut,&nbsp;&nbsp;coll,&nbsp;&nbsp;d,&nbsp;&nbsp;m,&nbsp;&nbsp;c,&nbsp;&nbsp;ds,&nbsp;&nbsp;L,&nbsp;&nbsp;z,&nbsp;&nbsp;ord,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1526"></a>1526</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p,&nbsp;&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1527"></a>1527</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1528"></a>1528</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Omega&nbsp;:=&nbsp;MovedPoints(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1529"></a>1529</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1530"></a>1530</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsPrimitive(&nbsp;G,&nbsp;Omega&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1531"></a>1531</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1532"></a>1532</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1533"></a>1533</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1534"></a>1534</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Affine&nbsp;groups&nbsp;first.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1535"></a>1535</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;L&nbsp;:=&nbsp;Earns(&nbsp;G,&nbsp;Omega&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1536"></a>1536</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;L&nbsp;&lt;>&nbsp;fail&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1537"></a>1537</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;L;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1538"></a>1538</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1539"></a>1539</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1540"></a>1540</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;deg&nbsp;:=&nbsp;Length(&nbsp;Omega&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1541"></a>1541</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;deg&nbsp;>=&nbsp;6103515625&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1542"></a>1542</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1543"></a>1543</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;deg&nbsp;&lt;&nbsp;12960000&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1544"></a>1544</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shortcut&nbsp;:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1545"></a>1545</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;deg&nbsp;>=&nbsp;3125&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1546"></a>1546</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coll&nbsp;:=&nbsp;Collected(&nbsp;FactorsInt(&nbsp;deg&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1547"></a>1547</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;:=&nbsp;Gcd(&nbsp;List(&nbsp;coll,&nbsp;c&nbsp;->&nbsp;c[&nbsp;2&nbsp;]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1548"></a>1548</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;d&nbsp;mod&nbsp;5&nbsp;=&nbsp;0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1549"></a>1549</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1550"></a>1550</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;c&nbsp;&nbsp;in&nbsp;coll&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1551"></a>1551</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;:=&nbsp;m&nbsp;*&nbsp;c[&nbsp;1&nbsp;]&nbsp;^&nbsp;(&nbsp;c[&nbsp;2&nbsp;]&nbsp;/&nbsp;d&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1552"></a>1552</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1553"></a>1553</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;>=&nbsp;5&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1554"></a>1554</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shortcut&nbsp;:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1555"></a>1555</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1556"></a>1556</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1557"></a>1557</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1558"></a>1558</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;shortcut&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1559"></a>1559</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds&nbsp;:=&nbsp;DerivedSeriesOfGroup(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1560"></a>1560</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ds[&nbsp;Length(&nbsp;ds&nbsp;)&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1561"></a>1561</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1562"></a>1562</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1563"></a>1563</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1564"></a>1564</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;coll&nbsp;:=&nbsp;Collected(&nbsp;FactorsInt(&nbsp;Size(&nbsp;G&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1565"></a>1565</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;deg&nbsp;&lt;&nbsp;78125&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1566"></a>1566</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;:=&nbsp;coll[&nbsp;Length(&nbsp;coll&nbsp;)&nbsp;][&nbsp;1&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1567"></a>1567</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1568"></a>1568</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;Length(&nbsp;coll&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1569"></a>1569</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;coll[&nbsp;i&nbsp;][&nbsp;2&nbsp;]&nbsp;=&nbsp;1&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1570"></a>1570</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;i&nbsp;-&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1571"></a>1571</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1572"></a>1572</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;:=&nbsp;coll[&nbsp;i&nbsp;][&nbsp;1&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1573"></a>1573</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1574"></a>1574</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1575"></a>1575</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1576"></a>1576</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;Random(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1577"></a>1577</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ord&nbsp;:=&nbsp;Order(&nbsp;z&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1578"></a>1578</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;ord&nbsp;mod&nbsp;p&nbsp;=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1579"></a>1579</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;:=&nbsp;z&nbsp;^&nbsp;(&nbsp;ord&nbsp;/&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1580"></a>1580</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;Index(&nbsp;G,&nbsp;Centralizer(&nbsp;G,&nbsp;z&nbsp;)&nbsp;)&nbsp;mod&nbsp;p&nbsp;&lt;>&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1581"></a>1581</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;L&nbsp;:=&nbsp;NormalClosure(&nbsp;G,&nbsp;SubgroupNC(&nbsp;G,&nbsp;[&nbsp;z&nbsp;]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1582"></a>1582</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;deg&nbsp;>=&nbsp;78125&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1583"></a>1583</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ds&nbsp;:=&nbsp;DerivedSeriesOfGroup(&nbsp;L&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1584"></a>1584</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L&nbsp;:=&nbsp;ds[&nbsp;Length(&nbsp;ds&nbsp;)&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1585"></a>1585</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1586"></a>1586</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsSemiRegular(&nbsp;L,&nbsp;Omega&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1587"></a>1587</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L&nbsp;:=&nbsp;ClosureSubgroup(&nbsp;L,&nbsp;Centralizer(&nbsp;G,&nbsp;L&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1588"></a>1588</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1589"></a>1589</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;L;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1590"></a>1590</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1591"></a>1591</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1592"></a>1592</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1593"></a>1593</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1594"></a>1594</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;FrattiniSubgroup(&nbsp;&lt;G>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;permutation&nbsp;p-groups
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1595"></a>1595</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1596"></a>1596</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;FrattiniSubgroup,"for&nbsp;permgrp",&nbsp;true,&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1597"></a>1597</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1598"></a>1598</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;fac,&nbsp;&nbsp;p,&nbsp;&nbsp;l,&nbsp;&nbsp;k,&nbsp;&nbsp;i,&nbsp;&nbsp;j;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1599"></a>1599</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1600"></a>1600</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fac&nbsp;:=&nbsp;Set(&nbsp;FactorsInt(&nbsp;Size(&nbsp;G&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1601"></a>1601</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;fac&nbsp;)&nbsp;>&nbsp;1&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1602"></a>1602</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1603"></a>1603</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;fac[1]=1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1604"></a>1604</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1605"></a>1605</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1606"></a>1606</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;:=&nbsp;fac[&nbsp;1&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1607"></a>1607</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;:=&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1608"></a>1608</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;:=&nbsp;[&nbsp;l[1]^p&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1609"></a>1609</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[&nbsp;2&nbsp;..&nbsp;Length(l)&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1610"></a>1610</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;i-1&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1611"></a>1611</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(k,&nbsp;Comm(l[i],&nbsp;l[j]));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1612"></a>1612</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1613"></a>1613</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(k,&nbsp;l[i]^p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1614"></a>1614</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1615"></a>1615</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;SolvableNormalClosurePermGroup(&nbsp;G,&nbsp;k&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1616"></a>1616</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1617"></a>1617</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1618"></a>1618</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1619"></a>1619</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1620"></a>1620</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ApproximateSuborbitsStabilizerPermGroup(&lt;G>,&lt;pnt>)&nbsp;.&nbsp;.&nbsp;.&nbsp;approximation&nbsp;of
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1621"></a>1621</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;the&nbsp;orbits&nbsp;of&nbsp;Stab_G(pnt)&nbsp;on&nbsp;all&nbsp;points&nbsp;of&nbsp;the&nbsp;orbit&nbsp;pnt^G.&nbsp;(As&nbsp;not
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1622"></a>1622</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;all&nbsp;schreier&nbsp;generators&nbsp;are&nbsp;used,&nbsp;the&nbsp;results&nbsp;may&nbsp;be&nbsp;the&nbsp;orbits&nbsp;of&nbsp;a
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1623"></a>1623</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;subgroup.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1624"></a>1624</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1625"></a>1625</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;ApproximateSuborbitsStabilizerPermGroup,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1626"></a>1626</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(G,punkt)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1627"></a>1627</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;one,&nbsp;orbit,&nbsp;trans,&nbsp;stab,&nbsp;gen,&nbsp;pnt,&nbsp;img,&nbsp;norb,&nbsp;no,&nbsp;i,&nbsp;j,&nbsp;changed,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1628"></a>1628</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;processStabGen,&nbsp;currPt,currGen,&nbsp;stgp,&nbsp;orblen,&nbsp;gens,Ggens;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1629"></a>1629</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1630"></a>1630</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;one:=&nbsp;One(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1631"></a>1631</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;HasStabChainMutable(&nbsp;G&nbsp;)&nbsp;and&nbsp;punkt&nbsp;in&nbsp;StabChainMutable(G).orbit&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1632"></a>1632</td><td></td><td></td><td></td><td><span><tt>#&nbsp;if&nbsp;we&nbsp;already&nbsp;have&nbsp;a&nbsp;stab&nbsp;chain&nbsp;and&nbsp;bother&nbsp;computing&nbsp;the&nbsp;proper
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1633"></a>1633</td><td></td><td></td><td></td><td><span><tt>#&nbsp;stabilizer,&nbsp;a&nbsp;trivial&nbsp;orbit&nbsp;algorithm&nbsp;seems&nbsp;best.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1634"></a>1634</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Concatenation([[punkt]],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1635"></a>1635</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrbitsDomain(Stabilizer(G,punkt),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1636"></a>1636</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Difference(MovedPoints(G),[punkt])));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1637"></a>1637</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;orbit:=Difference(StabChainMutable(G).orbit,[punkt]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1638"></a>1638</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;stab:=Stabilizer(G,punkt));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1639"></a>1639</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;catch&nbsp;trivial&nbsp;case
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1640"></a>1640</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(stab)=0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1641"></a>1641</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stab:=[&nbsp;one&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1642"></a>1642</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1643"></a>1643</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;stgp:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1644"></a>1644</td><td></td><td></td><td></td><td><span><tt>#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1645"></a>1645</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;processStabGen:=function()
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1646"></a>1646</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stgp:=stgp+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1647"></a>1647</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;stgp>Length(stab)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1648"></a>1648</td><td></td><td></td><td></td><td><span><tt>#	StabGenAvailable:=false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1649"></a>1649</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1650"></a>1650</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;stab[stgp-1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1651"></a>1651</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1652"></a>1652</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1653"></a>1653</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1654"></a>1654</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;compute&nbsp;orbit&nbsp;and&nbsp;transversal
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1655"></a>1655</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Ggens:=GeneratorsOfGroup(G);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1656"></a>1656</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;orbit&nbsp;:=&nbsp;[&nbsp;punkt&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1657"></a>1657</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;trans&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1658"></a>1658</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;trans[&nbsp;punkt&nbsp;]&nbsp;:=&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1659"></a>1659</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;stab:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1660"></a>1660</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pnt&nbsp;&nbsp;in&nbsp;orbit&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1661"></a>1661</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gen&nbsp;&nbsp;in&nbsp;Ggens&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1662"></a>1662</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img:=pnt^gen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1663"></a>1663</td><td></td><td></td><td></td><td><span><tt>	if&nbsp;not&nbsp;IsBound(&nbsp;trans[&nbsp;img&nbsp;]&nbsp;)&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1664"></a>1664</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;Add(&nbsp;orbit,&nbsp;img&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1665"></a>1665</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;trans[img&nbsp;]&nbsp;:=&nbsp;gen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1666"></a>1666</td><td></td><td></td><td></td><td><span><tt>	fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1667"></a>1667</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1668"></a>1668</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1669"></a>1669</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;orblen:=Length(orbit);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1670"></a>1670</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1671"></a>1671</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1672"></a>1672</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1673"></a>1673</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;currPt:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1674"></a>1674</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;currGen:=0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1675"></a>1675</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1676"></a>1676</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;processStabGen:=function()
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1677"></a>1677</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;punkt,img,a,b,gen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1678"></a>1678</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Random([1,2])=1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1679"></a>1679</td><td></td><td></td><td></td><td><span><tt>	#&nbsp;next&nbsp;one
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1680"></a>1680</td><td></td><td></td><td></td><td><span><tt>	currGen:=currGen+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1681"></a>1681</td><td></td><td></td><td></td><td><span><tt>	if&nbsp;currGen>Length(Ggens)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1682"></a>1682</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;currGen:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1683"></a>1683</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;currPt:=currPt+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1684"></a>1684</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;if&nbsp;currPt>Length(orbit)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1685"></a>1685</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1686"></a>1686</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1687"></a>1687</td><td></td><td></td><td></td><td><span><tt>	fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1688"></a>1688</td><td></td><td></td><td></td><td><span><tt>	a:=currPt;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1689"></a>1689</td><td></td><td></td><td></td><td><span><tt>	b:=currGen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1690"></a>1690</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1691"></a>1691</td><td></td><td></td><td></td><td><span><tt>	a:=Random([1..Length(orbit)]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1692"></a>1692</td><td></td><td></td><td></td><td><span><tt>	b:=Random([1..Length(Ggens)]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1693"></a>1693</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1694"></a>1694</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;map&nbsp;a&nbsp;with&nbsp;b
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1695"></a>1695</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img:=orbit[a]^Ggens[b];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1696"></a>1696</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;img=orbit[a]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1697"></a>1697</td><td></td><td></td><td></td><td><span><tt>	return&nbsp;();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1698"></a>1698</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1699"></a>1699</td><td></td><td></td><td></td><td><span><tt>	punkt:=orbit[a];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1700"></a>1700</td><td></td><td></td><td></td><td><span><tt>	gen:=Ggens[b];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1701"></a>1701</td><td></td><td></td><td></td><td><span><tt>	while&nbsp;punkt&lt;>orbit[1]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1702"></a>1702</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;gen:=trans[punkt]*gen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1703"></a>1703</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;punkt:=punkt/trans[punkt];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1704"></a>1704</td><td></td><td></td><td></td><td><span><tt>	od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1705"></a>1705</td><td></td><td></td><td></td><td><span><tt>	if&nbsp;orbit[1]^gen&lt;>img&nbsp;then&nbsp;Error("EHEH");&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1706"></a>1706</td><td></td><td></td><td></td><td><span><tt>	punkt:=img;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1707"></a>1707</td><td></td><td></td><td></td><td><span><tt>	while&nbsp;punkt&lt;>orbit[1]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1708"></a>1708</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;gen:=gen/trans[punkt];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1709"></a>1709</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;punkt:=punkt/trans[punkt];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1710"></a>1710</td><td></td><td></td><td></td><td><span><tt>	od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1711"></a>1711</td><td></td><td></td><td></td><td><span><tt>	if&nbsp;orbit[1]^gen&lt;>orbit[1]&nbsp;then&nbsp;Error("UHEH");&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1712"></a>1712</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1713"></a>1713</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;gen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1714"></a>1714</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1715"></a>1715</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1716"></a>1716</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;as&nbsp;the&nbsp;first&nbsp;approximation&nbsp;take&nbsp;a&nbsp;subgroup&nbsp;generated&nbsp;by&nbsp;four&nbsp;nontrivial
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1717"></a>1717</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;Schreier&nbsp;generators
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1718"></a>1718</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;changed:=0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1719"></a>1719</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;gens:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1720"></a>1720</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;while&nbsp;changed&lt;=3&nbsp;and&nbsp;currPt&lt;=Length(orbit)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1721"></a>1721</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;gen:=();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1722"></a>1722</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;IsOne(gen)&nbsp;and&nbsp;currPt&lt;=Length(orbit)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1723"></a>1723</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen:=processStabGen();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1724"></a>1724</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1725"></a>1725</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Add(gens,gen);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1726"></a>1726</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;changed:=changed+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1727"></a>1727</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1728"></a>1728</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(gens)=0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1729"></a>1729</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;orbit:=List(orbit,i->[i]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1730"></a>1730</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1731"></a>1731</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;orbit:=OrbitsPerms(gens,orbit);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1732"></a>1732</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1733"></a>1733</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1734"></a>1734</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;todo:&nbsp;further&nbsp;fuse
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1735"></a>1735</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;orbit;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1736"></a>1736</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1737"></a>1737</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1738"></a>1738</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1739"></a>1739</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1740"></a>1740</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;AllBlocks&nbsp;.&nbsp;.&nbsp;.&nbsp;Representatives&nbsp;of&nbsp;all&nbsp;block&nbsp;systems
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1741"></a>1741</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1742"></a>1742</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;AllBlocks,&nbsp;"generic",&nbsp;[&nbsp;IsPermGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1743"></a>1743</td><td></td><td></td><td></td><td><span><tt>function(g)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1744"></a>1744</td><td></td><td></td><td></td><td><span><tt>local&nbsp;gens,&nbsp;one,&nbsp;dom,DoBlocks,pool,subo;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1745"></a>1745</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1746"></a>1746</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;DoBlocks:=function(b)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1747"></a>1747</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;bl,bld,i,t,n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1748"></a>1748</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;find&nbsp;representatives&nbsp;of&nbsp;all&nbsp;potential&nbsp;suborbits
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1749"></a>1749</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;bld:=List(Filtered(subo,i->not&nbsp;ForAny(b,j->j&nbsp;in&nbsp;i)),i->i[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1750"></a>1750</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;bl:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1751"></a>1751</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsPrime(Length(dom)/Length(b))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1752"></a>1752</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;bld&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1753"></a>1753</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t:=Union(b,[i]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1754"></a>1754</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n:=Blocks(g,dom,t);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1755"></a>1755</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(n)>1&nbsp;and&nbsp;#ok&nbsp;durch&nbsp;pool:ForAll(Difference(n[1],t),j->j>i)&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1756"></a>1756</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;n[1]&nbsp;in&nbsp;pool&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1757"></a>1757</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t:=n[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1758"></a>1758</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(pool,t);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1759"></a>1759</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bl:=Concatenation(bl,[t],DoBlocks(t));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1760"></a>1760</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1761"></a>1761</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1762"></a>1762</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1763"></a>1763</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;bl;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1764"></a>1764</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1765"></a>1765</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1766"></a>1766</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;one:=&nbsp;One(&nbsp;g&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1767"></a>1767</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;gens:=&nbsp;Filtered(&nbsp;GeneratorsOfGroup(g),&nbsp;i&nbsp;->&nbsp;i&nbsp;&lt;>&nbsp;one&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1768"></a>1768</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(gens)=0&nbsp;then&nbsp;return&nbsp;[];&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1769"></a>1769</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;subo:=ApproximateSuborbitsStabilizerPermGroup(g,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1770"></a>1770</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Minimum(List(gens,SmallestMovedPoint)));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1771"></a>1771</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;dom:=Union(subo);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1772"></a>1772</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;IsTransitive(g,dom)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1773"></a>1773</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Error("AllBlocks,&nbsp;must&nbsp;be&nbsp;transitive");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1774"></a>1774</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1775"></a>1775</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;pool:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1776"></a>1776</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;DoBlocks(subo[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1777"></a>1777</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1778"></a>1778</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1779"></a>1779</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1780"></a>1780</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1781"></a>1781</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;SignPermGroup
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1782"></a>1782</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1783"></a>1783</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;SignPermGroup,&nbsp;function(g)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1784"></a>1784</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;ForAll(GeneratorsOfGroup(g),i->SignPerm(i)=1)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1785"></a>1785</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1786"></a>1786</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1787"></a>1787</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;-1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1788"></a>1788</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1789"></a>1789</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1790"></a>1790</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1791"></a>1791</td><td></td><td></td><td></td><td><span><tt>CreateAllCycleStructures&nbsp;:=&nbsp;function(n)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1792"></a>1792</td><td></td><td></td><td></td><td><span><tt>local&nbsp;i,j,l,m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1793"></a>1793</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;l:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1794"></a>1794</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;Partitions(n)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1795"></a>1795</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1796"></a>1796</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;i&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1797"></a>1797</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;j>1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1798"></a>1798</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(m[j-1])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1799"></a>1799</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m[j-1]:=m[j-1]+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1800"></a>1800</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1801"></a>1801</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m[j-1]:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1802"></a>1802</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1803"></a>1803</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1804"></a>1804</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1805"></a>1805</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Add(l,m);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1806"></a>1806</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1807"></a>1807</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;l;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1808"></a>1808</td><td></td><td></td><td></td><td><span><tt>end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1809"></a>1809</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1810"></a>1810</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1811"></a>1811</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1812"></a>1812</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;CycleStructuresGroup(G)&nbsp;&nbsp;list&nbsp;of&nbsp;all&nbsp;cyclestructures&nbsp;occ.&nbsp;in&nbsp;a&nbsp;perm&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1813"></a>1813</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1814"></a>1814</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;CycleStructuresGroup,&nbsp;function(g)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1815"></a>1815</td><td></td><td></td><td></td><td><span><tt>local&nbsp;l,m,i,&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1816"></a>1816</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;l:=CreateAllCycleStructures(Length(MovedPoints(g)));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1817"></a>1817</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;m:=List([1..Length(l)-1],i->0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1818"></a>1818</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;one:=&nbsp;One(&nbsp;g&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1819"></a>1819</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;ConjugacyClasses(g)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1820"></a>1820</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Representative(i)&nbsp;&lt;>&nbsp;one&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1821"></a>1821</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m[Position(l,CycleStructurePerm(Representative(i)))-1]:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1822"></a>1822</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1823"></a>1823</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1824"></a>1824</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;m;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1825"></a>1825</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1826"></a>1826</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1827"></a>1827</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1828"></a>1828</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1829"></a>1829</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;SmallGeneratingSet(&lt;G>)&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1830"></a>1830</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1831"></a>1831</td><td></td><td></td><td></td><td><span><tt>InstallMethod(SmallGeneratingSet,"random&nbsp;and&nbsp;generators&nbsp;subset,&nbsp;randsims",true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1832"></a>1832</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[IsPermGroup],0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1833"></a>1833</td><td></td><td></td><td></td><td><span><tt>function&nbsp;(G)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1834"></a>1834</td><td></td><td></td><td></td><td><span><tt>local&nbsp;&nbsp;i,&nbsp;j,&nbsp;U,&nbsp;gens,o,v,a,sel;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1835"></a>1835</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1836"></a>1836</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;remove&nbsp;obvious&nbsp;redundancies
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1837"></a>1837</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;gens&nbsp;:=&nbsp;ShallowCopy(Set(GeneratorsOfGroup(G)));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1838"></a>1838</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;o:=List(gens,Order);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1839"></a>1839</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;SortParallel(o,gens,function(a,b)&nbsp;return&nbsp;a>b;end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1840"></a>1840</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;sel:=Filtered([1..Length(gens)],x->o[x]>1);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1841"></a>1841</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[1..Length(gens)]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1842"></a>1842</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i&nbsp;in&nbsp;sel&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1843"></a>1843</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U:=Filtered(sel,x->x>i&nbsp;and&nbsp;IsInt(o[i]/o[x]));&nbsp;#&nbsp;potential&nbsp;powers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1844"></a>1844</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v:=[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1845"></a>1845</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;U&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1846"></a>1846</td><td></td><td></td><td></td><td><span><tt>	a:=SmallestMovedPoint(gens[j]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1847"></a>1847</td><td></td><td></td><td></td><td><span><tt>	if&nbsp;IsSubset(OrbitPerms([gens[i]],a),OrbitPerms([gens[j]],a))&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1848"></a>1848</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;Add(v,j);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1849"></a>1849</td><td></td><td></td><td></td><td><span><tt>	fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1850"></a>1850</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1851"></a>1851</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;v&nbsp;are&nbsp;the&nbsp;possible&nbsp;powers
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1852"></a>1852</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;v&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1853"></a>1853</td><td></td><td></td><td></td><td><span><tt>	a:=gens[i]^(o[i]/o[j]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1854"></a>1854</td><td></td><td></td><td></td><td><span><tt>	if&nbsp;ForAny(Filtered([1..o[j]],z->Gcd(z,o[j])=1),x->a^x=gens[j])&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1855"></a>1855</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;RemoveSet(sel,j);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1856"></a>1856</td><td></td><td></td><td></td><td><span><tt>	fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1857"></a>1857</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1858"></a>1858</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1859"></a>1859</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1860"></a>1860</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;gens:=gens{sel};
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1861"></a>1861</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1862"></a>1862</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;try&nbsp;pc&nbsp;methods&nbsp;first
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1863"></a>1863</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(MovedPoints(G))&lt;1000&nbsp;and&nbsp;HasIsSolvableGroup(G)&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1864"></a>1864</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;IsSolvableGroup(G)&nbsp;and&nbsp;Length(gens)>3&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1865"></a>1865</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;MinimalGeneratingSet(G);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1866"></a>1866</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1867"></a>1867</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1868"></a>1868</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(gens)>2&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1869"></a>1869</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i:=2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1870"></a>1870</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;i&lt;=3&nbsp;and&nbsp;i&lt;Length(gens)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1871"></a>1871</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;try&nbsp;to&nbsp;find&nbsp;a&nbsp;small&nbsp;generating&nbsp;system&nbsp;by&nbsp;random&nbsp;search
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1872"></a>1872</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1873"></a>1873</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;j&lt;=5&nbsp;and&nbsp;i&lt;Length(gens)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1874"></a>1874</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;U:=Subgroup(G,List([1..i],j->Random(G)));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1875"></a>1875</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StabChain(U,rec(random:=1));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1876"></a>1876</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Size(U)=Size(G)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1877"></a>1877</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gens:=Set(GeneratorsOfGroup(U));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1878"></a>1878</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1879"></a>1879</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=j+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1880"></a>1880</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1881"></a>1881</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i:=i+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1882"></a>1882</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1883"></a>1883</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1884"></a>1884</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;i&nbsp;:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1885"></a>1885</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;IsAbelian(G)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1886"></a>1886</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i:=i+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1887"></a>1887</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1888"></a>1888</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;while&nbsp;i&nbsp;&lt;&nbsp;Length(gens)&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1889"></a>1889</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;random&nbsp;did&nbsp;not&nbsp;improve&nbsp;much,&nbsp;try&nbsp;subsets
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1890"></a>1890</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;U:=Subgroup(G,gens{Difference([1..Length(gens)],[i])});
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1891"></a>1891</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Size(U)&lt;Size(G)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1892"></a>1892</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i:=i+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1893"></a>1893</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1894"></a>1894</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gens:=Set(GeneratorsOfGroup(U));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1895"></a>1895</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1896"></a>1896</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1897"></a>1897</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;gens;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1898"></a>1898</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1899"></a>1899</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1900"></a>1900</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1901"></a>1901</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1902"></a>1902</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;GeneratorsSmallest(&lt;G>)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;for&nbsp;permutation&nbsp;groups
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1903"></a>1903</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1904"></a>1904</td><td></td><td></td><td></td><td><span><tt>DeclareGlobalFunction(&nbsp;"GeneratorsSmallestStab"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1905"></a>1905</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1906"></a>1906</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;GeneratorsSmallestStab,&nbsp;function&nbsp;(&nbsp;S&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1907"></a>1907</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;&nbsp;&nbsp;gens,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;smallest&nbsp;generating&nbsp;system&nbsp;of&nbsp;&lt;S>,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1908"></a>1908</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;generator&nbsp;in&nbsp;&lt;gens>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1909"></a>1909</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orb,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;basic&nbsp;orbit&nbsp;of&nbsp;&lt;S>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1910"></a>1910</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pnt,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;point&nbsp;in&nbsp;&lt;orb>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1911"></a>1911</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;stabilizer&nbsp;in&nbsp;&lt;S>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1912"></a>1912</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;o2,img,oo,og;&nbsp;#&nbsp;private&nbsp;orbit&nbsp;algorithm
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1913"></a>1913</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1914"></a>1914</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;handle&nbsp;the&nbsp;anchor&nbsp;case
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1915"></a>1915</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(S.generators)&nbsp;=&nbsp;0&nbsp;&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1916"></a>1916</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1917"></a>1917</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1918"></a>1918</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1919"></a>1919</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;now&nbsp;get&nbsp;the&nbsp;smallest&nbsp;generating&nbsp;system&nbsp;of&nbsp;the&nbsp;stabilizer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1920"></a>1920</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;gens&nbsp;:=&nbsp;GeneratorsSmallestStab(&nbsp;S.stabilizer&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1921"></a>1921</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1922"></a>1922</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;get&nbsp;the&nbsp;sorted&nbsp;orbit&nbsp;(the&nbsp;basepoint&nbsp;will&nbsp;be&nbsp;the&nbsp;first&nbsp;point)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1923"></a>1923</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;orb&nbsp;:=&nbsp;Set(&nbsp;S.orbit&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1924"></a>1924</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SubtractSet(&nbsp;orb,&nbsp;[S.orbit[1]]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1925"></a>1925</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1926"></a>1926</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;handle&nbsp;the&nbsp;other&nbsp;points&nbsp;in&nbsp;the&nbsp;orbit
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1927"></a>1927</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;Length(orb)&nbsp;&lt;>&nbsp;0&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1928"></a>1928</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1929"></a>1929</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;take&nbsp;the&nbsp;smallest&nbsp;point&nbsp;(coset)&nbsp;and&nbsp;one&nbsp;representative
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1930"></a>1930</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pnt&nbsp;:=&nbsp;orb[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1931"></a>1931</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen&nbsp;:=&nbsp;S.identity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1932"></a>1932</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;S.orbit[1]&nbsp;^&nbsp;gen&nbsp;&lt;>&nbsp;pnt&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1933"></a>1933</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen&nbsp;:=&nbsp;LeftQuotient(&nbsp;S.transversal[&nbsp;pnt&nbsp;/&nbsp;gen&nbsp;],&nbsp;gen&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1934"></a>1934</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1935"></a>1935</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1936"></a>1936</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;next&nbsp;generator&nbsp;is&nbsp;the&nbsp;smallest&nbsp;element&nbsp;in&nbsp;this&nbsp;coset
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1937"></a>1937</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;:=&nbsp;S.stabilizer;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1938"></a>1938</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;Length(T.generators)&nbsp;&lt;>&nbsp;0&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1939"></a>1939</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pnt&nbsp;:=&nbsp;Minimum(&nbsp;OnTuples(&nbsp;T.orbit,&nbsp;gen&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1940"></a>1940</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;T.orbit[1]&nbsp;^&nbsp;gen&nbsp;&lt;>&nbsp;pnt&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1941"></a>1941</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen&nbsp;:=&nbsp;LeftQuotient(&nbsp;T.transversal[&nbsp;pnt&nbsp;/&nbsp;gen&nbsp;],&nbsp;gen&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1942"></a>1942</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1943"></a>1943</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T&nbsp;:=&nbsp;T.stabilizer;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1944"></a>1944</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1945"></a>1945</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1946"></a>1946</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;add&nbsp;this&nbsp;generator&nbsp;to&nbsp;the&nbsp;generators&nbsp;list&nbsp;and&nbsp;reduce&nbsp;orbit
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1947"></a>1947</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;gens,&nbsp;gen&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1948"></a>1948</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1949"></a>1949</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#SubtractSet(&nbsp;orb,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1950"></a>1950</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;Orbit(&nbsp;GroupByGenerators(&nbsp;gens,&nbsp;S.identity&nbsp;),&nbsp;S.orbit[1]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1951"></a>1951</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1952"></a>1952</td><td></td><td></td><td></td><td><span><tt>	#&nbsp;here&nbsp;we&nbsp;want&nbsp;to&nbsp;be&nbsp;really&nbsp;fast,&nbsp;so&nbsp;use&nbsp;a&nbsp;private&nbsp;orbit&nbsp;algorithm
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1953"></a>1953</td><td></td><td></td><td></td><td><span><tt>	o2:=[S.orbit[1]];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1954"></a>1954</td><td></td><td></td><td></td><td><span><tt>	RemoveSet(orb,S.orbit[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1955"></a>1955</td><td></td><td></td><td></td><td><span><tt>	for&nbsp;oo&nbsp;in&nbsp;o2&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1956"></a>1956</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;for&nbsp;og&nbsp;in&nbsp;gens&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1957"></a>1957</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;img:=oo^og;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1958"></a>1958</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;img&nbsp;in&nbsp;orb&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1959"></a>1959</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(o2,img);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1960"></a>1960</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RemoveSet(orb,img);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1961"></a>1961</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1962"></a>1962</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1963"></a>1963</td><td></td><td></td><td></td><td><span><tt>	od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1964"></a>1964</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1965"></a>1965</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1966"></a>1966</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1967"></a>1967</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;return&nbsp;the&nbsp;smallest&nbsp;generating&nbsp;system
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1968"></a>1968</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;gens;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1969"></a>1969</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1970"></a>1970</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1971"></a>1971</td><td></td><td></td><td></td><td><span><tt>InstallMethod(GeneratorsSmallest,"perm&nbsp;group&nbsp;via&nbsp;minimal&nbsp;stab&nbsp;chain",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1972"></a>1972</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[IsPermGroup],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1973"></a>1973</td><td></td><td></td><td></td><td><span><tt>function(G)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1974"></a>1974</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;call&nbsp;the&nbsp;recursive&nbsp;function&nbsp;to&nbsp;do&nbsp;the&nbsp;work
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1975"></a>1975</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;GeneratorsSmallestStab(MinimalStabChain(G));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1976"></a>1976</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1977"></a>1977</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1978"></a>1978</td><td></td><td></td><td></td><td><span><tt>InstallMethod(LargestElementGroup,"perm&nbsp;group&nbsp;via&nbsp;minimal&nbsp;stab&nbsp;chain",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1979"></a>1979</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[IsPermGroup],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1980"></a>1980</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;#&nbsp;call&nbsp;the&nbsp;recursive&nbsp;function&nbsp;to&nbsp;do&nbsp;the&nbsp;work
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1981"></a>1981</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;G&nbsp;->&nbsp;LargestElementStabChain(&nbsp;MinimalStabChain(&nbsp;G&nbsp;),&nbsp;One(&nbsp;G&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1982"></a>1982</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1983"></a>1983</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1984"></a>1984</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1985"></a>1985</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1986"></a>1986</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;KnowsHowToDecompose(&nbsp;&lt;G>,&nbsp;&lt;gens>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1987"></a>1987</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1988"></a>1988</td><td></td><td></td><td></td><td><span><tt>InstallMethod(KnowsHowToDecompose,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1989"></a>1989</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"perm&nbsp;group&nbsp;and&nbsp;generators:&nbsp;always&nbsp;true",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1990"></a>1990</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1991"></a>1991</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup,&nbsp;IsList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1992"></a>1992</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ReturnTrue);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1993"></a>1993</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1994"></a>1994</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1995"></a>1995</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1996"></a>1996</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1997"></a>1997</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ViewObj(&nbsp;&lt;G>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1998"></a>1998</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1999"></a>1999</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ViewString,&nbsp;"for&nbsp;a&nbsp;permutation&nbsp;group",&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2000"></a>2000</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPermGroup&nbsp;and&nbsp;HasGeneratorsOfGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2001"></a>2001</td><td></td><td></td><td></td><td><span><tt>function(G)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2002"></a>2002</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;gens,str;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2003"></a>2003</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;gens:=&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2004"></a>2004</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;30&nbsp;&lt;&nbsp;Length(&nbsp;gens&nbsp;)&nbsp;*&nbsp;LargestMovedPoint(&nbsp;G&nbsp;)&nbsp;/&nbsp;GAPInfo.ViewLength&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2005"></a>2005</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;str:="&lt;permutation&nbsp;group";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2006"></a>2006</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasSize(G)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2007"></a>2007</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(str,"&nbsp;of&nbsp;size&nbsp;");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2008"></a>2008</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(str,String(Size(G)));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2009"></a>2009</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2010"></a>2010</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Append(str,"&nbsp;with&nbsp;");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2011"></a>2011</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Append(str,String(Length(&nbsp;gens&nbsp;)));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2012"></a>2012</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Append(str,"&nbsp;generators>");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2013"></a>2013</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2014"></a>2014</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;str:="Group(";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2015"></a>2015</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;gens&nbsp;)&nbsp;or&nbsp;ForAll(gens,i->Order(i)=1)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2016"></a>2016</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(str,"()");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2017"></a>2017</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2018"></a>2018</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(str,ViewString(gens));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2019"></a>2019</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2020"></a>2020</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Append(str,")");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2021"></a>2021</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2022"></a>2022</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;str;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2023"></a>2023</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2024"></a>2024</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2025"></a>2025</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2026"></a>2026</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2027"></a>2027</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2028"></a>2028</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;AsList(&nbsp;&lt;G>&nbsp;)&nbsp;elements&nbsp;of&nbsp;perm&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2029"></a>2029</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2030"></a>2030</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;AsList,"permgp:&nbsp;AsSSortedList",&nbsp;true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2031"></a>2031</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,&nbsp;AsSSortedList&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2032"></a>2032</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2033"></a>2033</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2034"></a>2034</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2035"></a>2035</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;AsSSortedList(&nbsp;&lt;G>&nbsp;)&nbsp;elements&nbsp;of&nbsp;perm&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2036"></a>2036</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2037"></a>2037</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;AsSSortedList,"via&nbsp;stabchain",true,&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2038"></a>2038</td><td></td><td></td><td></td><td><span><tt>function(&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2039"></a>2039</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;ElementsStabChain(&nbsp;StabChainMutable(G));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2040"></a>2040</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2041"></a>2041</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2042"></a>2042</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;AsSSortedListNonstored,"via&nbsp;stabchain",&nbsp;true,&nbsp;[&nbsp;IsPermGroup&nbsp;],&nbsp;0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2043"></a>2043</td><td></td><td></td><td></td><td><span><tt>function(&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2044"></a>2044</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;ElementsStabChain(&nbsp;StabChainMutable(G));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2045"></a>2045</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2046"></a>2046</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2047"></a>2047</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2048"></a>2048</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2049"></a>2049</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ONanScottType(&nbsp;&lt;G>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2050"></a>2050</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2051"></a>2051</td><td></td><td></td><td></td><td><span><tt>InstallMethod(ONanScottType,"primitive&nbsp;permgroups",true,[IsPermGroup],0,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2052"></a>2052</td><td></td><td></td><td></td><td><span><tt>function(G)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2053"></a>2053</td><td></td><td></td><td></td><td><span><tt>local&nbsp;dom,s,cs,t,ts,o;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2054"></a>2054</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;dom:=MovedPoints(G);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2055"></a>2055</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;not&nbsp;IsPrimitive(G,dom)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2056"></a>2056</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Error("&lt;G>&nbsp;must&nbsp;be&nbsp;primitive");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2057"></a>2057</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2058"></a>2058</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;s:=Socle(G);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2059"></a>2059</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;IsAbelian(s)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2060"></a>2060</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;"1";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2061"></a>2061</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;elif&nbsp;IsSimpleGroup(s)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2062"></a>2062</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;"2";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2063"></a>2063</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;elif&nbsp;Length(dom)=Size(s)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2064"></a>2064</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;"5";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2065"></a>2065</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2066"></a>2066</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;now&nbsp;get&nbsp;one&nbsp;simple&nbsp;factor&nbsp;of&nbsp;the&nbsp;socle
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2067"></a>2067</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;cs:=CompositionSeries(s);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2068"></a>2068</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;the&nbsp;group&nbsp;is&nbsp;diagonal,&nbsp;the&nbsp;diagonal&nbsp;together&nbsp;with&nbsp;a&nbsp;maximal&nbsp;socle
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2069"></a>2069</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;normal&nbsp;subgroup&nbsp;generates&nbsp;the&nbsp;whole&nbsp;socle,&nbsp;so&nbsp;this&nbsp;normal&nbsp;subgroup
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2070"></a>2070</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;acts&nbsp;transitively.&nbsp;For&nbsp;product&nbsp;type&nbsp;this&nbsp;is&nbsp;not&nbsp;the&nbsp;case.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2071"></a>2071</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;t:=cs[Length(cs)-1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2072"></a>2072</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsTransitive(t,dom)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2073"></a>2073</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;type&nbsp;3
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2074"></a>2074</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(cs)=3&nbsp;and&nbsp;IsNormal(G,t)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2075"></a>2075</td><td></td><td></td><td></td><td><span><tt>	#&nbsp;intransitive&nbsp;on&nbsp;2&nbsp;components:
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2076"></a>2076</td><td></td><td></td><td></td><td><span><tt>	return&nbsp;"3a";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2077"></a>2077</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2078"></a>2078</td><td></td><td></td><td></td><td><span><tt>	return&nbsp;"3b";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2079"></a>2079</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2080"></a>2080</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2081"></a>2081</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;type&nbsp;4
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2082"></a>2082</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ts:=Orbit(G,t);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2083"></a>2083</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(ts)=2&nbsp;and&nbsp;NormalClosure(G,t)&lt;>s&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2084"></a>2084</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;"4a";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2085"></a>2085</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2086"></a>2086</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;find&nbsp;the&nbsp;block&nbsp;on&nbsp;the&nbsp;T's&nbsp;first:&nbsp;Those&nbsp;t&nbsp;which&nbsp;keep&nbsp;the&nbsp;orbit&nbsp;are
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2087"></a>2087</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;glued&nbsp;together&nbsp;diagonally
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2088"></a>2088</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;o:=Orbit(t,dom[1]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2089"></a>2089</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ts:=Filtered(ts,i->i=t&nbsp;or&nbsp;IsSubset(o,Orbit(i,dom[1])));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2090"></a>2090</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(ts)=1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2091"></a>2091</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;"4c";&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2092"></a>2092</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2093"></a>2093</td><td></td><td></td><td></td><td><span><tt>	return&nbsp;"4b";
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2094"></a>2094</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2095"></a>2095</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2096"></a>2096</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2097"></a>2097</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2098"></a>2098</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2099"></a>2099</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2100"></a>2100</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2101"></a>2101</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;SocleTypePrimitiveGroup(&nbsp;&lt;G>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2102"></a>2102</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2103"></a>2103</td><td></td><td></td><td></td><td><span><tt>InstallMethod(SocleTypePrimitiveGroup,"primitive&nbsp;permgroups",true,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2104"></a>2104</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;[IsPermGroup],0,function(G)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2105"></a>2105</td><td></td><td></td><td></td><td><span><tt>local&nbsp;s,cs,t,id,r;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2106"></a>2106</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;s:=Socle(G);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2107"></a>2107</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;cs:=CompositionSeries(s);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2108"></a>2108</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;t:=cs[Length(cs)-1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2109"></a>2109</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;id:=IsomorphismTypeInfoFiniteSimpleGroup(t);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2110"></a>2110</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;r:=rec(series:=id.series,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2111"></a>2111</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width:=Length(cs)-1,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2112"></a>2112</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:=id.name);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2113"></a>2113</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;IsBound(id.parameter)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2114"></a>2114</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;r.parameter:=id.parameter;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2115"></a>2115</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2116"></a>2116</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;r.parameter:=id.name;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2117"></a>2117</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2118"></a>2118</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;r;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2119"></a>2119</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2120"></a>2120</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2121"></a>2121</td><td></td><td></td><td></td><td><span><tt>#&nbsp;this&nbsp;function&nbsp;is&nbsp;needed&nbsp;for&nbsp;the&nbsp;transitive&nbsp;and&nbsp;primitive&nbsp;groups&nbsp;libraries
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2122"></a>2122</td><td></td><td></td><td></td><td><span><tt>BindGlobal("STGSelFunc",function(a,b)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2123"></a>2123</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;IsFunction(b)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2124"></a>2124</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;b(a);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2125"></a>2125</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;elif&nbsp;IsList(b)&nbsp;and&nbsp;not&nbsp;IsString(b)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2126"></a>2126</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;if&nbsp;IsList(a)&nbsp;and&nbsp;a=b&nbsp;then&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2127"></a>2127</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2128"></a>2128</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2129"></a>2129</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;return&nbsp;a&nbsp;in&nbsp;b;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2130"></a>2130</td><td></td><td></td><td></td><td><span><tt>&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2131"></a>2131</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;return&nbsp;a=b;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2132"></a>2132</td><td></td><td></td><td></td><td><span><tt>&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2133"></a>2133</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2134"></a>2134</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2135"></a>2135</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(DiagonalSocleAction,function(g,nr)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2136"></a>2136</td><td></td><td></td><td></td><td><span><tt>local&nbsp;ran,d,emb,u,act;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2137"></a>2137</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;ran:=[1..nr];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2138"></a>2138</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;d:=DirectProduct(List(ran,i->g));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2139"></a>2139</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;emb:=List(ran,i->Embedding(d,i));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2140"></a>2140</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;u:=List(GeneratorsOfGroup(g),i->Product(ran,j->Image(emb[j],i)));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2141"></a>2141</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;u:=SubgroupNC(d,u);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2142"></a>2142</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;act:=ActionHomomorphism(d,RightTransversal(d,u),OnRight,"surjective");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2143"></a>2143</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;Image(act,d);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2144"></a>2144</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2145"></a>2145</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2146"></a>2146</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(ReducedPermdegree,function(g)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2147"></a>2147</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;local&nbsp;dom,&nbsp;deg,&nbsp;orb,&nbsp;gdeg,&nbsp;p,&nbsp;ndom,&nbsp;s,hom;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2148"></a>2148</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;dom:=MovedPoints(g);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2149"></a>2149</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;deg:=Length(dom);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2150"></a>2150</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;orb:=ShallowCopy(Orbits(g,dom));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2151"></a>2151</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(orb)=1&nbsp;then&nbsp;return&nbsp;fail;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2152"></a>2152</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;gdeg:=20*LogInt(Size(g),2);&nbsp;#&nbsp;good&nbsp;degree
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2153"></a>2153</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;Sort(orb,function(a,b)&nbsp;return&nbsp;Length(a)&lt;Length(b);end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2154"></a>2154</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;p:=PositionProperty(orb,i->Length(i)>=gdeg);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2155"></a>2155</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;p=fail&nbsp;then&nbsp;p:=Length(orb);fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2156"></a>2156</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;ndom:=orb[p];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2157"></a>2157</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(ndom)*2>Length(dom)&nbsp;then&nbsp;return&nbsp;fail;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2158"></a>2158</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;s:=Stabilizer(g,orb[p],OnTuples);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2159"></a>2159</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;p:=p+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2160"></a>2160</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;p>Length(orb)&nbsp;then&nbsp;p:=1;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2161"></a>2161</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;while&nbsp;Size(s)>1&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2162"></a>2162</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;not&nbsp;ForAny(orb[p],j->ForAny(GeneratorsOfGroup(s),k->j^k&lt;>j))&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2163"></a>2163</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p:=p+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2164"></a>2164</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;p>Length(orb)&nbsp;then&nbsp;p:=1;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2165"></a>2165</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2166"></a>2166</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ndom:=Union(ndom,orb[p]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2167"></a>2167</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;s:=Stabilizer(s,orb[p],OnTuples);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2168"></a>2168</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2169"></a>2169</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;if&nbsp;Length(ndom)*2>Length(dom)&nbsp;then&nbsp;return&nbsp;fail;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2170"></a>2170</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;hom:=ActionHomomorphism(g,ndom,"surjective");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2171"></a>2171</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;SetIsInjective(hom,true);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2172"></a>2172</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;SetSize(Image(hom),Size(g));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2173"></a>2173</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;return&nbsp;hom;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2174"></a>2174</td><td></td><td></td><td></td><td><span><tt>end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2175"></a>2175</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2176"></a>2176</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2177"></a>2177</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2178"></a>2178</td><td></td><td></td><td></td><td><span><tt>#E
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2179"></a>2179</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
</tbody>
</table></body></html>
