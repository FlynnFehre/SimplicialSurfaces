<!DOCTYPE html><script src="sorttable.js"></script><html><body>
<style>
table { border-collapse: collapse }
tr:nth-child(odd)  { background-color: #EEE; }
tr:nth-child(even)  { background-color: #FFF; }
tr:nth-child(odd).exec  { background-color: #0F0; }
tr:nth-child(even).exec  { background-color: #3F3; }
tr:nth-child(odd).missed  { background-color: #F00; }
tr:nth-child(even).missed  { background-color: #F33; }
td, th {
    border: 1px solid #98bf21;
    padding: 3px 7px 2px 7px;
}
th {
    font-size: 1.1em;
    text-align: left;
    padding-top: 5px;
    padding-bottom: 4px;
    background-color: #A7C942;
    color: #ffffff;
}
table.sortable th:not(.sorttable_sorted):not(.sorttable_sorted_reverse):not(.sorttable_nosort):after {
    content: " \25B4\25BE"
}

/* HSV gradient made using http://www.perbang.dk/rgbgradient/ */
td.coverage00 { background-color: #FF0000; }
td.coverage10 { background-color: #F83100; }
td.coverage20 { background-color: #F25F00; }
td.coverage30 { background-color: #EB8B00; }
td.coverage40 { background-color: #E5B500; }
td.coverage50 { background-color: #DFDC00; }
td.coverage60 { background-color: #B0D800; }
td.coverage70 { background-color: #81D200; }
td.coverage80 { background-color: #55CB00; }
td.coverage90 { background-color: #2CC500; }
td.coverage100 { background-color: #04BF00; }
td:nth-child(1) { text-align: right; }
td:nth-child(2) { text-align: right; }
td:nth-child(3) { text-align: right; }
td:nth-child(4) { text-align: right; }
</style><p>This file was read by GAP before profiling was actived, so lines which were not read but not executed are not marked.</p><table class="sortable">
<thead><tr><th>Line</th><th>Execs</th><th>Time</th><th>Time+Childs</th><th>Code</th><th>Called Functions</th>
</tr></thead>
<tbody>
<tr class='ignore'><td><a name="line1"></a>1</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2"></a>2</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3"></a>3</td><td></td><td></td><td></td><td><span><tt>#W&nbsp;&nbsp;ctblfuns.gi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GAP&nbsp;library&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thomas&nbsp;Breuer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4"></a>4</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5"></a>5</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line6"></a>6</td><td></td><td></td><td></td><td><span><tt>#Y&nbsp;&nbsp;Copyright&nbsp;(C)&nbsp;&nbsp;1997,&nbsp;&nbsp;Lehrstuhl&nbsp;D&nbsp;f√ºr&nbsp;Mathematik,&nbsp;&nbsp;RWTH&nbsp;Aachen,&nbsp;&nbsp;Germany
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line7"></a>7</td><td></td><td></td><td></td><td><span><tt>#Y&nbsp;&nbsp;(C)&nbsp;1998&nbsp;School&nbsp;Math&nbsp;and&nbsp;Comp.&nbsp;Sci.,&nbsp;University&nbsp;of&nbsp;St&nbsp;Andrews,&nbsp;Scotland
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line8"></a>8</td><td></td><td></td><td></td><td><span><tt>#Y&nbsp;&nbsp;Copyright&nbsp;(C)&nbsp;2002&nbsp;The&nbsp;GAP&nbsp;Group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line9"></a>9</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line10"></a>10</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;This&nbsp;file&nbsp;contains&nbsp;generic&nbsp;methods&nbsp;for&nbsp;class&nbsp;functions.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line11"></a>11</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line12"></a>12</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;2.&nbsp;Basic&nbsp;Operations&nbsp;for&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line13"></a>13</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;3.&nbsp;Comparison&nbsp;of&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line14"></a>14</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;4.&nbsp;Arithmetic&nbsp;Operations&nbsp;for&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line15"></a>15</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;5.&nbsp;Printing&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line16"></a>16</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;6.&nbsp;Creating&nbsp;Class&nbsp;Functions&nbsp;from&nbsp;Values&nbsp;Lists
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line17"></a>17</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;7.&nbsp;Creating&nbsp;Class&nbsp;Functions&nbsp;using&nbsp;Groups
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line18"></a>18</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;8.&nbsp;Operations&nbsp;for&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line19"></a>19</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;9.&nbsp;Restricted&nbsp;and&nbsp;Induced&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line20"></a>20</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;10.&nbsp;Reducing&nbsp;Virtual&nbsp;Characters
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line21"></a>21</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;11.&nbsp;Symmetrizations&nbsp;of&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line22"></a>22</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;12.&nbsp;Operations&nbsp;for&nbsp;Brauer&nbsp;Characters
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line23"></a>23</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;13.&nbsp;Domains&nbsp;Generated&nbsp;by&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line24"></a>24</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;14.&nbsp;Auxiliary&nbsp;operations
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line25"></a>25</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line26"></a>26</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line27"></a>27</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line28"></a>28</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line29"></a>29</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line30"></a>30</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;CharacterString(&nbsp;&lt;char>,&nbsp;&lt;str>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;character&nbsp;information&nbsp;string
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line31"></a>31</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line32"></a>32</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;CharacterString,&nbsp;function(&nbsp;char,&nbsp;str&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line33"></a>33</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;str:=&nbsp;Concatenation(&nbsp;str,&nbsp;"&nbsp;of&nbsp;degree&nbsp;",&nbsp;String(&nbsp;char[1]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line34"></a>34</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ConvertToStringRep(&nbsp;str&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line35"></a>35</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;str;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line36"></a>36</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line37"></a>37</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line38"></a>38</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line39"></a>39</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line40"></a>40</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line41"></a>41</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;2.&nbsp;Basic&nbsp;Operations&nbsp;for&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line42"></a>42</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line43"></a>43</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line44"></a>44</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line45"></a>45</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line46"></a>46</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line47"></a>47</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;&lt;list>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line48"></a>48</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line49"></a>49</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;In&nbsp;order&nbsp;to&nbsp;treat&nbsp;lists&nbsp;as&nbsp;class&nbsp;functions&nbsp;where&nbsp;this&nbsp;makes&nbsp;sense,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line50"></a>50</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;we&nbsp;define&nbsp;that&nbsp;`ValuesOfClassFunction'&nbsp;returns&nbsp;the&nbsp;list&nbsp;&lt;list>&nbsp;itself.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line51"></a>51</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line52"></a>52</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;ValuesOfClassFunction,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line53"></a>53</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;dense&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line54"></a>54</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsDenseList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line55"></a>55</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line56"></a>56</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;list&nbsp;)&nbsp;and&nbsp;not&nbsp;HasValuesOfClassFunction(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line57"></a>57</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"class&nbsp;function&nbsp;&lt;list>&nbsp;must&nbsp;store&nbsp;its&nbsp;values&nbsp;list"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line58"></a>58</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line59"></a>59</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;list;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line60"></a>60</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line61"></a>61</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line62"></a>62</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line63"></a>63</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line64"></a>64</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line65"></a>65</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line66"></a>66</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\[\](&nbsp;&lt;psi>,&nbsp;&lt;i>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line67"></a>67</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Length(&nbsp;&lt;psi>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line68"></a>68</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsBound\[\](&nbsp;&lt;psi>,&nbsp;&lt;i>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line69"></a>69</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Position(&nbsp;&lt;psi>,&nbsp;&lt;obj>,&nbsp;0&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line70"></a>70</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line71"></a>71</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Class&nbsp;functions&nbsp;shall&nbsp;behave&nbsp;as&nbsp;immutable&nbsp;lists,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line72"></a>72</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;we&nbsp;install&nbsp;methods&nbsp;for&nbsp;`\[\]',&nbsp;`Length',&nbsp;`IsBound\[\]',&nbsp;`Position',
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line73"></a>73</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;and&nbsp;`ShallowCopy'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line74"></a>74</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line75"></a>75</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\[\],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line76"></a>76</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function&nbsp;and&nbsp;positive&nbsp;integer",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line77"></a>77</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line78"></a>78</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;i&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line79"></a>79</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line80"></a>80</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line81"></a>81</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line82"></a>82</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Length,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line83"></a>83</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line84"></a>84</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line85"></a>85</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chi&nbsp;->&nbsp;Length(&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line86"></a>86</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line87"></a>87</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsBound\[\],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line88"></a>88</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function&nbsp;and&nbsp;positive&nbsp;integer",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line89"></a>89</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line90"></a>90</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;i&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line91"></a>91</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;IsBound(&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line92"></a>92</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line93"></a>93</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line94"></a>94</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Position,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line95"></a>95</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function,&nbsp;cyclotomic,&nbsp;and&nbsp;nonnegative&nbsp;integer",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line96"></a>96</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsCyc,&nbsp;IsInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line97"></a>97</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;obj,&nbsp;pos&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line98"></a>98</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Position(&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;),&nbsp;obj,&nbsp;pos&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line99"></a>99</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line100"></a>100</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line101"></a>101</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ShallowCopy,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line102"></a>102</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line103"></a>103</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line104"></a>104</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chi&nbsp;->&nbsp;ShallowCopy(&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line105"></a>105</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line106"></a>106</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line107"></a>107</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line108"></a>108</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line109"></a>109</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;UnderlyingGroup(&nbsp;&lt;chi>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line110"></a>110</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line111"></a>111</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;UnderlyingGroup,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line112"></a>112</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line113"></a>113</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line114"></a>114</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chi&nbsp;->&nbsp;UnderlyingGroup(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line115"></a>115</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line116"></a>116</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line117"></a>117</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line118"></a>118</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line119"></a>119</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;3.&nbsp;Comparison&nbsp;of&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line120"></a>120</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line121"></a>121</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line122"></a>122</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line123"></a>123</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line124"></a>124</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line125"></a>125</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\=(&nbsp;&lt;chi>,&nbsp;&lt;psi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;equality&nbsp;of&nbsp;class&nbsp;functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line126"></a>126</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line127"></a>127</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\=,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line128"></a>128</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;class&nbsp;functions",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line129"></a>129</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line130"></a>130</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;psi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line131"></a>131</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;=&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line132"></a>132</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line133"></a>133</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line134"></a>134</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\=,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line135"></a>135</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function&nbsp;and&nbsp;a&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line136"></a>136</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line137"></a>137</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line138"></a>138</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line139"></a>139</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;=&nbsp;ValuesOfClassFunction(&nbsp;list&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line140"></a>140</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line141"></a>141</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;=&nbsp;list;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line142"></a>142</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line143"></a>143</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line144"></a>144</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line145"></a>145</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\=,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line146"></a>146</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;list&nbsp;and&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line147"></a>147</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList,&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line148"></a>148</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;list,&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line149"></a>149</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line150"></a>150</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ValuesOfClassFunction(&nbsp;list&nbsp;)&nbsp;=&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line151"></a>151</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line152"></a>152</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;list&nbsp;=&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line153"></a>153</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line154"></a>154</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line155"></a>155</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line156"></a>156</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line157"></a>157</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line158"></a>158</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line159"></a>159</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\&lt;(&nbsp;&lt;chi>,&nbsp;&lt;psi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;comparison&nbsp;of&nbsp;class&nbsp;functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line160"></a>160</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line161"></a>161</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\&lt;,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line162"></a>162</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;class&nbsp;functions",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line163"></a>163</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line164"></a>164</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;psi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line165"></a>165</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;&lt;&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line166"></a>166</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line167"></a>167</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line168"></a>168</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\&lt;,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line169"></a>169</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function&nbsp;and&nbsp;a&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line170"></a>170</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line171"></a>171</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line172"></a>172</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line173"></a>173</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;&lt;&nbsp;ValuesOfClassFunction(&nbsp;list&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line174"></a>174</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line175"></a>175</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;&lt;&nbsp;list;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line176"></a>176</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line177"></a>177</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line178"></a>178</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line179"></a>179</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\&lt;,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line180"></a>180</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;list&nbsp;and&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line181"></a>181</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line182"></a>182</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;list,&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line183"></a>183</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line184"></a>184</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ValuesOfClassFunction(&nbsp;list&nbsp;)&nbsp;&lt;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line185"></a>185</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line186"></a>186</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;list&nbsp;&lt;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line187"></a>187</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line188"></a>188</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line189"></a>189</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line190"></a>190</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line191"></a>191</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line192"></a>192</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line193"></a>193</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;4.&nbsp;Arithmetic&nbsp;Operations&nbsp;for&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line194"></a>194</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line195"></a>195</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line196"></a>196</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line197"></a>197</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line198"></a>198</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line199"></a>199</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\+(&nbsp;&lt;chi>,&nbsp;&lt;obj>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;sum&nbsp;of&nbsp;class&nbsp;function&nbsp;and&nbsp;object
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line200"></a>200</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\+(&nbsp;&lt;obj>,&nbsp;&lt;chi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;sum&nbsp;of&nbsp;object&nbsp;and&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line201"></a>201</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\+(&nbsp;&lt;chi>,&nbsp;&lt;psi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;sum&nbsp;of&nbsp;virtual&nbsp;characters
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line202"></a>202</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\+(&nbsp;&lt;chi>,&nbsp;&lt;psi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;sum&nbsp;of&nbsp;characters
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line203"></a>203</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line204"></a>204</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;The&nbsp;sum&nbsp;of&nbsp;two&nbsp;class&nbsp;functions&nbsp;(virtual&nbsp;characters,&nbsp;characters)&nbsp;of&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line205"></a>205</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;same&nbsp;character&nbsp;table&nbsp;is&nbsp;again&nbsp;a&nbsp;class&nbsp;function&nbsp;(virtual&nbsp;character,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line206"></a>206</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;character)&nbsp;of&nbsp;this&nbsp;table.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line207"></a>207</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;In&nbsp;all&nbsp;other&nbsp;cases,&nbsp;the&nbsp;addition&nbsp;is&nbsp;delegated&nbsp;to&nbsp;the&nbsp;list&nbsp;of&nbsp;values&nbsp;of
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line208"></a>208</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;the&nbsp;class&nbsp;function(s).
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line209"></a>209</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line210"></a>210</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;\+,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line211"></a>211</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function,&nbsp;and&nbsp;object",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line212"></a>212</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsObject&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line213"></a>213</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;obj&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line214"></a>214</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;sum;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line215"></a>215</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line216"></a>216</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;obj&nbsp;)&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line217"></a>217</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj(&nbsp;tbl,&nbsp;UnderlyingCharacterTable(&nbsp;obj&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line218"></a>218</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum:=&nbsp;ClassFunction(&nbsp;tbl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line219"></a>219</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;+&nbsp;ValuesOfClassFunction(&nbsp;obj&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line220"></a>220</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line221"></a>221</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum:=&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;+&nbsp;obj;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line222"></a>222</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line223"></a>223</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sum;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line224"></a>224</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line225"></a>225</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line226"></a>226</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;\+,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line227"></a>227</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;object,&nbsp;and&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line228"></a>228</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsObject,&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line229"></a>229</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;obj,&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line230"></a>230</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;sum;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line231"></a>231</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line232"></a>232</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;obj&nbsp;)&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line233"></a>233</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj(&nbsp;tbl,&nbsp;UnderlyingCharacterTable(&nbsp;obj&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line234"></a>234</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum:=&nbsp;ClassFunction(&nbsp;tbl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line235"></a>235</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;obj&nbsp;)&nbsp;+&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line236"></a>236</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line237"></a>237</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum:=&nbsp;obj&nbsp;+&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line238"></a>238</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line239"></a>239</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sum;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line240"></a>240</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line241"></a>241</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line242"></a>242</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\+,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line243"></a>243</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;virtual&nbsp;characters",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line244"></a>244</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line245"></a>245</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;and&nbsp;IsVirtualCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line246"></a>246</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsClassFunction&nbsp;and&nbsp;IsVirtualCharacter&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line247"></a>247</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;psi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line248"></a>248</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;sum;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line249"></a>249</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line250"></a>250</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;sum:=&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;+&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line251"></a>251</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsIdenticalObj(&nbsp;tbl,&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line252"></a>252</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum:=&nbsp;VirtualCharacter(&nbsp;tbl,&nbsp;sum&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line253"></a>253</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line254"></a>254</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sum;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line255"></a>255</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line256"></a>256</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line257"></a>257</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\+,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line258"></a>258</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;characters",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line259"></a>259</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line260"></a>260</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;and&nbsp;IsCharacter,&nbsp;IsClassFunction&nbsp;and&nbsp;IsCharacter&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line261"></a>261</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;psi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line262"></a>262</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;sum;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line263"></a>263</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line264"></a>264</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;sum:=&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;+&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line265"></a>265</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsIdenticalObj(&nbsp;tbl,&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line266"></a>266</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum:=&nbsp;Character(&nbsp;tbl,&nbsp;sum&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line267"></a>267</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line268"></a>268</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sum;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line269"></a>269</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line270"></a>270</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line271"></a>271</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line272"></a>272</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line273"></a>273</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line274"></a>274</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;AdditiveInverseOp(&nbsp;&lt;psi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;a&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line275"></a>275</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line276"></a>276</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;The&nbsp;additive&nbsp;inverse&nbsp;of&nbsp;a&nbsp;virtual&nbsp;character&nbsp;is&nbsp;again&nbsp;a&nbsp;virtual&nbsp;character,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line277"></a>277</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;but&nbsp;the&nbsp;additive&nbsp;inverse&nbsp;of&nbsp;a&nbsp;character&nbsp;is&nbsp;not&nbsp;a&nbsp;character,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line278"></a>278</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;so&nbsp;&nbsp;we&nbsp;cannot&nbsp;use&nbsp;`ClassFunctionSameType'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line279"></a>279</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line280"></a>280</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;AdditiveInverseOp,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line281"></a>281</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line282"></a>282</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line283"></a>283</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;psi&nbsp;->&nbsp;ClassFunction(&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line284"></a>284</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AdditiveInverse(&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;)&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line285"></a>285</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line286"></a>286</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line287"></a>287</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;AdditiveInverseOp,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line288"></a>288</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;virtual&nbsp;character",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line289"></a>289</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;and&nbsp;IsVirtualCharacter&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line290"></a>290</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;psi&nbsp;->&nbsp;VirtualCharacter(&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line291"></a>291</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AdditiveInverse(&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;)&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line292"></a>292</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line293"></a>293</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line294"></a>294</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line295"></a>295</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line296"></a>296</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ZeroOp(&nbsp;&lt;psi>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;a&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line297"></a>297</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line298"></a>298</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ZeroOp,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line299"></a>299</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line300"></a>300</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line301"></a>301</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;psi&nbsp;->&nbsp;VirtualCharacter(&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line302"></a>302</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Zero(&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;)&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line303"></a>303</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line304"></a>304</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line305"></a>305</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line306"></a>306</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line307"></a>307</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\*(&nbsp;&lt;cyc>,&nbsp;&lt;psi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;scalar&nbsp;multiple&nbsp;of&nbsp;a&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line308"></a>308</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\*(&nbsp;&lt;psi>,&nbsp;&lt;cyc>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;scalar&nbsp;multiple&nbsp;of&nbsp;a&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line309"></a>309</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line310"></a>310</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;We&nbsp;define&nbsp;a&nbsp;multiplication&nbsp;only&nbsp;for&nbsp;two&nbsp;class&nbsp;functions&nbsp;(being&nbsp;the&nbsp;tensor
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line311"></a>311</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;product),&nbsp;for&nbsp;scalar&nbsp;multiplication&nbsp;with&nbsp;cyclotomics,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line312"></a>312</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;and&nbsp;for&nbsp;default&nbsp;list&nbsp;times&nbsp;class&nbsp;function&nbsp;(where&nbsp;the&nbsp;class&nbsp;function&nbsp;acts
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line313"></a>313</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;as&nbsp;a&nbsp;scalar).
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line314"></a>314</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Note&nbsp;that&nbsp;more&nbsp;is&nbsp;not&nbsp;needed,&nbsp;since&nbsp;class&nbsp;functions&nbsp;are&nbsp;not&nbsp;in
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line315"></a>315</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;`IsMultiplicativeGeneralizedRowVector'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line316"></a>316</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line317"></a>317</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line318"></a>318</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;cyclotomic,&nbsp;and&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line319"></a>319</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCyc,&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line320"></a>320</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;cyc,&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line321"></a>321</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunction(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line322"></a>322</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cyc&nbsp;*&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line323"></a>323</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line324"></a>324</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line325"></a>325</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line326"></a>326</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;integer,&nbsp;and&nbsp;virtual&nbsp;character",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line327"></a>327</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsInt,&nbsp;IsVirtualCharacter&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line328"></a>328</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;cyc,&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line329"></a>329</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;VirtualCharacter(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line330"></a>330</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cyc&nbsp;*&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line331"></a>331</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line332"></a>332</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line333"></a>333</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line334"></a>334</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;positive&nbsp;integer,&nbsp;and&nbsp;character",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line335"></a>335</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsPosInt,&nbsp;IsCharacter&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line336"></a>336</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;cyc,&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line337"></a>337</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Character(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line338"></a>338</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cyc&nbsp;*&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line339"></a>339</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line340"></a>340</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line341"></a>341</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line342"></a>342</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function,&nbsp;and&nbsp;cyclotomic",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line343"></a>343</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsCyc&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line344"></a>344</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;cyc&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line345"></a>345</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunction(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line346"></a>346</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;*&nbsp;cyc&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line347"></a>347</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line348"></a>348</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line349"></a>349</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line350"></a>350</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;virtual&nbsp;character,&nbsp;and&nbsp;integer",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line351"></a>351</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsVirtualCharacter,&nbsp;IsInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line352"></a>352</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;cyc&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line353"></a>353</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;VirtualCharacter(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line354"></a>354</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;*&nbsp;cyc&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line355"></a>355</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line356"></a>356</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line357"></a>357</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line358"></a>358</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;character,&nbsp;and&nbsp;positive&nbsp;integer",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line359"></a>359</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacter,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line360"></a>360</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;cyc&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line361"></a>361</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Character(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line362"></a>362</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;*&nbsp;cyc&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line363"></a>363</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line364"></a>364</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line365"></a>365</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line366"></a>366</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line367"></a>367</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line368"></a>368</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;OneOp(&nbsp;&lt;psi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;a&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line369"></a>369</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line370"></a>370</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;OneOp,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line371"></a>371</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line372"></a>372</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line373"></a>373</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;psi&nbsp;->&nbsp;TrivialCharacter(&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line374"></a>374</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line375"></a>375</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line376"></a>376</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line377"></a>377</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line378"></a>378</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\*(&nbsp;&lt;chi>,&nbsp;&lt;psi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;tensor&nbsp;product&nbsp;of&nbsp;class&nbsp;functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line379"></a>379</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line380"></a>380</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line381"></a>381</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;class&nbsp;functions",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line382"></a>382</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line383"></a>383</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;psi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line384"></a>384</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;valschi,&nbsp;valspsi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line385"></a>385</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line386"></a>386</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsIdenticalObj(&nbsp;tbl,&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line387"></a>387</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"no&nbsp;product&nbsp;of&nbsp;class&nbsp;functions&nbsp;of&nbsp;different&nbsp;tables"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line388"></a>388</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line389"></a>389</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;valschi:=&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line390"></a>390</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;valspsi:=&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line391"></a>391</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunction(&nbsp;tbl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line392"></a>392</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;valschi&nbsp;)&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line393"></a>393</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;->&nbsp;valschi[x]&nbsp;*&nbsp;valspsi[x]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line394"></a>394</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line395"></a>395</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line396"></a>396</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line397"></a>397</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;virtual&nbsp;characters",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line398"></a>398</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line399"></a>399</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsVirtualCharacter,&nbsp;IsVirtualCharacter&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line400"></a>400</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;psi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line401"></a>401</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;valschi,&nbsp;valspsi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line402"></a>402</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line403"></a>403</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsIdenticalObj(&nbsp;tbl,&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line404"></a>404</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"no&nbsp;product&nbsp;of&nbsp;class&nbsp;functions&nbsp;of&nbsp;different&nbsp;tables"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line405"></a>405</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line406"></a>406</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;valschi:=&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line407"></a>407</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;valspsi:=&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line408"></a>408</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;VirtualCharacter(&nbsp;tbl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line409"></a>409</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;valschi&nbsp;)&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line410"></a>410</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;->&nbsp;valschi[x]&nbsp;*&nbsp;valspsi[x]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line411"></a>411</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line412"></a>412</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line413"></a>413</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line414"></a>414</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;characters",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line415"></a>415</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line416"></a>416</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacter,&nbsp;IsCharacter&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line417"></a>417</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;psi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line418"></a>418</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;valschi,&nbsp;valspsi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line419"></a>419</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line420"></a>420</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsIdenticalObj(&nbsp;tbl,&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line421"></a>421</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"no&nbsp;product&nbsp;of&nbsp;class&nbsp;functions&nbsp;of&nbsp;different&nbsp;tables"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line422"></a>422</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line423"></a>423</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;valschi:=&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line424"></a>424</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;valspsi:=&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line425"></a>425</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Character(&nbsp;tbl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line426"></a>426</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;valschi&nbsp;)&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line427"></a>427</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;->&nbsp;valschi[x]&nbsp;*&nbsp;valspsi[x]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line428"></a>428</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line429"></a>429</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line430"></a>430</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line431"></a>431</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line432"></a>432</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line433"></a>433</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\*(&nbsp;&lt;chi>,&nbsp;&lt;list>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;class&nbsp;function&nbsp;times&nbsp;default&nbsp;list
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line434"></a>434</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\*(&nbsp;&lt;list>,&nbsp;&lt;chi>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;default&nbsp;list&nbsp;times&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line435"></a>435</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line436"></a>436</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line437"></a>437</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function,&nbsp;and&nbsp;list&nbsp;in&nbsp;`IsListDefault'",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line438"></a>438</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsListDefault&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line439"></a>439</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line440"></a>440</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;list,&nbsp;entry&nbsp;->&nbsp;chi&nbsp;*&nbsp;entry&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line441"></a>441</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line442"></a>442</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line443"></a>443</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;\*,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line444"></a>444</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;list&nbsp;in&nbsp;`IsListDefault',&nbsp;and&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line445"></a>445</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsListDefault,&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line446"></a>446</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;list,&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line447"></a>447</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;list,&nbsp;entry&nbsp;->&nbsp;entry&nbsp;*&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line448"></a>448</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line449"></a>449</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line450"></a>450</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line451"></a>451</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line452"></a>452</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line453"></a>453</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Order(&nbsp;&lt;chi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;order&nbsp;of&nbsp;a&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line454"></a>454</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line455"></a>455</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Note&nbsp;that&nbsp;we&nbsp;are&nbsp;not&nbsp;allowed&nbsp;to&nbsp;regard&nbsp;the&nbsp;determinantal&nbsp;order&nbsp;of&nbsp;an
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line456"></a>456</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;arbitrary&nbsp;(virtual)&nbsp;character&nbsp;as&nbsp;its&nbsp;order,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line457"></a>457</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;since&nbsp;nonlinear&nbsp;characters&nbsp;do&nbsp;not&nbsp;have&nbsp;an&nbsp;order&nbsp;as&nbsp;mult.&nbsp;elements.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line458"></a>458</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line459"></a>459</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Order,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line460"></a>460</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line461"></a>461</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line462"></a>462</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line463"></a>463</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;order,&nbsp;values;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line464"></a>464</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line465"></a>465</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;values:=&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line466"></a>466</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;0&nbsp;in&nbsp;values&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line467"></a>467</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;chi>&nbsp;is&nbsp;not&nbsp;invertible"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line468"></a>468</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;ForAny(&nbsp;values,&nbsp;cyc&nbsp;->&nbsp;not&nbsp;IsIntegralCyclotomic(&nbsp;cyc&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line469"></a>469</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;cyc&nbsp;*&nbsp;GaloisCyc(&nbsp;cyc,&nbsp;-1&nbsp;)&nbsp;&lt;>&nbsp;1&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line470"></a>470</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;infinity;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line471"></a>471</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line472"></a>472</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;order:=&nbsp;Conductor(&nbsp;values&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line473"></a>473</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;order&nbsp;mod&nbsp;2&nbsp;=&nbsp;1&nbsp;and&nbsp;ForAny(&nbsp;values,&nbsp;i&nbsp;->&nbsp;i^order&nbsp;&lt;>&nbsp;1&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line474"></a>474</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;order:=&nbsp;2*order;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line475"></a>475</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line476"></a>476</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;order;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line477"></a>477</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line478"></a>478</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line479"></a>479</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line480"></a>480</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line481"></a>481</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line482"></a>482</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;InverseOp(&nbsp;&lt;chi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;a&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line483"></a>483</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line484"></a>484</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InverseOp,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line485"></a>485</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line486"></a>486</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line487"></a>487</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line488"></a>488</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;values;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line489"></a>489</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line490"></a>490</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;values:=&nbsp;List(&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;),&nbsp;Inverse&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line491"></a>491</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fail&nbsp;in&nbsp;values&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line492"></a>492</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line493"></a>493</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;HasIsCharacter(&nbsp;chi&nbsp;)&nbsp;and&nbsp;IsCharacter(&nbsp;chi&nbsp;)&nbsp;and&nbsp;values[1]&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line494"></a>494</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Character(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),&nbsp;values&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line495"></a>495</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line496"></a>496</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunction(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),&nbsp;values&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line497"></a>497</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line498"></a>498</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line499"></a>499</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line500"></a>500</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line501"></a>501</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line502"></a>502</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line503"></a>503</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\^(&nbsp;&lt;chi>,&nbsp;&lt;n>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;for&nbsp;class&nbsp;function&nbsp;and&nbsp;pos.&nbsp;integer
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line504"></a>504</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line505"></a>505</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;\^,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line506"></a>506</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function&nbsp;and&nbsp;positive&nbsp;integer&nbsp;(pointwise&nbsp;powering)",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line507"></a>507</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line508"></a>508</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line509"></a>509</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunctionSameType(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line510"></a>510</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chi,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line511"></a>511</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;),&nbsp;x&nbsp;->&nbsp;x^n&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line512"></a>512</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line513"></a>513</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line514"></a>514</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line515"></a>515</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line516"></a>516</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line517"></a>517</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\^(&nbsp;&lt;chi>,&nbsp;&lt;g>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;conjugate&nbsp;class&nbsp;function&nbsp;under&nbsp;action&nbsp;of&nbsp;&lt;g>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line518"></a>518</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line519"></a>519</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;\^,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line520"></a>520</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function&nbsp;and&nbsp;group&nbsp;element",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line521"></a>521</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsMultiplicativeElementWithInverse&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line522"></a>522</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;g&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line523"></a>523</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line524"></a>524</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line525"></a>525</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasUnderlyingGroup(&nbsp;tbl&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line526"></a>526</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G:=&nbsp;UnderlyingGroup(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line527"></a>527</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsElmsColls(&nbsp;FamilyObj(&nbsp;g&nbsp;),&nbsp;FamilyObj(&nbsp;G&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line528"></a>528</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunctionSameType(&nbsp;tbl,&nbsp;chi,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line529"></a>529</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Permuted(&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line530"></a>530</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CorrespondingPermutations(&nbsp;tbl,&nbsp;chi,&nbsp;[&nbsp;g&nbsp;]&nbsp;)[1]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line531"></a>531</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line532"></a>532</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line533"></a>533</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line534"></a>534</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line535"></a>535</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line536"></a>536</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line537"></a>537</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line538"></a>538</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line539"></a>539</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\^(&nbsp;&lt;chi>,&nbsp;&lt;galaut>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;Galois&nbsp;automorphism&nbsp;&lt;galaut>&nbsp;applied&nbsp;to&nbsp;&lt;chi>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line540"></a>540</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line541"></a>541</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;\^,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line542"></a>542</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function&nbsp;and&nbsp;Galois&nbsp;automorphism",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line543"></a>543</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsGeneralMapping&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line544"></a>544</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;galaut&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line545"></a>545</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsANFAutomorphismRep(&nbsp;galaut&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line546"></a>546</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;galaut:=&nbsp;galaut!.galois;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line547"></a>547</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunctionSameType(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),&nbsp;chi,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line548"></a>548</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line549"></a>549</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;->&nbsp;GaloisCyc(&nbsp;x,&nbsp;galaut&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line550"></a>550</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsOne(&nbsp;galaut&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line551"></a>551</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;chi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line552"></a>552</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line553"></a>553</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line554"></a>554</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line555"></a>555</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line556"></a>556</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line557"></a>557</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line558"></a>558</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line559"></a>559</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line560"></a>560</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\^(&nbsp;&lt;chi>,&nbsp;&lt;G>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;induced&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line561"></a>561</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\^(&nbsp;&lt;chi>,&nbsp;&lt;tbl>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;induced&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line562"></a>562</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line563"></a>563</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;\^,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line564"></a>564</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function&nbsp;and&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line565"></a>565</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line566"></a>566</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;InducedClassFunction&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line567"></a>567</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line568"></a>568</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;\^,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line569"></a>569</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function&nbsp;and&nbsp;nearly&nbsp;character&nbsp;table",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line570"></a>570</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsNearlyCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line571"></a>571</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;InducedClassFunction&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line572"></a>572</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line573"></a>573</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line574"></a>574</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line575"></a>575</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line576"></a>576</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\^(&nbsp;&lt;g>,&nbsp;&lt;chi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;value&nbsp;of&nbsp;&lt;chi>&nbsp;on&nbsp;group&nbsp;element&nbsp;&lt;g>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line577"></a>577</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line578"></a>578</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;\^,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line579"></a>579</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMultiplicativeElementWithInverse,&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line580"></a>580</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;g,&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line581"></a>581</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;ccl,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line582"></a>582</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line583"></a>583</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;HasUnderlyingGroup(&nbsp;tbl&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line584"></a>584</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"table&nbsp;&lt;tbl>&nbsp;of&nbsp;&lt;chi>&nbsp;does&nbsp;not&nbsp;store&nbsp;its&nbsp;group"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line585"></a>585</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;g&nbsp;in&nbsp;UnderlyingGroup(&nbsp;tbl&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line586"></a>586</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ccl:=&nbsp;ConjugacyClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line587"></a>587</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;ccl&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line588"></a>588</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;g&nbsp;in&nbsp;ccl[i]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line589"></a>589</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line590"></a>590</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line591"></a>591</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line592"></a>592</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line593"></a>593</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;g>&nbsp;must&nbsp;lie&nbsp;in&nbsp;the&nbsp;underlying&nbsp;group&nbsp;of&nbsp;&lt;chi>"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line594"></a>594</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line595"></a>595</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line596"></a>596</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line597"></a>597</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line598"></a>598</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line599"></a>599</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line600"></a>600</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;\^(&nbsp;&lt;psi>,&nbsp;&lt;chi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;conjugation&nbsp;of&nbsp;linear&nbsp;characters
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line601"></a>601</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line602"></a>602</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;\^,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line603"></a>603</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;class&nbsp;functions&nbsp;(conjugation,&nbsp;trivial&nbsp;action)",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line604"></a>604</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line605"></a>605</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;psi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line606"></a>606</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;chi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line607"></a>607</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line608"></a>608</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line609"></a>609</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line610"></a>610</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line611"></a>611</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line612"></a>612</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;GlobalPartitionOfClasses(&nbsp;&lt;tbl>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line613"></a>613</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line614"></a>614</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;GlobalPartitionOfClasses,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line615"></a>615</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;ordinary&nbsp;character&nbsp;table",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line616"></a>616</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line617"></a>617</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line618"></a>618</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;part,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;partition&nbsp;that&nbsp;has&nbsp;to&nbsp;be&nbsp;respected
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line619"></a>619</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;all&nbsp;maps&nbsp;to&nbsp;be&nbsp;respected
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line620"></a>620</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;map&nbsp;in&nbsp;'list'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line621"></a>621</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;contains&nbsp;number&nbsp;of&nbsp;root&nbsp;classes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line622"></a>622</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newpart,&nbsp;&nbsp;#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line623"></a>623</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values,&nbsp;&nbsp;&nbsp;#
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line624"></a>624</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;'orb'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line625"></a>625</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;point&nbsp;to&nbsp;map
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line626"></a>626</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line627"></a>627</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasAutomorphismsOfTable(&nbsp;tbl&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line628"></a>628</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line629"></a>629</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;orbits&nbsp;define&nbsp;the&nbsp;finest&nbsp;possible&nbsp;global&nbsp;partition.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line630"></a>630</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;part:=&nbsp;OrbitsDomain(&nbsp;AutomorphismsOfTable(&nbsp;tbl&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line631"></a>631</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;NrConjugacyClasses(&nbsp;tbl&nbsp;)&nbsp;)&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line632"></a>632</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line633"></a>633</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line634"></a>634</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line635"></a>635</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Conjugate&nbsp;classes&nbsp;must&nbsp;have&nbsp;same&nbsp;representative&nbsp;order&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line636"></a>636</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;same&nbsp;centralizer&nbsp;order.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line637"></a>637</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list:=&nbsp;[&nbsp;OrdersClassRepresentatives(&nbsp;tbl&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line638"></a>638</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SizesCentralizers(&nbsp;tbl&nbsp;)&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line639"></a>639</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line640"></a>640</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;number&nbsp;of&nbsp;root&nbsp;classes&nbsp;is&nbsp;by&nbsp;definition&nbsp;invariant&nbsp;under
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line641"></a>641</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;table&nbsp;automorphisms.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line642"></a>642</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;map&nbsp;in&nbsp;Compacted(&nbsp;ComputedPowerMaps(&nbsp;tbl&nbsp;)&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line643"></a>643</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv:=&nbsp;0&nbsp;*&nbsp;map;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line644"></a>644</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;map&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line645"></a>645</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv[j]:=&nbsp;inv[j]&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line646"></a>646</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line647"></a>647</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;list,&nbsp;inv&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line648"></a>648</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line649"></a>649</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line650"></a>650</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;All&nbsp;elements&nbsp;in&nbsp;`list'&nbsp;must&nbsp;be&nbsp;respected.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line651"></a>651</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Transform&nbsp;each&nbsp;of&nbsp;them&nbsp;into&nbsp;a&nbsp;partition,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line652"></a>652</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;and&nbsp;form&nbsp;the&nbsp;intersection&nbsp;of&nbsp;these&nbsp;partitions.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line653"></a>653</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;part:=&nbsp;Partition(&nbsp;[&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;list[1]&nbsp;)&nbsp;]&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line654"></a>654</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;map&nbsp;in&nbsp;list&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line655"></a>655</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newpart&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line656"></a>656</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values&nbsp;&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line657"></a>657</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;map&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line658"></a>658</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt:=&nbsp;Position(&nbsp;values,&nbsp;map[j]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line659"></a>659</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pt&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line660"></a>660</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;values,&nbsp;map[j]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line661"></a>661</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;newpart,&nbsp;[&nbsp;j&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line662"></a>662</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line663"></a>663</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;newpart[&nbsp;pt&nbsp;],&nbsp;j&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line664"></a>664</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line665"></a>665</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line666"></a>666</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StratMeetPartition(&nbsp;part,&nbsp;Partition(&nbsp;newpart&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line667"></a>667</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line668"></a>668</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;part:=&nbsp;List(&nbsp;Cells(&nbsp;part&nbsp;),&nbsp;Set&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line669"></a>669</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;unfortunately&nbsp;`Set'&nbsp;necessary&nbsp;...
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line670"></a>670</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line671"></a>671</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line672"></a>672</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line673"></a>673</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;part;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line674"></a>674</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line675"></a>675</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line676"></a>676</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line677"></a>677</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line678"></a>678</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line679"></a>679</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;CorrespondingPermutations(&nbsp;&lt;tbl>,&nbsp;&lt;elms>&nbsp;)&nbsp;&nbsp;.&nbsp;action&nbsp;on&nbsp;the&nbsp;conj.&nbsp;classes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line680"></a>680</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line681"></a>681</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;CorrespondingPermutations,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line682"></a>682</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;character&nbsp;table&nbsp;and&nbsp;list&nbsp;of&nbsp;group&nbsp;elements",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line683"></a>683</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line684"></a>684</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;elms&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line685"></a>685</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;classes,&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;conjugacy&nbsp;classes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line686"></a>686</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perms,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;permutations,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line687"></a>687</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;part,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;partition&nbsp;that&nbsp;has&nbsp;to&nbsp;be&nbsp;respected
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line688"></a>688</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;base&nbsp;of&nbsp;aut.&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line689"></a>689</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;`elms'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line690"></a>690</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;images,&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;images
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line691"></a>691</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;point&nbsp;to&nbsp;map
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line692"></a>692</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;actual&nbsp;image&nbsp;class
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line693"></a>693</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orb,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;possible&nbsp;image&nbsp;points
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line694"></a>694</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;length&nbsp;of&nbsp;'orb'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line695"></a>695</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;image&nbsp;point&nbsp;found?&nbsp;(boolean&nbsp;value)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line696"></a>696</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;'orb'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line697"></a>697</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;list&nbsp;in&nbsp;'part'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line698"></a>698</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;first&nbsp;point&nbsp;in&nbsp;orbit&nbsp;of&nbsp;'g'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line699"></a>699</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;minimal&nbsp;length&nbsp;of&nbsp;nontrivial&nbsp;orbit&nbsp;of&nbsp;'g'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line700"></a>700</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line701"></a>701</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;classes:=&nbsp;ConjugacyClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line702"></a>702</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line703"></a>703</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;perms:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line704"></a>704</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line705"></a>705</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;the&nbsp;table&nbsp;automorphisms&nbsp;are&nbsp;known&nbsp;then&nbsp;we&nbsp;only&nbsp;must&nbsp;determine
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line706"></a>706</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;images&nbsp;of&nbsp;a&nbsp;base&nbsp;of&nbsp;this&nbsp;group.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line707"></a>707</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasAutomorphismsOfTable(&nbsp;tbl&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line708"></a>708</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line709"></a>709</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;part:=&nbsp;AutomorphismsOfTable(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line710"></a>710</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line711"></a>711</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsTrivial(&nbsp;part&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line712"></a>712</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ListWithIdenticalEntries(&nbsp;Length(&nbsp;elms&nbsp;),&nbsp;()&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line713"></a>713</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line714"></a>714</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line715"></a>715</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;images&nbsp;of&nbsp;the&nbsp;base&nbsp;points&nbsp;of&nbsp;this&nbsp;group.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line716"></a>716</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base:=&nbsp;BaseOfGroup(&nbsp;part&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line717"></a>717</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line718"></a>718</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;g&nbsp;in&nbsp;elms&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line719"></a>719</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line720"></a>720</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsOne(&nbsp;g&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line721"></a>721</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line722"></a>722</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;`g'&nbsp;is&nbsp;the&nbsp;identity&nbsp;then&nbsp;nothing&nbsp;is&nbsp;to&nbsp;do.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line723"></a>723</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;perms,&nbsp;()&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line724"></a>724</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line725"></a>725</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line726"></a>726</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line727"></a>727</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;images:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line728"></a>728</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pt&nbsp;in&nbsp;base&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line729"></a>729</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line730"></a>730</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im:=&nbsp;Representative(&nbsp;classes[&nbsp;pt&nbsp;]&nbsp;)&nbsp;^&nbsp;g;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line731"></a>731</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line732"></a>732</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;Orbit(&nbsp;part,&nbsp;pt&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line733"></a>733</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;better&nbsp;CanonicalClassElement&nbsp;??
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line734"></a>734</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;im&nbsp;in&nbsp;classes[j]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line735"></a>735</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;images,&nbsp;j&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line736"></a>736</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line737"></a>737</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line738"></a>738</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line739"></a>739</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line740"></a>740</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line741"></a>741</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line742"></a>742</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line743"></a>743</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;a&nbsp;group&nbsp;element.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line744"></a>744</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;perms,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line745"></a>745</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RepresentativeAction(&nbsp;part,&nbsp;base,&nbsp;images,&nbsp;OnTuples&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line746"></a>746</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line747"></a>747</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line748"></a>748</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line749"></a>749</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line750"></a>750</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line751"></a>751</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line752"></a>752</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line753"></a>753</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;We&nbsp;can&nbsp;use&nbsp;only&nbsp;a&nbsp;partition&nbsp;into&nbsp;unions&nbsp;of&nbsp;orbits.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line754"></a>754</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line755"></a>755</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;part:=&nbsp;GlobalPartitionOfClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line756"></a>756</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;part&nbsp;)&nbsp;=&nbsp;Length(&nbsp;classes&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line757"></a>757</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ListWithIdenticalEntries(&nbsp;Length(&nbsp;elms&nbsp;),&nbsp;()&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line758"></a>758</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line759"></a>759</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line760"></a>760</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;g&nbsp;in&nbsp;elms&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line761"></a>761</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;It&nbsp;would&nbsp;be&nbsp;more&nbsp;natural&nbsp;to&nbsp;write
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line762"></a>762</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;Permutation(&nbsp;g,&nbsp;ConjugacyClasses(&nbsp;tbl&nbsp;),&nbsp;OnPoints&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line763"></a>763</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;*BUT*&nbsp;the&nbsp;`Permutation'&nbsp;method&nbsp;in&nbsp;question&nbsp;first&nbsp;asks&nbsp;whether
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line764"></a>764</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;the&nbsp;list&nbsp;of&nbsp;classes&nbsp;is&nbsp;sorted,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line765"></a>765</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;and&nbsp;there&nbsp;is&nbsp;no&nbsp;method&nbsp;to&nbsp;compare&nbsp;the&nbsp;classes!
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line766"></a>766</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line767"></a>767</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsOne(&nbsp;g&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line768"></a>768</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line769"></a>769</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;`g'&nbsp;is&nbsp;the&nbsp;identity&nbsp;then&nbsp;nothing&nbsp;is&nbsp;to&nbsp;do.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line770"></a>770</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;perms,&nbsp;()&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line771"></a>771</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line772"></a>772</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line773"></a>773</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line774"></a>774</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;orbits&nbsp;of&nbsp;`g'&nbsp;on&nbsp;the&nbsp;lists&nbsp;in&nbsp;`part',&nbsp;store&nbsp;the&nbsp;images.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line775"></a>775</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;have&nbsp;taken&nbsp;away&nbsp;a&nbsp;union&nbsp;of&nbsp;orbits&nbsp;such&nbsp;that&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line776"></a>776</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;number&nbsp;of&nbsp;remaining&nbsp;points&nbsp;is&nbsp;smaller&nbsp;than&nbsp;the&nbsp;smallest&nbsp;prime
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line777"></a>777</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;divisor&nbsp;of&nbsp;the&nbsp;order&nbsp;of&nbsp;`g'&nbsp;then&nbsp;all&nbsp;these&nbsp;points&nbsp;must&nbsp;be&nbsp;fixed.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line778"></a>778</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min:=&nbsp;FactorsInt(&nbsp;Order(&nbsp;g&nbsp;)&nbsp;)[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line779"></a>779</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;images:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line780"></a>780</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line781"></a>781</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;list&nbsp;in&nbsp;part&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line782"></a>782</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line783"></a>783</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;list&nbsp;)&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line784"></a>784</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;why&nbsp;not&nbsp;`min'&nbsp;?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line785"></a>785</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line786"></a>786</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;necessarily&nbsp;fixed&nbsp;point
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line787"></a>787</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;images[&nbsp;list[1]&nbsp;]:=&nbsp;list[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line788"></a>788</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line789"></a>789</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line790"></a>790</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line791"></a>791</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orb:=&nbsp;ShallowCopy(&nbsp;list&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line792"></a>792</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;min&nbsp;&lt;=&nbsp;Length(&nbsp;orb&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line793"></a>793</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line794"></a>794</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;There&nbsp;may&nbsp;be&nbsp;nontrivial&nbsp;orbits.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line795"></a>795</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt:=&nbsp;orb[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line796"></a>796</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first:=&nbsp;pt;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line797"></a>797</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line798"></a>798</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line799"></a>799</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;j&nbsp;&lt;=&nbsp;Length(&nbsp;orb&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line800"></a>800</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line801"></a>801</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im:=&nbsp;Representative(&nbsp;classes[&nbsp;pt&nbsp;]&nbsp;)&nbsp;^&nbsp;g;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line802"></a>802</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line803"></a>803</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;j&nbsp;&lt;=&nbsp;Length(&nbsp;orb&nbsp;)&nbsp;and&nbsp;not&nbsp;found&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line804"></a>804</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;better&nbsp;CanonicalClassElement&nbsp;??
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line805"></a>805</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;im&nbsp;in&nbsp;classes[&nbsp;orb[j]&nbsp;]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line806"></a>806</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;images[pt]:=&nbsp;orb[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line807"></a>807</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line808"></a>808</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line809"></a>809</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=&nbsp;j+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line810"></a>810</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line811"></a>811</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line812"></a>812</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RemoveSet(&nbsp;orb,&nbsp;pt&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line813"></a>813</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line814"></a>814</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;found&nbsp;and&nbsp;pt&nbsp;&lt;>&nbsp;images[&nbsp;pt&nbsp;]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line815"></a>815</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt:=&nbsp;images[&nbsp;pt&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line816"></a>816</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line817"></a>817</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line818"></a>818</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line819"></a>819</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line820"></a>820</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line821"></a>821</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;image&nbsp;must&nbsp;be&nbsp;the&nbsp;first&nbsp;point&nbsp;of&nbsp;the&nbsp;orbit&nbsp;under&nbsp;`g'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line822"></a>822</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;images[pt]:=&nbsp;first;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line823"></a>823</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line824"></a>824</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line825"></a>825</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line826"></a>826</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;remaining&nbsp;points&nbsp;of&nbsp;the&nbsp;orbit&nbsp;must&nbsp;be&nbsp;fixed.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line827"></a>827</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pt&nbsp;in&nbsp;orb&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line828"></a>828</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;images[pt]:=&nbsp;pt;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line829"></a>829</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line830"></a>830</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line831"></a>831</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line832"></a>832</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line833"></a>833</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line834"></a>834</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line835"></a>835</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;a&nbsp;group&nbsp;element.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line836"></a>836</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;perms,&nbsp;PermList(&nbsp;images&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line837"></a>837</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line838"></a>838</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line839"></a>839</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line840"></a>840</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line841"></a>841</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line842"></a>842</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line843"></a>843</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line844"></a>844</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;perms;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line845"></a>845</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line846"></a>846</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line847"></a>847</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line848"></a>848</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line849"></a>849</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line850"></a>850</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;CorrespondingPermutations(&nbsp;&lt;tbl>,&nbsp;&lt;chi>,&nbsp;&lt;elms>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line851"></a>851</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line852"></a>852</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;CorrespondingPermutations,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line853"></a>853</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;char.&nbsp;table,&nbsp;a&nbsp;hom.&nbsp;list,&nbsp;and&nbsp;a&nbsp;list&nbsp;of&nbsp;group&nbsp;elements",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line854"></a>854</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line855"></a>855</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;values,&nbsp;elms&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line856"></a>856</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;G,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;underlying&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line857"></a>857</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;classes,&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;conjugacy&nbsp;classes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line858"></a>858</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perms,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;permutations,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line859"></a>859</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;part,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;partition&nbsp;that&nbsp;has&nbsp;to&nbsp;be&nbsp;respected
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line860"></a>860</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;base&nbsp;of&nbsp;aut.&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line861"></a>861</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;`elms'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line862"></a>862</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;images,&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;images
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line863"></a>863</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;point&nbsp;to&nbsp;map
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line864"></a>864</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;actual&nbsp;image&nbsp;class
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line865"></a>865</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orb,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;possible&nbsp;image&nbsp;points
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line866"></a>866</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;length&nbsp;of&nbsp;'orb'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line867"></a>867</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;image&nbsp;point&nbsp;found?&nbsp;(boolean&nbsp;value)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line868"></a>868</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;'orb'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line869"></a>869</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;list&nbsp;in&nbsp;'part'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line870"></a>870</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;first&nbsp;point&nbsp;in&nbsp;orbit&nbsp;of&nbsp;'g'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line871"></a>871</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;minimal&nbsp;length&nbsp;of&nbsp;nontrivial&nbsp;orbit&nbsp;of&nbsp;'g'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line872"></a>872</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line873"></a>873</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;classes:=&nbsp;ConjugacyClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line874"></a>874</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;perms:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line875"></a>875</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line876"></a>876</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;the&nbsp;table&nbsp;automorphisms&nbsp;are&nbsp;known&nbsp;then&nbsp;we&nbsp;only&nbsp;must&nbsp;determine
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line877"></a>877</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;images&nbsp;of&nbsp;a&nbsp;base&nbsp;of&nbsp;this&nbsp;group.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line878"></a>878</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasAutomorphismsOfTable(&nbsp;tbl&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line879"></a>879</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line880"></a>880</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;part:=&nbsp;AutomorphismsOfTable(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line881"></a>881</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line882"></a>882</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsTrivial(&nbsp;part&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line883"></a>883</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ListWithIdenticalEntries(&nbsp;Length(&nbsp;elms&nbsp;),&nbsp;()&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line884"></a>884</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line885"></a>885</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line886"></a>886</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;images&nbsp;of&nbsp;the&nbsp;base&nbsp;points&nbsp;of&nbsp;this&nbsp;group.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line887"></a>887</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base:=&nbsp;BaseOfGroup(&nbsp;part&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line888"></a>888</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line889"></a>889</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;g&nbsp;in&nbsp;elms&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line890"></a>890</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line891"></a>891</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsOne(&nbsp;g&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line892"></a>892</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line893"></a>893</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;`g'&nbsp;is&nbsp;the&nbsp;identity&nbsp;then&nbsp;nothing&nbsp;is&nbsp;to&nbsp;do.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line894"></a>894</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;perms,&nbsp;()&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line895"></a>895</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line896"></a>896</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line897"></a>897</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line898"></a>898</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;images:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line899"></a>899</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pt&nbsp;in&nbsp;base&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line900"></a>900</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line901"></a>901</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im:=&nbsp;Representative(&nbsp;classes[&nbsp;pt&nbsp;]&nbsp;)&nbsp;^&nbsp;g;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line902"></a>902</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line903"></a>903</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;Orbit(&nbsp;part,&nbsp;pt&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line904"></a>904</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;better&nbsp;CanonicalClassElement&nbsp;??
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line905"></a>905</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;im&nbsp;in&nbsp;classes[j]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line906"></a>906</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;images,&nbsp;j&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line907"></a>907</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line908"></a>908</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line909"></a>909</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line910"></a>910</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=&nbsp;j+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line911"></a>911</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line912"></a>912</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line913"></a>913</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line914"></a>914</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line915"></a>915</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;a&nbsp;group&nbsp;element&nbsp;(if&nbsp;possible).
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line916"></a>916</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;perms,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line917"></a>917</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RepresentativeAction(&nbsp;part,&nbsp;base,&nbsp;images,&nbsp;OnTuples&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line918"></a>918</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line919"></a>919</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line920"></a>920</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line921"></a>921</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line922"></a>922</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line923"></a>923</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line924"></a>924</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line925"></a>925</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;We&nbsp;can&nbsp;use&nbsp;only&nbsp;a&nbsp;partition&nbsp;into&nbsp;unions&nbsp;of&nbsp;orbits.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line926"></a>926</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line927"></a>927</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;part:=&nbsp;GlobalPartitionOfClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line928"></a>928</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;part&nbsp;)&nbsp;=&nbsp;Length(&nbsp;classes&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line929"></a>929</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ListWithIdenticalEntries(&nbsp;Length(&nbsp;elms&nbsp;),&nbsp;()&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line930"></a>930</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line931"></a>931</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line932"></a>932</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;g&nbsp;in&nbsp;elms&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line933"></a>933</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line934"></a>934</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsOne(&nbsp;g&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line935"></a>935</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line936"></a>936</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;`g'&nbsp;is&nbsp;the&nbsp;identity&nbsp;then&nbsp;nothing&nbsp;is&nbsp;to&nbsp;do.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line937"></a>937</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;perms,&nbsp;()&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line938"></a>938</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line939"></a>939</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line940"></a>940</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line941"></a>941</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;orbits&nbsp;of&nbsp;`g'&nbsp;on&nbsp;the&nbsp;lists&nbsp;in&nbsp;`part',&nbsp;store&nbsp;the&nbsp;images.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line942"></a>942</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;have&nbsp;taken&nbsp;away&nbsp;a&nbsp;union&nbsp;of&nbsp;orbits&nbsp;such&nbsp;that&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line943"></a>943</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;number&nbsp;of&nbsp;remaining&nbsp;points&nbsp;is&nbsp;smaller&nbsp;than&nbsp;the&nbsp;smallest&nbsp;prime
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line944"></a>944</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;divisor&nbsp;of&nbsp;the&nbsp;order&nbsp;of&nbsp;`g'&nbsp;then&nbsp;all&nbsp;these&nbsp;points&nbsp;must&nbsp;be&nbsp;fixed.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line945"></a>945</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min:=&nbsp;FactorsInt(&nbsp;Order(&nbsp;g&nbsp;)&nbsp;)[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line946"></a>946</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;images:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line947"></a>947</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line948"></a>948</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;list&nbsp;in&nbsp;part&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line949"></a>949</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line950"></a>950</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;list&nbsp;)&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line951"></a>951</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;why&nbsp;not&nbsp;`min'&nbsp;?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line952"></a>952</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line953"></a>953</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;necessarily&nbsp;fixed&nbsp;point
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line954"></a>954</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;images[&nbsp;list[1]&nbsp;]:=&nbsp;list[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line955"></a>955</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line956"></a>956</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;Length(&nbsp;Set(&nbsp;values{&nbsp;list&nbsp;}&nbsp;)&nbsp;)&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line957"></a>957</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line958"></a>958</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;We&nbsp;may&nbsp;take&nbsp;any&nbsp;permutation&nbsp;of&nbsp;the&nbsp;orbit.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line959"></a>959</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;list&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line960"></a>960</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;images[j]:=&nbsp;j;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line961"></a>961</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line962"></a>962</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line963"></a>963</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line964"></a>964</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line965"></a>965</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orb:=&nbsp;ShallowCopy(&nbsp;list&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line966"></a>966</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;Length(&nbsp;orb&nbsp;)&nbsp;>=&nbsp;min&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line967"></a>967</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;fishy&nbsp;for&nbsp;S4&nbsp;acting&nbsp;on&nbsp;V4&nbsp;!!
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line968"></a>968</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line969"></a>969</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;There&nbsp;may&nbsp;be&nbsp;nontrivial&nbsp;orbits.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line970"></a>970</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt:=&nbsp;orb[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line971"></a>971</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first:=&nbsp;pt;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line972"></a>972</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line973"></a>973</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line974"></a>974</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;j&nbsp;&lt;=&nbsp;Length(&nbsp;orb&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line975"></a>975</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line976"></a>976</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;im:=&nbsp;Representative(&nbsp;classes[&nbsp;pt&nbsp;]&nbsp;)&nbsp;^&nbsp;g;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line977"></a>977</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line978"></a>978</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;j&nbsp;&lt;=&nbsp;Length(&nbsp;orb&nbsp;)&nbsp;and&nbsp;not&nbsp;found&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line979"></a>979</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;better&nbsp;CanonicalClassElement&nbsp;??
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line980"></a>980</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;im&nbsp;in&nbsp;classes[&nbsp;orb[j]&nbsp;]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line981"></a>981</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;images[pt]:=&nbsp;orb[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line982"></a>982</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line983"></a>983</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line984"></a>984</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=&nbsp;j+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line985"></a>985</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line986"></a>986</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line987"></a>987</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RemoveSet(&nbsp;orb,&nbsp;pt&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line988"></a>988</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line989"></a>989</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;found&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line990"></a>990</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line991"></a>991</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt:=&nbsp;images[pt];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line992"></a>992</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line993"></a>993</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line994"></a>994</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line995"></a>995</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line996"></a>996</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;image&nbsp;must&nbsp;be&nbsp;the&nbsp;first&nbsp;point&nbsp;of&nbsp;the&nbsp;orbit&nbsp;under&nbsp;`g'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line997"></a>997</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;images[pt]:=&nbsp;first;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line998"></a>998</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line999"></a>999</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1000"></a>1000</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1001"></a>1001</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;remaining&nbsp;points&nbsp;of&nbsp;the&nbsp;orbit&nbsp;must&nbsp;be&nbsp;fixed.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1002"></a>1002</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pt&nbsp;in&nbsp;orb&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1003"></a>1003</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;images[pt]:=&nbsp;pt;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1004"></a>1004</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1005"></a>1005</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1006"></a>1006</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1007"></a>1007</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1008"></a>1008</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1009"></a>1009</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1010"></a>1010</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;a&nbsp;group&nbsp;element.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1011"></a>1011</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;perms,&nbsp;PermList(&nbsp;images&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1012"></a>1012</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1013"></a>1013</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1014"></a>1014</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1015"></a>1015</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1016"></a>1016</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1017"></a>1017</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1018"></a>1018</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1019"></a>1019</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;perms;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1020"></a>1020</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1021"></a>1021</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1022"></a>1022</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1023"></a>1023</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1024"></a>1024</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1025"></a>1025</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ComplexConjugate(&nbsp;&lt;chi>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1026"></a>1026</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1027"></a>1027</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;We&nbsp;use&nbsp;`InstallOtherMethod'&nbsp;because&nbsp;class&nbsp;functions&nbsp;are&nbsp;both&nbsp;scalars&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1028"></a>1028</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;lists,&nbsp;so&nbsp;the&nbsp;method&nbsp;matches&nbsp;two&nbsp;declarations&nbsp;of&nbsp;the&nbsp;operation.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1029"></a>1029</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1030"></a>1030</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;ComplexConjugate,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1031"></a>1031</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1032"></a>1032</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;and&nbsp;IsCyclotomicCollection&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1033"></a>1033</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chi&nbsp;->&nbsp;GaloisCyc(&nbsp;chi,&nbsp;-1&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1034"></a>1034</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1035"></a>1035</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1036"></a>1036</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1037"></a>1037</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1038"></a>1038</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;GaloisCyc(&nbsp;&lt;chi>,&nbsp;&lt;k>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1039"></a>1039</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1040"></a>1040</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;GaloisCyc,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1041"></a>1041</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function,&nbsp;and&nbsp;an&nbsp;integer",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1042"></a>1042</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;and&nbsp;IsCyclotomicCollection,&nbsp;IsInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1043"></a>1043</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;k&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1044"></a>1044</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;char,&nbsp;n,&nbsp;g;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1045"></a>1045</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1046"></a>1046</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1047"></a>1047</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;char:=&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1048"></a>1048</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;Conductor(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1049"></a>1049</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;g:=&nbsp;Gcd(&nbsp;k,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1050"></a>1050</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1051"></a>1051</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;k&nbsp;=&nbsp;-1&nbsp;or
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1052"></a>1052</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;char&nbsp;=&nbsp;0&nbsp;and&nbsp;g&nbsp;=&nbsp;1&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1053"></a>1053</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunctionSameType(&nbsp;tbl,&nbsp;chi,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1054"></a>1054</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GaloisCyc(&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;),&nbsp;k&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1055"></a>1055</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;also&nbsp;if&nbsp;k&nbsp;acts&nbsp;as&nbsp;some&nbsp;*(p^d)&nbsp;for&nbsp;char&nbsp;=&nbsp;p
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1056"></a>1056</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;(reduce&nbsp;k&nbsp;mod&nbsp;n,&nbsp;and&nbsp;then&nbsp;what?)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1057"></a>1057</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1058"></a>1058</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunction(&nbsp;tbl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1059"></a>1059</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GaloisCyc(&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;),&nbsp;k&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1060"></a>1060</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1061"></a>1061</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1062"></a>1062</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1063"></a>1063</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1064"></a>1064</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1065"></a>1065</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1066"></a>1066</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Permuted(&nbsp;&lt;chi>,&nbsp;&lt;perm>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1067"></a>1067</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1068"></a>1068</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Permuted,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1069"></a>1069</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function,&nbsp;and&nbsp;a&nbsp;permutation",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1070"></a>1070</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsPerm&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1071"></a>1071</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;perm&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1072"></a>1072</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunction(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1073"></a>1073</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Permuted(&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;),&nbsp;perm&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1074"></a>1074</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1075"></a>1075</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1076"></a>1076</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1077"></a>1077</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1078"></a>1078</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1079"></a>1079</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;5.&nbsp;Printing&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1080"></a>1080</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1081"></a>1081</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1082"></a>1082</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1083"></a>1083</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1084"></a>1084</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ViewObj(&nbsp;&lt;psi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;view&nbsp;a&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1085"></a>1085</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1086"></a>1086</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Note&nbsp;that&nbsp;class&nbsp;functions&nbsp;are&nbsp;finite&nbsp;lists,&nbsp;so&nbsp;the&nbsp;default&nbsp;`ViewObj'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1087"></a>1087</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;method&nbsp;for&nbsp;finite&nbsp;lists&nbsp;should&nbsp;be&nbsp;avoided.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1088"></a>1088</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1089"></a>1089</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ViewObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1090"></a>1090</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1091"></a>1091</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1092"></a>1092</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;psi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1093"></a>1093</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"ClassFunction(&nbsp;"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1094"></a>1094</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;View(&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1095"></a>1095</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;",\&lt;\&lt;\&lt;\>\>\>&nbsp;"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1096"></a>1096</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;View(&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1097"></a>1097</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"&nbsp;)"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1098"></a>1098</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1099"></a>1099</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1100"></a>1100</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ViewObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1101"></a>1101</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;virtual&nbsp;character",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1102"></a>1102</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;and&nbsp;IsVirtualCharacter&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1103"></a>1103</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;psi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1104"></a>1104</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"VirtualCharacter(&nbsp;"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1105"></a>1105</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;View(&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1106"></a>1106</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;",\&lt;\&lt;\&lt;\>\>\>&nbsp;"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1107"></a>1107</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;View(&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1108"></a>1108</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"&nbsp;)"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1109"></a>1109</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1110"></a>1110</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1111"></a>1111</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ViewObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1112"></a>1112</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1113"></a>1113</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;and&nbsp;IsCharacter&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1114"></a>1114</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;psi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1115"></a>1115</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"Character(&nbsp;"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1116"></a>1116</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;View(&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1117"></a>1117</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;",\&lt;\&lt;\&lt;\>\>\>&nbsp;"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1118"></a>1118</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;View(&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1119"></a>1119</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"&nbsp;)"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1120"></a>1120</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1121"></a>1121</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1122"></a>1122</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1123"></a>1123</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1124"></a>1124</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1125"></a>1125</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;PrintObj(&nbsp;&lt;psi>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;print&nbsp;a&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1126"></a>1126</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1127"></a>1127</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;PrintObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1128"></a>1128</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1129"></a>1129</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1130"></a>1130</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;psi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1131"></a>1131</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"ClassFunction(&nbsp;",&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1132"></a>1132</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",&nbsp;",&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;),&nbsp;"&nbsp;)"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1133"></a>1133</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1134"></a>1134</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1135"></a>1135</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;PrintObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1136"></a>1136</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;virtual&nbsp;character",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1137"></a>1137</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;and&nbsp;IsVirtualCharacter&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1138"></a>1138</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;psi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1139"></a>1139</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"VirtualCharacter(&nbsp;",&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1140"></a>1140</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",&nbsp;",&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;),&nbsp;"&nbsp;)"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1141"></a>1141</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1142"></a>1142</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1143"></a>1143</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;PrintObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1144"></a>1144</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1145"></a>1145</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;and&nbsp;IsCharacter&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1146"></a>1146</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;psi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1147"></a>1147</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"Character(&nbsp;",&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1148"></a>1148</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",&nbsp;",&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;),&nbsp;"&nbsp;)"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1149"></a>1149</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1150"></a>1150</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1151"></a>1151</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1152"></a>1152</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1153"></a>1153</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1154"></a>1154</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Display(&nbsp;&lt;chi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;display&nbsp;a&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1155"></a>1155</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Display(&nbsp;&lt;chi>,&nbsp;&lt;arec>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1156"></a>1156</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1157"></a>1157</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Display,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1158"></a>1158</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1159"></a>1159</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1160"></a>1160</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1161"></a>1161</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Display(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),&nbsp;rec(&nbsp;chars:=&nbsp;[&nbsp;chi&nbsp;]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1162"></a>1162</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1163"></a>1163</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1164"></a>1164</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;Display,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1165"></a>1165</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function,&nbsp;and&nbsp;a&nbsp;record",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1166"></a>1166</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsRecord&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1167"></a>1167</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;arec&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1168"></a>1168</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;arec:=&nbsp;ShallowCopy(&nbsp;arec&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1169"></a>1169</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;arec.chars:=&nbsp;[&nbsp;chi&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1170"></a>1170</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Display(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),&nbsp;arec&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1171"></a>1171</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1172"></a>1172</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1173"></a>1173</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1174"></a>1174</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1175"></a>1175</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1176"></a>1176</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;6.&nbsp;Creating&nbsp;Class&nbsp;Functions&nbsp;from&nbsp;Values&nbsp;Lists
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1177"></a>1177</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1178"></a>1178</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1179"></a>1179</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1180"></a>1180</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1181"></a>1181</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1182"></a>1182</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ClassFunction(&nbsp;&lt;tbl>,&nbsp;&lt;values>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1183"></a>1183</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1184"></a>1184</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ClassFunction,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1185"></a>1185</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;nearly&nbsp;character&nbsp;table,&nbsp;and&nbsp;dense&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1186"></a>1186</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNearlyCharacterTable,&nbsp;IsDenseList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1187"></a>1187</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;values&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1188"></a>1188</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;chi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1189"></a>1189</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1190"></a>1190</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Check&nbsp;the&nbsp;no.&nbsp;of&nbsp;classes.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1191"></a>1191</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;NrConjugacyClasses(&nbsp;tbl&nbsp;)&nbsp;&lt;>&nbsp;Length(&nbsp;values&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1192"></a>1192</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"no.&nbsp;of&nbsp;classes&nbsp;in&nbsp;&lt;tbl>&nbsp;and&nbsp;&lt;values>&nbsp;must&nbsp;be&nbsp;equal"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1193"></a>1193</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1194"></a>1194</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1195"></a>1195</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;the&nbsp;object.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1196"></a>1196</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chi:=&nbsp;Objectify(&nbsp;NewType(&nbsp;FamilyObj(&nbsp;values&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1197"></a>1197</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsClassFunction
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1198"></a>1198</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;IsAttributeStoringRep&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1199"></a>1199</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rec()&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1200"></a>1200</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1201"></a>1201</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Store&nbsp;the&nbsp;defining&nbsp;attribute&nbsp;values.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1202"></a>1202</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetValuesOfClassFunction(&nbsp;chi,&nbsp;ValuesOfClassFunction(&nbsp;values&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1203"></a>1203</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetUnderlyingCharacterTable(&nbsp;chi,&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1204"></a>1204</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1205"></a>1205</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Store&nbsp;useful&nbsp;information.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1206"></a>1206</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsSmallList(&nbsp;values&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1207"></a>1207</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetIsSmallList(&nbsp;chi,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1208"></a>1208</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1209"></a>1209</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1210"></a>1210</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;chi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1211"></a>1211</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1212"></a>1212</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1213"></a>1213</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1214"></a>1214</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1215"></a>1215</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1216"></a>1216</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ClassFunction(&nbsp;&lt;G>,&nbsp;&lt;values>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1217"></a>1217</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1218"></a>1218</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ClassFunction,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1219"></a>1219</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;group,&nbsp;and&nbsp;a&nbsp;dense&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1220"></a>1220</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsGroup,&nbsp;IsDenseList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1221"></a>1221</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G,&nbsp;values&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1222"></a>1222</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunction(&nbsp;OrdinaryCharacterTable(&nbsp;G&nbsp;),&nbsp;values&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1223"></a>1223</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1224"></a>1224</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1225"></a>1225</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1226"></a>1226</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1227"></a>1227</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1228"></a>1228</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;VirtualCharacter(&nbsp;&lt;tbl>,&nbsp;&lt;values>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1229"></a>1229</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1230"></a>1230</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;VirtualCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1231"></a>1231</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;nearly&nbsp;character&nbsp;table,&nbsp;and&nbsp;dense&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1232"></a>1232</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNearlyCharacterTable,&nbsp;IsDenseList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1233"></a>1233</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;values&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1234"></a>1234</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;values:=&nbsp;ClassFunction(&nbsp;tbl,&nbsp;values&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1235"></a>1235</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetIsVirtualCharacter(&nbsp;values,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1236"></a>1236</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;values;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1237"></a>1237</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1238"></a>1238</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1239"></a>1239</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1240"></a>1240</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1241"></a>1241</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1242"></a>1242</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;VirtualCharacter(&nbsp;&lt;G>,&nbsp;&lt;values>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1243"></a>1243</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1244"></a>1244</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;VirtualCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1245"></a>1245</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;group,&nbsp;and&nbsp;a&nbsp;dense&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1246"></a>1246</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsGroup,&nbsp;IsDenseList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1247"></a>1247</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G,&nbsp;values&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1248"></a>1248</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;VirtualCharacter(&nbsp;OrdinaryCharacterTable(&nbsp;G&nbsp;),&nbsp;values&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1249"></a>1249</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1250"></a>1250</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1251"></a>1251</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1252"></a>1252</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1253"></a>1253</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1254"></a>1254</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Character(&nbsp;&lt;tbl>,&nbsp;&lt;values>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1255"></a>1255</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1256"></a>1256</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Character,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1257"></a>1257</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;nearly&nbsp;character&nbsp;table,&nbsp;and&nbsp;dense&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1258"></a>1258</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNearlyCharacterTable,&nbsp;IsDenseList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1259"></a>1259</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;values&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1260"></a>1260</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;values:=&nbsp;ClassFunction(&nbsp;tbl,&nbsp;values&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1261"></a>1261</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetIsCharacter(&nbsp;values,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1262"></a>1262</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;values;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1263"></a>1263</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1264"></a>1264</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1265"></a>1265</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1266"></a>1266</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1267"></a>1267</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1268"></a>1268</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Character(&nbsp;&lt;G>,&nbsp;&lt;values>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1269"></a>1269</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1270"></a>1270</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Character,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1271"></a>1271</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;group,&nbsp;and&nbsp;a&nbsp;dense&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1272"></a>1272</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsGroup,&nbsp;IsDenseList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1273"></a>1273</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G,&nbsp;values&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1274"></a>1274</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Character(&nbsp;OrdinaryCharacterTable(&nbsp;G&nbsp;),&nbsp;values&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1275"></a>1275</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1276"></a>1276</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1277"></a>1277</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1278"></a>1278</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1279"></a>1279</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1280"></a>1280</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;ClassFunctionSameType(&nbsp;&lt;tbl>,&nbsp;&lt;chi>,&nbsp;&lt;values>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1281"></a>1281</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1282"></a>1282</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;ClassFunctionSameType,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1283"></a>1283</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chi,&nbsp;values&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1284"></a>1284</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsClassFunction(&nbsp;chi&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1285"></a>1285</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;values;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1286"></a>1286</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;HasIsCharacter(&nbsp;chi&nbsp;)&nbsp;and&nbsp;IsCharacter(&nbsp;chi&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1287"></a>1287</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Character(&nbsp;tbl,&nbsp;values&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1288"></a>1288</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;HasIsVirtualCharacter(&nbsp;chi&nbsp;)&nbsp;and&nbsp;IsVirtualCharacter(&nbsp;chi&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1289"></a>1289</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;VirtualCharacter(&nbsp;tbl,&nbsp;values&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1290"></a>1290</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1291"></a>1291</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunction(&nbsp;tbl,&nbsp;values&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1292"></a>1292</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1293"></a>1293</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1294"></a>1294</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1295"></a>1295</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1296"></a>1296</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1297"></a>1297</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1298"></a>1298</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;7.&nbsp;Creating&nbsp;Class&nbsp;Functions&nbsp;using&nbsp;Groups
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1299"></a>1299</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1300"></a>1300</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1301"></a>1301</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1302"></a>1302</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1303"></a>1303</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1304"></a>1304</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;TrivialCharacter(&nbsp;&lt;tbl>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;for&nbsp;a&nbsp;character&nbsp;table
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1305"></a>1305</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1306"></a>1306</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;TrivialCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1307"></a>1307</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1308"></a>1308</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNearlyCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1309"></a>1309</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl&nbsp;->&nbsp;Character(&nbsp;tbl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1310"></a>1310</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ListWithIdenticalEntries(&nbsp;NrConjugacyClasses(&nbsp;tbl&nbsp;),&nbsp;1&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1311"></a>1311</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1312"></a>1312</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1313"></a>1313</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1314"></a>1314</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1315"></a>1315</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;TrivialCharacter(&nbsp;&lt;G>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;for&nbsp;a&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1316"></a>1316</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1317"></a>1317</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;TrivialCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1318"></a>1318</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;group&nbsp;(delegate&nbsp;to&nbsp;the&nbsp;table)",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1319"></a>1319</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1320"></a>1320</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;G&nbsp;->&nbsp;TrivialCharacter(&nbsp;OrdinaryCharacterTable(&nbsp;G&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1321"></a>1321</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1322"></a>1322</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1323"></a>1323</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1324"></a>1324</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1325"></a>1325</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;NaturalCharacter(&nbsp;&lt;G>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;for&nbsp;a&nbsp;permutation&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1326"></a>1326</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1327"></a>1327</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;NaturalCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1328"></a>1328</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;permutation&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1329"></a>1329</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsGroup&nbsp;and&nbsp;IsPermCollection&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1330"></a>1330</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1331"></a>1331</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;deg,&nbsp;tbl;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1332"></a>1332</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;deg:=&nbsp;NrMovedPoints(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1333"></a>1333</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;OrdinaryCharacterTable(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1334"></a>1334</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Character(&nbsp;tbl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1335"></a>1335</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;ConjugacyClasses(&nbsp;tbl&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1336"></a>1336</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;->&nbsp;deg&nbsp;-&nbsp;NrMovedPoints(&nbsp;Representative(&nbsp;C&nbsp;)&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1337"></a>1337</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1338"></a>1338</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1339"></a>1339</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1340"></a>1340</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1341"></a>1341</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1342"></a>1342</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;NaturalCharacter(&nbsp;&lt;G>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;for&nbsp;a&nbsp;matrix&nbsp;group&nbsp;in&nbsp;characteristic&nbsp;zero
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1343"></a>1343</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1344"></a>1344</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;NaturalCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1345"></a>1345</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;matrix&nbsp;group&nbsp;in&nbsp;characteristic&nbsp;zero",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1346"></a>1346</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsGroup&nbsp;and&nbsp;IsRingElementCollCollColl&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1347"></a>1347</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1348"></a>1348</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1349"></a>1349</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Characteristic(&nbsp;G&nbsp;)&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1350"></a>1350</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;OrdinaryCharacterTable(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1351"></a>1351</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Character(&nbsp;tbl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1352"></a>1352</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;ConjugacyClasses(&nbsp;tbl&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1353"></a>1353</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;->&nbsp;TraceMat(&nbsp;Representative(&nbsp;C&nbsp;)&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1354"></a>1354</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1355"></a>1355</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1356"></a>1356</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1357"></a>1357</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1358"></a>1358</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1359"></a>1359</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1360"></a>1360</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1361"></a>1361</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1362"></a>1362</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;NaturalCharacter(&nbsp;&lt;hom>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;a&nbsp;group&nbsp;homomorphism
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1363"></a>1363</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1364"></a>1364</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;We&nbsp;use&nbsp;shortcuts&nbsp;for&nbsp;homomorphisms&nbsp;onto&nbsp;permutation&nbsp;groups&nbsp;and&nbsp;matrix
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1365"></a>1365</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;groups&nbsp;in&nbsp;characteristic&nbsp;zero,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1366"></a>1366</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;since&nbsp;the&nbsp;meaning&nbsp;of&nbsp;`NaturalCharacter'&nbsp;is&nbsp;clear&nbsp;for&nbsp;these&nbsp;cases&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1367"></a>1367</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;we&nbsp;can&nbsp;avoid&nbsp;explicit&nbsp;conjugacy&nbsp;tests&nbsp;in&nbsp;the&nbsp;image.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1368"></a>1368</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;For&nbsp;other&nbsp;cases,&nbsp;we&nbsp;use&nbsp;a&nbsp;generic&nbsp;way.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1369"></a>1369</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1370"></a>1370</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;NaturalCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1371"></a>1371</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;group&nbsp;general&nbsp;mapping",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1372"></a>1372</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsGeneralMapping&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1373"></a>1373</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;hom&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1374"></a>1374</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;G,&nbsp;R,&nbsp;deg,&nbsp;tbl,&nbsp;chi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1375"></a>1375</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;G:=&nbsp;Source(&nbsp;hom&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1376"></a>1376</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;R:=&nbsp;Range(&nbsp;hom&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1377"></a>1377</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;OrdinaryCharacterTable(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1378"></a>1378</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsPermGroup(&nbsp;R&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1379"></a>1379</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deg:=&nbsp;NrMovedPoints(&nbsp;R&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1380"></a>1380</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Character(&nbsp;tbl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1381"></a>1381</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;ConjugacyClasses(&nbsp;tbl&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1382"></a>1382</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;->&nbsp;deg&nbsp;-&nbsp;NrMovedPoints(&nbsp;ImagesRepresentative(&nbsp;hom,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1383"></a>1383</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Representative(&nbsp;C&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1384"></a>1384</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsMatrixGroup(&nbsp;R&nbsp;)&nbsp;and&nbsp;Characteristic(&nbsp;R&nbsp;)&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1385"></a>1385</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Character(&nbsp;tbl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1386"></a>1386</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;ConjugacyClasses(&nbsp;tbl&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1387"></a>1387</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;->&nbsp;TraceMat(&nbsp;ImagesRepresentative(&nbsp;hom,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1388"></a>1388</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Representative(&nbsp;C&nbsp;)&nbsp;)&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1389"></a>1389</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1390"></a>1390</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chi:=&nbsp;NaturalCharacter(&nbsp;Image(&nbsp;hom&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1391"></a>1391</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Character(&nbsp;tbl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1392"></a>1392</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;ConjugacyClasses(&nbsp;tbl&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1393"></a>1393</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;->&nbsp;ImagesRepresentative(&nbsp;hom,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1394"></a>1394</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Representative(&nbsp;C&nbsp;)&nbsp;)&nbsp;^&nbsp;chi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1395"></a>1395</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1396"></a>1396</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1397"></a>1397</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1398"></a>1398</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1399"></a>1399</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1400"></a>1400</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1401"></a>1401</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;PermutationCharacter(&nbsp;&lt;G>,&nbsp;&lt;D>,&nbsp;&lt;opr>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;group&nbsp;action
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1402"></a>1402</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1403"></a>1403</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;PermutationCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1404"></a>1404</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"group&nbsp;action&nbsp;on&nbsp;domain",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1405"></a>1405</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsGroup,&nbsp;IsCollection,&nbsp;IsFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1406"></a>1406</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G,&nbsp;dom,&nbsp;opr&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1407"></a>1407</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1408"></a>1408</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;OrdinaryCharacterTable(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1409"></a>1409</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Character(&nbsp;tbl,&nbsp;List(&nbsp;ConjugacyClasses(&nbsp;tbl&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1410"></a>1410</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;->&nbsp;Number(&nbsp;dom,&nbsp;j&nbsp;->&nbsp;j&nbsp;=&nbsp;opr(&nbsp;j,&nbsp;Representative(i)&nbsp;)&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1411"></a>1411</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1412"></a>1412</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1413"></a>1413</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1414"></a>1414</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1415"></a>1415</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1416"></a>1416</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;PermutationCharacter(&nbsp;&lt;G>,&nbsp;&lt;U>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;two&nbsp;groups
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1417"></a>1417</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1418"></a>1418</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;PermutationCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1419"></a>1419</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;groups&nbsp;(use&nbsp;double&nbsp;cosets)",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1420"></a>1420</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1421"></a>1421</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsGroup,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1422"></a>1422</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G,&nbsp;U&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1423"></a>1423</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;C,&nbsp;c,&nbsp;s,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1424"></a>1424</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1425"></a>1425</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;OrdinaryCharacterTable(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1426"></a>1426</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;:=&nbsp;ConjugacyClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1427"></a>1427</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;:=&nbsp;[&nbsp;Index(&nbsp;G,&nbsp;U&nbsp;)&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1428"></a>1428</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;:=&nbsp;Size(&nbsp;U&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1429"></a>1429</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1430"></a>1430</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;&nbsp;in&nbsp;[&nbsp;2&nbsp;..&nbsp;Length(C)&nbsp;]&nbsp;&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1431"></a>1431</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c[i]:=&nbsp;Number(&nbsp;DoubleCosets(&nbsp;G,&nbsp;U,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1432"></a>1432</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SubgroupNC(&nbsp;G,&nbsp;[&nbsp;Representative(&nbsp;C[i]&nbsp;)&nbsp;]&nbsp;)&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1433"></a>1433</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;->&nbsp;Size(&nbsp;x&nbsp;)&nbsp;=&nbsp;s&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1434"></a>1434</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1435"></a>1435</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1436"></a>1436</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;character.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1437"></a>1437</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Character(&nbsp;tbl,&nbsp;c&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1438"></a>1438</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1439"></a>1439</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1440"></a>1440</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1441"></a>1441</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1442"></a>1442</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1443"></a>1443</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;#M&nbsp;&nbsp;PermutationCharacter(&nbsp;&lt;G>,&nbsp;&lt;U>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;two&nbsp;small&nbsp;groups
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1444"></a>1444</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1445"></a>1445</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;InstallMethod(&nbsp;PermutationCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1446"></a>1446</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;small&nbsp;groups",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1447"></a>1447</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsIdenticalObj,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1448"></a>1448</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsGroup&nbsp;and&nbsp;IsSmallGroup,&nbsp;IsGroup&nbsp;and&nbsp;IsSmallGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1449"></a>1449</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G,&nbsp;U&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1450"></a>1450</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;E,&nbsp;I,&nbsp;tbl;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1451"></a>1451</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1452"></a>1452</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;:=&nbsp;AsList(&nbsp;U&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1453"></a>1453</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;:=&nbsp;Size(&nbsp;G&nbsp;)&nbsp;/&nbsp;Length(&nbsp;E&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1454"></a>1454</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;OrdinaryCharacterTable(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1455"></a>1455</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Character(&nbsp;tbl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1456"></a>1456</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;ConjugacyClasses(&nbsp;tbl&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1457"></a>1457</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;->&nbsp;I&nbsp;*&nbsp;Length(&nbsp;Intersection2(&nbsp;AsList(&nbsp;C&nbsp;),&nbsp;E&nbsp;)&nbsp;)&nbsp;/&nbsp;Size(&nbsp;C&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1458"></a>1458</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1459"></a>1459</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1460"></a>1460</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1461"></a>1461</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1462"></a>1462</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1463"></a>1463</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;8.&nbsp;Operations&nbsp;for&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1464"></a>1464</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1465"></a>1465</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1466"></a>1466</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1467"></a>1467</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1468"></a>1468</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1469"></a>1469</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsCharacter(&nbsp;&lt;obj>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;for&nbsp;a&nbsp;virtual&nbsp;character
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1470"></a>1470</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1471"></a>1471</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1472"></a>1472</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;virtual&nbsp;character",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1473"></a>1473</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;and&nbsp;IsVirtualCharacter&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1474"></a>1474</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;obj&nbsp;->&nbsp;IsCharacter(&nbsp;UnderlyingCharacterTable(&nbsp;obj&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1475"></a>1475</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;obj&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1476"></a>1476</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1477"></a>1477</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1478"></a>1478</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1479"></a>1479</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1480"></a>1480</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;obj&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1481"></a>1481</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasIsVirtualCharacter(&nbsp;obj&nbsp;)&nbsp;and&nbsp;not&nbsp;IsVirtualCharacter(&nbsp;obj&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1482"></a>1482</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;can&nbsp;disappear&nbsp;when&nbsp;inverse&nbsp;implications&nbsp;are&nbsp;supported!
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1483"></a>1483</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1484"></a>1484</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1485"></a>1485</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;IsCharacter(&nbsp;UnderlyingCharacterTable(&nbsp;obj&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1486"></a>1486</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;obj&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1487"></a>1487</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1488"></a>1488</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1489"></a>1489</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1490"></a>1490</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;ordinary&nbsp;character&nbsp;table,&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1491"></a>1491</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1492"></a>1492</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1493"></a>1493</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;chi,&nbsp;scpr;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1494"></a>1494</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1495"></a>1495</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Proper&nbsp;characters&nbsp;have&nbsp;positive&nbsp;degree.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1496"></a>1496</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;list[1]&nbsp;&lt;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1497"></a>1497</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1498"></a>1498</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1499"></a>1499</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1500"></a>1500</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Check&nbsp;the&nbsp;scalar&nbsp;products&nbsp;with&nbsp;all&nbsp;irreducibles.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1501"></a>1501</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;chi&nbsp;in&nbsp;Irr(&nbsp;tbl&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1502"></a>1502</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr:=&nbsp;ScalarProduct(&nbsp;tbl,&nbsp;chi,&nbsp;list&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1503"></a>1503</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsInt(&nbsp;scpr&nbsp;)&nbsp;or&nbsp;scpr&nbsp;&lt;&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1504"></a>1504</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1505"></a>1505</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1506"></a>1506</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1507"></a>1507</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1508"></a>1508</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1509"></a>1509</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1510"></a>1510</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1511"></a>1511</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;Brauer&nbsp;table,&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1512"></a>1512</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsBrauerTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1513"></a>1513</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1514"></a>1514</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;chi,&nbsp;scpr;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1515"></a>1515</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1516"></a>1516</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Proper&nbsp;characters&nbsp;have&nbsp;positive&nbsp;degree.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1517"></a>1517</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;list[1]&nbsp;&lt;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1518"></a>1518</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1519"></a>1519</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1520"></a>1520</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1521"></a>1521</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Check&nbsp;the&nbsp;decomposition.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1522"></a>1522</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Decomposition(&nbsp;Irr(&nbsp;tbl&nbsp;),&nbsp;[&nbsp;list&nbsp;],&nbsp;"nonnegative"&nbsp;)[1]&nbsp;&lt;>&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1523"></a>1523</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1524"></a>1524</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1525"></a>1525</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1526"></a>1526</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1527"></a>1527</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1528"></a>1528</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsVirtualCharacter(&nbsp;&lt;chi>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;a&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1529"></a>1529</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1530"></a>1530</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsVirtualCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1531"></a>1531</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1532"></a>1532</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1533"></a>1533</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chi&nbsp;->&nbsp;IsVirtualCharacter(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1534"></a>1534</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1535"></a>1535</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1536"></a>1536</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsVirtualCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1537"></a>1537</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;ordinary&nbsp;character&nbsp;table,&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1538"></a>1538</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1539"></a>1539</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1540"></a>1540</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;chi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1541"></a>1541</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1542"></a>1542</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Check&nbsp;the&nbsp;scalar&nbsp;products&nbsp;with&nbsp;all&nbsp;irreducibles.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1543"></a>1543</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;chi&nbsp;in&nbsp;Irr(&nbsp;tbl&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1544"></a>1544</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsInt(&nbsp;ScalarProduct(&nbsp;tbl,&nbsp;chi,&nbsp;list&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1545"></a>1545</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1546"></a>1546</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1547"></a>1547</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1548"></a>1548</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1549"></a>1549</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1550"></a>1550</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1551"></a>1551</td><td></td><td></td><td></td><td><span><tt>#&nbsp;InstallMethod(&nbsp;IsVirtualCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1552"></a>1552</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;Brauer&nbsp;table,&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1553"></a>1553</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsBrauerTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1554"></a>1554</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1555"></a>1555</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;???
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1556"></a>1556</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1557"></a>1557</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1558"></a>1558</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1559"></a>1559</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1560"></a>1560</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1561"></a>1561</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsIrreducibleCharacter(&nbsp;&lt;chi>&nbsp;)&nbsp;&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;a&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1562"></a>1562</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1563"></a>1563</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsIrreducibleCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1564"></a>1564</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1565"></a>1565</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1566"></a>1566</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chi&nbsp;->&nbsp;IsIrreducibleCharacter(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1567"></a>1567</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1568"></a>1568</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1569"></a>1569</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsIrreducibleCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1570"></a>1570</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;ordinary&nbsp;character&nbsp;table,&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1571"></a>1571</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1572"></a>1572</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1573"></a>1573</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsVirtualCharacter(&nbsp;tbl,&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1574"></a>1574</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;ScalarProduct(&nbsp;tbl,&nbsp;list,&nbsp;list)&nbsp;=&nbsp;1
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1575"></a>1575</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;list[1]&nbsp;>&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1576"></a>1576</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1577"></a>1577</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1578"></a>1578</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsIrreducibleCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1579"></a>1579</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;Brauer&nbsp;table,&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1580"></a>1580</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsBrauerTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1581"></a>1581</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1582"></a>1582</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,&nbsp;found;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1583"></a>1583</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;list:=&nbsp;Decomposition(&nbsp;Irr(&nbsp;tbl&nbsp;),&nbsp;[&nbsp;list&nbsp;],&nbsp;"nonnegative"&nbsp;)[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1584"></a>1584</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;list&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1585"></a>1585</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1586"></a>1586</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1587"></a>1587</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;found:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1588"></a>1588</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;list&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1589"></a>1589</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1590"></a>1590</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;found&nbsp;or&nbsp;i&nbsp;&lt;>&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1591"></a>1591</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1592"></a>1592</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1593"></a>1593</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1594"></a>1594</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1595"></a>1595</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1596"></a>1596</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1597"></a>1597</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;found;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1598"></a>1598</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1599"></a>1599</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1600"></a>1600</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1601"></a>1601</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1602"></a>1602</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1603"></a>1603</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ScalarProduct(&nbsp;&lt;chi>,&nbsp;&lt;psi>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;for&nbsp;two&nbsp;class&nbsp;functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1604"></a>1604</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1605"></a>1605</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ScalarProduct,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1606"></a>1606</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;class&nbsp;functions",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1607"></a>1607</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1608"></a>1608</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;psi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1609"></a>1609</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;i,&nbsp;size,&nbsp;weights,&nbsp;scalarproduct;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1610"></a>1610</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1611"></a>1611</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1612"></a>1612</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;tbl&nbsp;&lt;>&nbsp;UnderlyingCharacterTable(&nbsp;psi&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1613"></a>1613</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;chi>&nbsp;and&nbsp;&lt;psi>&nbsp;have&nbsp;different&nbsp;character&nbsp;tables"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1614"></a>1614</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1615"></a>1615</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ScalarProduct(&nbsp;tbl,&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1616"></a>1616</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;psi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1617"></a>1617</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1618"></a>1618</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1619"></a>1619</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1620"></a>1620</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1621"></a>1621</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1622"></a>1622</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ScalarProduct(&nbsp;&lt;tbl>,&nbsp;&lt;chi>,&nbsp;&lt;psi>&nbsp;)&nbsp;.&nbsp;&nbsp;scalar&nbsp;product&nbsp;of&nbsp;class&nbsp;functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1623"></a>1623</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1624"></a>1624</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ScalarProduct,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1625"></a>1625</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;character&nbsp;table&nbsp;and&nbsp;two&nbsp;homogeneous&nbsp;lists",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1626"></a>1626</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsRowVector,&nbsp;IsRowVector&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1627"></a>1627</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;x1,&nbsp;x2&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1628"></a>1628</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;variable
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1629"></a>1629</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;scalar&nbsp;product,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1630"></a>1630</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weight;&nbsp;&nbsp;#&nbsp;lengths&nbsp;of&nbsp;conjugacy&nbsp;classes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1631"></a>1631</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1632"></a>1632</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;weight:=&nbsp;SizesConjugacyClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1633"></a>1633</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;x1:=&nbsp;ValuesOfClassFunction(&nbsp;x1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1634"></a>1634</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;x2:=&nbsp;ValuesOfClassFunction(&nbsp;x2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1635"></a>1635</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;scpr:=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1636"></a>1636</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;x1&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1637"></a>1637</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr:=&nbsp;scpr&nbsp;+&nbsp;x1[i]&nbsp;*&nbsp;GaloisCyc(&nbsp;x2[i],&nbsp;-1&nbsp;)&nbsp;*&nbsp;weight[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1638"></a>1638</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1639"></a>1639</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;scpr&nbsp;/&nbsp;Size(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1640"></a>1640</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1641"></a>1641</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1642"></a>1642</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1643"></a>1643</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1644"></a>1644</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1645"></a>1645</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;MatScalarProducts(&nbsp;[&lt;tbl>,&nbsp;]&lt;list1>,&nbsp;&lt;list2>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1646"></a>1646</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;MatScalarProducts(&nbsp;[&lt;tbl>,&nbsp;]&lt;list>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1647"></a>1647</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1648"></a>1648</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;MatScalarProducts,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1649"></a>1649</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;homogeneous&nbsp;lists",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1650"></a>1650</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1651"></a>1651</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;list1,&nbsp;list2&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1652"></a>1652</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;list1&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1653"></a>1653</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1654"></a>1654</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;not&nbsp;IsClassFunction(&nbsp;list1[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1655"></a>1655</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;list1>&nbsp;must&nbsp;consist&nbsp;of&nbsp;class&nbsp;functions"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1656"></a>1656</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1657"></a>1657</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;MatScalarProducts(&nbsp;UnderlyingCharacterTable(&nbsp;list1[1]&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1658"></a>1658</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list1,&nbsp;list2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1659"></a>1659</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1660"></a>1660</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1661"></a>1661</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1662"></a>1662</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;MatScalarProducts,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1663"></a>1663</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1664"></a>1664</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1665"></a>1665</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1666"></a>1666</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1667"></a>1667</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1668"></a>1668</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;not&nbsp;IsClassFunction(&nbsp;list[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1669"></a>1669</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;list>&nbsp;must&nbsp;consist&nbsp;of&nbsp;class&nbsp;functions"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1670"></a>1670</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1671"></a>1671</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;MatScalarProducts(&nbsp;UnderlyingCharacterTable(&nbsp;list[1]&nbsp;),&nbsp;list&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1672"></a>1672</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1673"></a>1673</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1674"></a>1674</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1675"></a>1675</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;MatScalarProducts,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1676"></a>1676</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;ordinary&nbsp;table,&nbsp;and&nbsp;two&nbsp;homogeneous&nbsp;lists",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1677"></a>1677</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1678"></a>1678</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;list1,&nbsp;list2&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1679"></a>1679</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,&nbsp;j,&nbsp;chi,&nbsp;nccl,&nbsp;weight,&nbsp;scprmatrix,&nbsp;order,&nbsp;scpr;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1680"></a>1680</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1681"></a>1681</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;list1&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1682"></a>1682</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1683"></a>1683</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1684"></a>1684</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;list1:=&nbsp;List(&nbsp;list1,&nbsp;ValuesOfClassFunction&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1685"></a>1685</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1686"></a>1686</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nccl:=&nbsp;NrConjugacyClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1687"></a>1687</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;weight:=&nbsp;SizesConjugacyClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1688"></a>1688</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;order:=&nbsp;Size(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1689"></a>1689</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1690"></a>1690</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;scprmatrix:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1691"></a>1691</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;list2&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1692"></a>1692</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scprmatrix[i]:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1693"></a>1693</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chi:=&nbsp;List(&nbsp;ValuesOfClassFunction(&nbsp;list2[i]&nbsp;),&nbsp;x&nbsp;->&nbsp;GaloisCyc(x,-1)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1694"></a>1694</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;nccl&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1695"></a>1695</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chi[j]:=&nbsp;chi[j]&nbsp;*&nbsp;weight[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1696"></a>1696</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1697"></a>1697</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;list1&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1698"></a>1698</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr:=&nbsp;(&nbsp;chi&nbsp;*&nbsp;j&nbsp;)&nbsp;/&nbsp;order;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1699"></a>1699</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;scprmatrix[i],&nbsp;scpr&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1700"></a>1700</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsInt(&nbsp;scpr&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1701"></a>1701</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsRat(&nbsp;scpr&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1702"></a>1702</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;2,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1703"></a>1703</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"MatScalarProducts:&nbsp;sum&nbsp;not&nbsp;divisible&nbsp;by&nbsp;group&nbsp;order"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1704"></a>1704</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsCyc(&nbsp;scpr&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1705"></a>1705</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;2,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1706"></a>1706</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"MatScalarProducts:&nbsp;summation&nbsp;not&nbsp;integer&nbsp;valued");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1707"></a>1707</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1708"></a>1708</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1709"></a>1709</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1710"></a>1710</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1711"></a>1711</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;scprmatrix;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1712"></a>1712</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1713"></a>1713</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1714"></a>1714</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;MatScalarProducts,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1715"></a>1715</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;ordinary&nbsp;table,&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1716"></a>1716</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1717"></a>1717</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1718"></a>1718</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,&nbsp;j,&nbsp;chi,&nbsp;nccl,&nbsp;weight,&nbsp;scprmatrix,&nbsp;order,&nbsp;scpr;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1719"></a>1719</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1720"></a>1720</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1721"></a>1721</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1722"></a>1722</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1723"></a>1723</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;list:=&nbsp;List(&nbsp;list,&nbsp;ValuesOfClassFunction&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1724"></a>1724</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1725"></a>1725</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nccl:=&nbsp;NrConjugacyClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1726"></a>1726</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;weight:=&nbsp;SizesConjugacyClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1727"></a>1727</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;order:=&nbsp;Size(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1728"></a>1728</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1729"></a>1729</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;scprmatrix:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1730"></a>1730</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;list&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1731"></a>1731</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scprmatrix[i]:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1732"></a>1732</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chi:=&nbsp;List(&nbsp;list[i],&nbsp;x&nbsp;->&nbsp;GaloisCyc(&nbsp;x,&nbsp;-1&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1733"></a>1733</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;nccl&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1734"></a>1734</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chi[j]:=&nbsp;chi[j]&nbsp;*&nbsp;weight[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1735"></a>1735</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1736"></a>1736</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;i&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1737"></a>1737</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr:=&nbsp;(&nbsp;chi&nbsp;*&nbsp;list[j]&nbsp;)&nbsp;/&nbsp;order;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1738"></a>1738</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;scprmatrix[i],&nbsp;scpr&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1739"></a>1739</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsInt(&nbsp;scpr&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1740"></a>1740</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsRat(&nbsp;scpr&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1741"></a>1741</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;2,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1742"></a>1742</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"MatScalarProducts:&nbsp;sum&nbsp;not&nbsp;divisible&nbsp;by&nbsp;group&nbsp;order"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1743"></a>1743</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsCyc(&nbsp;scpr&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1744"></a>1744</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;2,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1745"></a>1745</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"MatScalarProducts:&nbsp;summation&nbsp;not&nbsp;integer&nbsp;valued");
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1746"></a>1746</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1747"></a>1747</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1748"></a>1748</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1749"></a>1749</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1750"></a>1750</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;scprmatrix;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1751"></a>1751</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1752"></a>1752</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1753"></a>1753</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1754"></a>1754</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1755"></a>1755</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1756"></a>1756</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Norm(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;norm&nbsp;of&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1757"></a>1757</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1758"></a>1758</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;Norm,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1759"></a>1759</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1760"></a>1760</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1761"></a>1761</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chi&nbsp;->&nbsp;ScalarProduct(&nbsp;chi,&nbsp;chi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1762"></a>1762</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1763"></a>1763</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;Norm,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1764"></a>1764</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;ordinary&nbsp;character&nbsp;table&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1765"></a>1765</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1766"></a>1766</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1767"></a>1767</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ScalarProduct(&nbsp;tbl,&nbsp;chi,&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1768"></a>1768</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1769"></a>1769</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1770"></a>1770</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1771"></a>1771</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1772"></a>1772</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1773"></a>1773</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;CentreOfCharacter(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;centre&nbsp;of&nbsp;a&nbsp;character
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1774"></a>1774</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1775"></a>1775</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;CentreOfCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1776"></a>1776</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1777"></a>1777</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1778"></a>1778</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chi&nbsp;->&nbsp;CentreOfCharacter(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1779"></a>1779</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1780"></a>1780</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1781"></a>1781</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;CentreOfCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1782"></a>1782</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;ordinary&nbsp;table,&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list&nbsp;",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1783"></a>1783</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1784"></a>1784</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;list&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1785"></a>1785</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;HasUnderlyingGroup(&nbsp;tbl&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1786"></a>1786</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;tbl>&nbsp;does&nbsp;not&nbsp;store&nbsp;its&nbsp;group"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1787"></a>1787</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1788"></a>1788</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NormalSubgroupClasses(&nbsp;tbl,&nbsp;ClassPositionsOfCentre(&nbsp;list&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1789"></a>1789</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1790"></a>1790</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1791"></a>1791</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1792"></a>1792</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1793"></a>1793</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1794"></a>1794</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ClassPositionsOfCentre(&nbsp;&lt;chi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;classes&nbsp;in&nbsp;the&nbsp;centre&nbsp;of&nbsp;a&nbsp;character
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1795"></a>1795</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1796"></a>1796</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;We&nbsp;know&nbsp;that&nbsp;an&nbsp;algebraic&nbsp;integer&nbsp;$\alpha$&nbsp;is&nbsp;a&nbsp;root&nbsp;of&nbsp;unity
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1797"></a>1797</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;all&nbsp;conjugates&nbsp;of&nbsp;$\alpha$&nbsp;have&nbsp;absolute&nbsp;value&nbsp;at&nbsp;most&nbsp;1.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1798"></a>1798</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Since&nbsp;$\alpha^{\ast}&nbsp;\overline{\alpha^{\ast}}&nbsp;=&nbsp;1$&nbsp;holds&nbsp;for&nbsp;a&nbsp;Galois
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1799"></a>1799</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;automorphism&nbsp;$\ast$&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;$\alpha&nbsp;\overline{\alpha}&nbsp;=&nbsp;1$&nbsp;holds,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1800"></a>1800</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;a&nbsp;cyclotomic&nbsp;integer&nbsp;is&nbsp;a&nbsp;root&nbsp;of&nbsp;unity&nbsp;iff&nbsp;its&nbsp;absolute&nbsp;value&nbsp;is&nbsp;$1$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1801"></a>1801</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1802"></a>1802</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Cf.&nbsp;the&nbsp;comment&nbsp;about&nbsp;the&nbsp;`Order'&nbsp;method&nbsp;for&nbsp;cyclotomics&nbsp;in&nbsp;the&nbsp;file
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1803"></a>1803</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;`lib/cyclotom.g'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1804"></a>1804</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1805"></a>1805</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;The&nbsp;`IsCyc'&nbsp;test&nbsp;is&nbsp;necessary&nbsp;to&nbsp;avoid&nbsp;errors&nbsp;in&nbsp;the&nbsp;case&nbsp;that&nbsp;&lt;chi>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1806"></a>1806</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;contains&nbsp;unknowns.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1807"></a>1807</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1808"></a>1808</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ClassPositionsOfCentre,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1809"></a>1809</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1810"></a>1810</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1811"></a>1811</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1812"></a>1812</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;deg,&nbsp;mdeg,&nbsp;degsquare;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1813"></a>1813</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1814"></a>1814</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;deg:=&nbsp;chi[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1815"></a>1815</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;mdeg:=&nbsp;-&nbsp;deg;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1816"></a>1816</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;degsquare:=&nbsp;deg^2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1817"></a>1817</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1818"></a>1818</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;PositionsProperty(&nbsp;chi,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1819"></a>1819</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;->&nbsp;x&nbsp;=&nbsp;deg&nbsp;or&nbsp;x&nbsp;=&nbsp;mdeg&nbsp;or
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1820"></a>1820</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;(&nbsp;not&nbsp;IsInt(&nbsp;x&nbsp;)&nbsp;)&nbsp;and&nbsp;IsCyc(&nbsp;x&nbsp;)&nbsp;and&nbsp;IsCycInt(&nbsp;x&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1821"></a>1821</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;x&nbsp;*&nbsp;GaloisCyc(&nbsp;x,&nbsp;-1&nbsp;)&nbsp;=&nbsp;degsquare&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1822"></a>1822</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1823"></a>1823</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1824"></a>1824</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1825"></a>1825</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1826"></a>1826</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1827"></a>1827</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ConstituentsOfCharacter(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>&nbsp;)&nbsp;.&nbsp;&nbsp;irred.&nbsp;constituents&nbsp;of&nbsp;&lt;chi>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1828"></a>1828</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1829"></a>1829</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ConstituentsOfCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1830"></a>1830</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1831"></a>1831</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chi&nbsp;->&nbsp;ConstituentsOfCharacter(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),&nbsp;chi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1832"></a>1832</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1833"></a>1833</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ConstituentsOfCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1834"></a>1834</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1835"></a>1835</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;and&nbsp;IsCharacter&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1836"></a>1836</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1837"></a>1837</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;underlying&nbsp;table&nbsp;of&nbsp;`chi'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1838"></a>1838</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irr,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;irreducible&nbsp;characters&nbsp;of&nbsp;`tbl'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1839"></a>1839</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values,&nbsp;#&nbsp;character&nbsp;values
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1840"></a>1840</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deg,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;degree&nbsp;of&nbsp;`chi'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1841"></a>1841</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const,&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;constituents,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1842"></a>1842</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;`irr'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1843"></a>1843</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irrdeg,&nbsp;#&nbsp;degree&nbsp;of&nbsp;an&nbsp;irred.&nbsp;character
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1844"></a>1844</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;scalar&nbsp;product
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1845"></a>1845</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1846"></a>1846</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1847"></a>1847</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;irr:=&nbsp;Irr(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1848"></a>1848</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;values:=&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1849"></a>1849</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;deg:=&nbsp;values[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1850"></a>1850</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;const:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1851"></a>1851</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;i:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1852"></a>1852</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;0&nbsp;&lt;&nbsp;deg&nbsp;and&nbsp;i&nbsp;&lt;=&nbsp;Length(&nbsp;irr&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1853"></a>1853</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irrdeg:=&nbsp;DegreeOfCharacter(&nbsp;irr[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1854"></a>1854</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;irrdeg&nbsp;&lt;=&nbsp;deg&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1855"></a>1855</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr:=&nbsp;ScalarProduct(&nbsp;tbl,&nbsp;chi,&nbsp;irr[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1856"></a>1856</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;scpr&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1857"></a>1857</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;deg:=&nbsp;deg&nbsp;-&nbsp;scpr&nbsp;*&nbsp;irrdeg;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1858"></a>1858</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;const,&nbsp;irr[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1859"></a>1859</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1860"></a>1860</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1861"></a>1861</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i:=&nbsp;i+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1862"></a>1862</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1863"></a>1863</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1864"></a>1864</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Set(&nbsp;const&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1865"></a>1865</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1866"></a>1866</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1867"></a>1867</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ConstituentsOfCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1868"></a>1868</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;ordinary&nbsp;table,&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1869"></a>1869</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1870"></a>1870</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1871"></a>1871</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;irr,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;irreducible&nbsp;characters&nbsp;of&nbsp;`tbl'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1872"></a>1872</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const,&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;constituents,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1873"></a>1873</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proper,&nbsp;#&nbsp;is&nbsp;`chi'&nbsp;a&nbsp;proper&nbsp;character
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1874"></a>1874</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;`irr'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1875"></a>1875</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;scalar&nbsp;product
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1876"></a>1876</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1877"></a>1877</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;const:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1878"></a>1878</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;proper:=&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1879"></a>1879</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;Irr(&nbsp;tbl&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1880"></a>1880</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr:=&nbsp;ScalarProduct(&nbsp;tbl,&nbsp;chi,&nbsp;i&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1881"></a>1881</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;scpr&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1882"></a>1882</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;const,&nbsp;i&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1883"></a>1883</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proper:=&nbsp;proper&nbsp;and&nbsp;IsInt(&nbsp;scpr&nbsp;)&nbsp;and&nbsp;(&nbsp;0&nbsp;&lt;&nbsp;scpr&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1884"></a>1884</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1885"></a>1885</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1886"></a>1886</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1887"></a>1887</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;In&nbsp;the&nbsp;case&nbsp;`proper&nbsp;=&nbsp;true'&nbsp;we&nbsp;know&nbsp;that&nbsp;`chi'&nbsp;is&nbsp;a&nbsp;character.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1888"></a>1888</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;proper&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1889"></a>1889</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetIsCharacter(&nbsp;chi,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1890"></a>1890</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1891"></a>1891</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1892"></a>1892</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Set(&nbsp;const&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1893"></a>1893</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1894"></a>1894</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1895"></a>1895</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ConstituentsOfCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1896"></a>1896</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;Brauer&nbsp;table,&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1897"></a>1897</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsBrauerTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1898"></a>1898</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1899"></a>1899</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;irr,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;irreducible&nbsp;characters&nbsp;of&nbsp;`tbl'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1900"></a>1900</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dec;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1901"></a>1901</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1902"></a>1902</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;irr:=&nbsp;Irr(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1903"></a>1903</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;dec:=&nbsp;Decomposition(&nbsp;irr,&nbsp;[&nbsp;chi&nbsp;],&nbsp;"nonnegative"&nbsp;)[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1904"></a>1904</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;dec&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1905"></a>1905</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1906"></a>1906</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1907"></a>1907</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;irr{&nbsp;Filtered(&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;dec&nbsp;)&nbsp;],&nbsp;i&nbsp;->&nbsp;dec[i]&nbsp;&lt;>&nbsp;0&nbsp;)&nbsp;};
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1908"></a>1908</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1909"></a>1909</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1910"></a>1910</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1911"></a>1911</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1912"></a>1912</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1913"></a>1913</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DegreeOfCharacter(&nbsp;&lt;chi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;a&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1914"></a>1914</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1915"></a>1915</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DegreeOfCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1916"></a>1916</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1917"></a>1917</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1918"></a>1918</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chi&nbsp;->&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1919"></a>1919</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1920"></a>1920</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1921"></a>1921</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1922"></a>1922</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1923"></a>1923</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;InertiaSubgroup(&nbsp;[&lt;tbl>,&nbsp;]&lt;G>,&nbsp;&lt;chi>&nbsp;)&nbsp;&nbsp;.&nbsp;inertia&nbsp;subgroup&nbsp;of&nbsp;a&nbsp;character
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1924"></a>1924</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1925"></a>1925</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InertiaSubgroup,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1926"></a>1926</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;group,&nbsp;and&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1927"></a>1927</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsGroup,&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1928"></a>1928</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;G,&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1929"></a>1929</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InertiaSubgroup(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),&nbsp;G,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1930"></a>1930</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1931"></a>1931</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1932"></a>1932</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1933"></a>1933</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InertiaSubgroup,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1934"></a>1934</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;ordinary&nbsp;table,&nbsp;a&nbsp;group,&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1935"></a>1935</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsGroup,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1936"></a>1936</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;G,&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1937"></a>1937</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;H,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;group&nbsp;of&nbsp;`chi'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1938"></a>1938</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;index&nbsp;of&nbsp;`H'&nbsp;in&nbsp;`G'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1939"></a>1939</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;induced,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;induced&nbsp;of&nbsp;`chi'&nbsp;from&nbsp;`H'&nbsp;to&nbsp;`G'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1940"></a>1940</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;global&nbsp;partition&nbsp;of&nbsp;classes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1941"></a>1941</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;part,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;refined&nbsp;partition
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1942"></a>1942</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;set&nbsp;in&nbsp;`global'&nbsp;and&nbsp;`part'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1943"></a>1943</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;value&nbsp;in&nbsp;`p'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1944"></a>1944</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;character&nbsp;values&nbsp;on&nbsp;`p'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1945"></a>1945</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;refinements&nbsp;of&nbsp;`p'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1946"></a>1946</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;stored&nbsp;partitions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1947"></a>1947</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;position&nbsp;where&nbsp;to&nbsp;store&nbsp;new&nbsp;partition&nbsp;later
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1948"></a>1948</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;perms,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;permutations&nbsp;corresp.&nbsp;to&nbsp;generators&nbsp;of&nbsp;`G'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1949"></a>1949</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permgrp,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;group&nbsp;generated&nbsp;by&nbsp;`perms'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1950"></a>1950</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stab;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;inertia&nbsp;subgroup,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1951"></a>1951</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1952"></a>1952</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;`G'&nbsp;must&nbsp;normalize&nbsp;the&nbsp;group&nbsp;of&nbsp;`chi'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1953"></a>1953</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;H:=&nbsp;UnderlyingGroup(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1954"></a>1954</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;(&nbsp;IsSubset(&nbsp;G,&nbsp;H&nbsp;)&nbsp;and&nbsp;IsNormal(&nbsp;G,&nbsp;H&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1955"></a>1955</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;H>&nbsp;must&nbsp;be&nbsp;a&nbsp;normal&nbsp;subgroup&nbsp;in&nbsp;&lt;G>"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1956"></a>1956</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1957"></a>1957</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1958"></a>1958</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;For&nbsp;prime&nbsp;index,&nbsp;check&nbsp;the&nbsp;norm&nbsp;of&nbsp;the&nbsp;induced&nbsp;character.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1959"></a>1959</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(We&nbsp;get&nbsp;a&nbsp;decision&nbsp;if&nbsp;`chi'&nbsp;is&nbsp;irreducible.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1960"></a>1960</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;index:=&nbsp;Index(&nbsp;G,&nbsp;H&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1961"></a>1961</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsPrimeInt(&nbsp;index&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1962"></a>1962</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;induced:=&nbsp;InducedClassFunction(&nbsp;tbl,&nbsp;chi,&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1963"></a>1963</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ScalarProduct(&nbsp;CharacterTable(&nbsp;G&nbsp;),&nbsp;induced,&nbsp;induced&nbsp;)&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1964"></a>1964</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;H;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1965"></a>1965</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;ScalarProduct(&nbsp;tbl,&nbsp;chi,&nbsp;chi&nbsp;)&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1966"></a>1966</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1967"></a>1967</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1968"></a>1968</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1969"></a>1969</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1970"></a>1970</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;partition&nbsp;that&nbsp;must&nbsp;be&nbsp;stabilized.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1971"></a>1971</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;Why&nbsp;is&nbsp;`StabilizerPartition'&nbsp;no&nbsp;longer&nbsp;available?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1972"></a>1972</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;In&nbsp;GAP&nbsp;3.5,&nbsp;there&nbsp;was&nbsp;such&nbsp;a&nbsp;function.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1973"></a>1973</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(We&nbsp;need&nbsp;only&nbsp;those&nbsp;cells&nbsp;where&nbsp;`chi'&nbsp;really&nbsp;yields&nbsp;a&nbsp;refinement.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1974"></a>1974</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;global:=&nbsp;GlobalPartitionOfClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1975"></a>1975</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1976"></a>1976</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;part:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1977"></a>1977</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;p&nbsp;in&nbsp;global&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1978"></a>1978</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;only&nbsp;if&nbsp;`p'&nbsp;has&nbsp;length&nbsp;>&nbsp;1&nbsp;!
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1979"></a>1979</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val:=&nbsp;chi[&nbsp;p[1]&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1980"></a>1980</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAny(&nbsp;p,&nbsp;x&nbsp;->&nbsp;chi[x]&nbsp;&lt;>&nbsp;val&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1981"></a>1981</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1982"></a>1982</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;proper&nbsp;refinement&nbsp;will&nbsp;yield&nbsp;a&nbsp;condition.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1983"></a>1983</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1984"></a>1984</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1985"></a>1985</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;p&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1986"></a>1986</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos:=&nbsp;Position(&nbsp;values,&nbsp;chi[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1987"></a>1987</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pos&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1988"></a>1988</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;values,&nbsp;chi[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1989"></a>1989</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;new,&nbsp;[&nbsp;i&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1990"></a>1990</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1991"></a>1991</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;new[&nbsp;pos&nbsp;],&nbsp;i&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1992"></a>1992</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1993"></a>1993</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1994"></a>1994</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;part,&nbsp;new&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1995"></a>1995</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1996"></a>1996</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1997"></a>1997</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1998"></a>1998</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line1999"></a>1999</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;no&nbsp;refinement&nbsp;occurs,&nbsp;the&nbsp;character&nbsp;is&nbsp;necessarily&nbsp;invariant&nbsp;in&nbsp;&lt;G>.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2000"></a>2000</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;part&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2001"></a>2001</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2002"></a>2002</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2003"></a>2003</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2004"></a>2004</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;permutations&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;generators&nbsp;of&nbsp;`G'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2005"></a>2005</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;perms:=&nbsp;CorrespondingPermutations(&nbsp;tbl,&nbsp;chi,&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2006"></a>2006</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;permgrp:=&nbsp;GroupByGenerators(&nbsp;perms&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2007"></a>2007</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2008"></a>2008</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;`G'&nbsp;acts&nbsp;on&nbsp;the&nbsp;set&nbsp;of&nbsp;conjugacy&nbsp;classes&nbsp;given&nbsp;by&nbsp;each&nbsp;cell&nbsp;of&nbsp;`part'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2009"></a>2009</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;stab:=&nbsp;permgrp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2010"></a>2010</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;p&nbsp;in&nbsp;part&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2011"></a>2011</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stab:=&nbsp;Stabilizer(&nbsp;stab,&nbsp;p,&nbsp;OnSets&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2012"></a>2012</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;Better&nbsp;one&nbsp;step&nbsp;(partition&nbsp;stabilizer)&nbsp;??
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2013"></a>2013</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2014"></a>2014</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2015"></a>2015</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Construct&nbsp;and&nbsp;return&nbsp;the&nbsp;result.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2016"></a>2016</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;stab&nbsp;=&nbsp;permgrp&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2017"></a>2017</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2018"></a>2018</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2019"></a>2019</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;PreImagesSet(&nbsp;GroupHomomorphismByImages(&nbsp;G,&nbsp;permgrp,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2020"></a>2020</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GeneratorsOfGroup(&nbsp;G&nbsp;),&nbsp;perms&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2021"></a>2021</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stab&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2022"></a>2022</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2023"></a>2023</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2024"></a>2024</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2025"></a>2025</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2026"></a>2026</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2027"></a>2027</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2028"></a>2028</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;KernelOfCharacter(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;a&nbsp;class&nbsp;function
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2029"></a>2029</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2030"></a>2030</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;KernelOfCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2031"></a>2031</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2032"></a>2032</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2033"></a>2033</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chi&nbsp;->&nbsp;KernelOfCharacter(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2034"></a>2034</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2035"></a>2035</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2036"></a>2036</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;KernelOfCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2037"></a>2037</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;ordinary&nbsp;table,&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2038"></a>2038</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2039"></a>2039</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2040"></a>2040</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NormalSubgroupClasses(&nbsp;tbl,&nbsp;ClassPositionsOfKernel(&nbsp;chi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2041"></a>2041</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2042"></a>2042</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2043"></a>2043</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2044"></a>2044</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2045"></a>2045</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2046"></a>2046</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ClassPositionsOfKernel(&nbsp;&lt;char>&nbsp;)&nbsp;.&nbsp;&nbsp;the&nbsp;set&nbsp;of&nbsp;classes&nbsp;forming&nbsp;the&nbsp;kernel
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2047"></a>2047</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2048"></a>2048</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ClassPositionsOfKernel,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2049"></a>2049</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2050"></a>2050</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2051"></a>2051</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;char&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2052"></a>2052</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;degree;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2053"></a>2053</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;degree:=&nbsp;char[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2054"></a>2054</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Filtered(&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;char&nbsp;)&nbsp;],&nbsp;x&nbsp;->&nbsp;char[x]&nbsp;=&nbsp;degree&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2055"></a>2055</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2056"></a>2056</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2057"></a>2057</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2058"></a>2058</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2059"></a>2059</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2060"></a>2060</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;CycleStructureClass(&nbsp;[&lt;tbl>,&nbsp;]&lt;permchar>,&nbsp;&lt;class>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2061"></a>2061</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2062"></a>2062</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;For&nbsp;a&nbsp;permutation&nbsp;character&nbsp;$\pi$&nbsp;and&nbsp;an&nbsp;element&nbsp;$g$&nbsp;of&nbsp;$G$,&nbsp;the&nbsp;number
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2063"></a>2063</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;of&nbsp;$n$-cycles&nbsp;in&nbsp;the&nbsp;underlying&nbsp;permutation&nbsp;representation&nbsp;is&nbsp;equal&nbsp;to
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2064"></a>2064</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$\frac{1}{n}&nbsp;\sum_{r|n}&nbsp;\mu(\frac{n}{r})&nbsp;\pi(g^r)$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2065"></a>2065</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2066"></a>2066</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;CycleStructureClass,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2067"></a>2067</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function,&nbsp;and&nbsp;a&nbsp;class&nbsp;position",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2068"></a>2068</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2069"></a>2069</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;permchar,&nbsp;class&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2070"></a>2070</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;CycleStructureClass(&nbsp;UnderlyingCharacterTable(&nbsp;permchar&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2071"></a>2071</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;permchar&nbsp;),&nbsp;class&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2072"></a>2072</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2073"></a>2073</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2074"></a>2074</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;CycleStructureClass,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2075"></a>2075</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;ordinary&nbsp;table,&nbsp;a&nbsp;list,&nbsp;and&nbsp;a&nbsp;class&nbsp;position",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2076"></a>2076</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2077"></a>2077</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;permchar,&nbsp;class&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2078"></a>2078</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;n,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;element&nbsp;order&nbsp;of&nbsp;`class'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2079"></a>2079</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;divs,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;divisors&nbsp;of&nbsp;`n'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2080"></a>2080</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;d,&nbsp;j,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;`divs'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2081"></a>2081</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixed,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;numbers&nbsp;of&nbsp;fixed&nbsp;points
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2082"></a>2082</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cycstruct;&nbsp;&nbsp;&nbsp;#&nbsp;cycle&nbsp;structure,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2083"></a>2083</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2084"></a>2084</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;numbers&nbsp;of&nbsp;fixed&nbsp;points&nbsp;of&nbsp;powers.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2085"></a>2085</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;OrdersClassRepresentatives(&nbsp;tbl&nbsp;)[&nbsp;class&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2086"></a>2086</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;divs:=&nbsp;DivisorsInt(&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2087"></a>2087</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fixed:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2088"></a>2088</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;divs&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2089"></a>2089</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2090"></a>2090</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;number&nbsp;of&nbsp;cycles&nbsp;of&nbsp;the&nbsp;element&nbsp;of&nbsp;order&nbsp;`n&nbsp;/&nbsp;d'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2091"></a>2091</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d:=&nbsp;divs[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2092"></a>2092</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixed[d]:=&nbsp;permchar[&nbsp;PowerMap(&nbsp;tbl,&nbsp;d,&nbsp;class&nbsp;)&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2093"></a>2093</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;i-1&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2094"></a>2094</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;d&nbsp;mod&nbsp;divs[j]&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2095"></a>2095</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2096"></a>2096</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Subtract&nbsp;the&nbsp;number&nbsp;of&nbsp;fixed&nbsp;points&nbsp;with&nbsp;stabilizer&nbsp;exactly
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2097"></a>2097</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;of&nbsp;order&nbsp;`n&nbsp;/&nbsp;divs[j]'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2098"></a>2098</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fixed[d]:=&nbsp;fixed[d]&nbsp;-&nbsp;fixed[&nbsp;divs[j]&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2099"></a>2099</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2100"></a>2100</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2101"></a>2101</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2102"></a>2102</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2103"></a>2103</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2104"></a>2104</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2105"></a>2105</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Convert&nbsp;these&nbsp;numbers&nbsp;into&nbsp;numbers&nbsp;of&nbsp;cycles.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2106"></a>2106</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;cycstruct:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2107"></a>2107</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;divs&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2108"></a>2108</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fixed[i]&nbsp;&lt;>&nbsp;0&nbsp;and&nbsp;1&nbsp;&lt;&nbsp;i&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2109"></a>2109</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cycstruct[&nbsp;i-1&nbsp;]:=&nbsp;fixed[i]&nbsp;/&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2110"></a>2110</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2111"></a>2111</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2112"></a>2112</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2113"></a>2113</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;cycle&nbsp;structure.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2114"></a>2114</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;cycstruct;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2115"></a>2115</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2116"></a>2116</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2117"></a>2117</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2118"></a>2118</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2119"></a>2119</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2120"></a>2120</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;IsTransitive(&nbsp;[&lt;tbl>,&nbsp;]&lt;permchar>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2121"></a>2121</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2122"></a>2122</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsTransitive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2123"></a>2123</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2124"></a>2124</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2125"></a>2125</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;permchar&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2126"></a>2126</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2127"></a>2127</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;permchar&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2128"></a>2128</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ValuesOfClassFunction(&nbsp;permchar&nbsp;)&nbsp;*&nbsp;SizesConjugacyClasses(&nbsp;tbl&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2129"></a>2129</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Size(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2130"></a>2130</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2131"></a>2131</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2132"></a>2132</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;IsTransitive,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2133"></a>2133</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;ordinary&nbsp;table&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2134"></a>2134</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2135"></a>2135</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;permchar&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2136"></a>2136</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;permchar&nbsp;*&nbsp;SizesConjugacyClasses(&nbsp;tbl&nbsp;)&nbsp;=&nbsp;Size(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2137"></a>2137</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2138"></a>2138</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2139"></a>2139</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2140"></a>2140</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2141"></a>2141</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2142"></a>2142</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Transitivity(&nbsp;[&lt;tbl>,&nbsp;]&lt;permchar>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2143"></a>2143</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2144"></a>2144</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;The&nbsp;transitivity&nbsp;of&nbsp;a&nbsp;permutation&nbsp;character&nbsp;$\pi$&nbsp;corresponding&nbsp;to&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2145"></a>2145</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;action&nbsp;on&nbsp;the&nbsp;$G$-set&nbsp;$\Omega$&nbsp;is&nbsp;computed&nbsp;as&nbsp;follows
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2146"></a>2146</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;(cf.~\cite{Hup98},&nbsp;Theorem~11.8).
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2147"></a>2147</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Let&nbsp;$\Omega_k&nbsp;=&nbsp;\{&nbsp;(\omega_1,&nbsp;\omega_2,&nbsp;\ldots,&nbsp;\omega_k)&nbsp;\mid
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2148"></a>2148</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;\omega_i&nbsp;\in&nbsp;\Omega,&nbsp;\omega_i&nbsp;{\rm\&nbsp;pairwise&nbsp;distinct}&nbsp;\}$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2149"></a>2149</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Then&nbsp;$\Omega_k$&nbsp;is&nbsp;a&nbsp;$G$-set&nbsp;w.r.t.~componentwise&nbsp;action,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2150"></a>2150</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;and&nbsp;the&nbsp;permutation&nbsp;character&nbsp;$\pi_k$&nbsp;is&nbsp;given&nbsp;by
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2151"></a>2151</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$\pi_k(g)&nbsp;=&nbsp;\pi(g)&nbsp;(\pi(g)-1)&nbsp;(\pi(g)-2)&nbsp;\cdots&nbsp;(\pi(g)-k+1)$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2152"></a>2152</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$\Omega$&nbsp;is&nbsp;$k$-transitive&nbsp;if&nbsp;and&nbsp;only&nbsp;if&nbsp;$\Omega_k$&nbsp;is&nbsp;transitive.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2153"></a>2153</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2154"></a>2154</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Transitivity,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2155"></a>2155</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2156"></a>2156</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2157"></a>2157</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pi&nbsp;->&nbsp;Transitivity(&nbsp;UnderlyingCharacterTable(&nbsp;pi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2158"></a>2158</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;pi&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2159"></a>2159</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2160"></a>2160</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Transitivity,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2161"></a>2161</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;ordinary&nbsp;table,&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2162"></a>2162</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2163"></a>2163</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;values&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2164"></a>2164</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;order,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2165"></a>2165</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;classes,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2166"></a>2166</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2167"></a>2167</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2168"></a>2168</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pik;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2169"></a>2169</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2170"></a>2170</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Check&nbsp;the&nbsp;argument.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2171"></a>2171</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;ForAll(&nbsp;values,&nbsp;IsInt&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2172"></a>2172</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;values>&nbsp;is&nbsp;not&nbsp;integral"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2173"></a>2173</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2174"></a>2174</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2175"></a>2175</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;order:=&nbsp;Size(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2176"></a>2176</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;classes:=&nbsp;SizesConjugacyClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2177"></a>2177</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;Length(&nbsp;classes&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2178"></a>2178</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2179"></a>2179</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;k:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2180"></a>2180</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pik:=&nbsp;values;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2181"></a>2181</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;pik&nbsp;*&nbsp;classes&nbsp;=&nbsp;order&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2182"></a>2182</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k:=&nbsp;k&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2183"></a>2183</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pik:=&nbsp;List(&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;],&nbsp;x&nbsp;->&nbsp;pik[x]&nbsp;*&nbsp;(&nbsp;values[x]&nbsp;-&nbsp;k&nbsp;+&nbsp;1&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2184"></a>2184</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2185"></a>2185</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2186"></a>2186</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;k&nbsp;-&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2187"></a>2187</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2188"></a>2188</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2189"></a>2189</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2190"></a>2190</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2191"></a>2191</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2192"></a>2192</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;CentralCharacter(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;for&nbsp;a&nbsp;character
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2193"></a>2193</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2194"></a>2194</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;CentralCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2195"></a>2195</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2196"></a>2196</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2197"></a>2197</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chi&nbsp;->&nbsp;CentralCharacter(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2198"></a>2198</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2199"></a>2199</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2200"></a>2200</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;CentralCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2201"></a>2201</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;an&nbsp;ordinary&nbsp;table,&nbsp;and&nbsp;a&nbsp;homogeneous&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2202"></a>2202</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2203"></a>2203</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;char&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2204"></a>2204</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;classes;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2205"></a>2205</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;classes:=&nbsp;SizesConjugacyClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2206"></a>2206</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;classes&nbsp;)&nbsp;&lt;>&nbsp;Length(&nbsp;char&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2207"></a>2207</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;classes>&nbsp;and&nbsp;&lt;char>&nbsp;must&nbsp;have&nbsp;same&nbsp;length"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2208"></a>2208</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2209"></a>2209</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunction(&nbsp;tbl,&nbsp;List(&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;char&nbsp;)&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2210"></a>2210</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;->&nbsp;classes[x]&nbsp;*&nbsp;char[x]&nbsp;/&nbsp;char[1]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2211"></a>2211</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2212"></a>2212</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2213"></a>2213</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2214"></a>2214</td><td></td><td></td><td></td><td><span><tt>##############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2215"></a>2215</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2216"></a>2216</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;DeterminantOfCharacter(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2217"></a>2217</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2218"></a>2218</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;The&nbsp;determinant&nbsp;is&nbsp;computed&nbsp;as&nbsp;follows.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2219"></a>2219</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Diagonalize&nbsp;the&nbsp;matrix;&nbsp;the&nbsp;determinant&nbsp;is&nbsp;the&nbsp;product&nbsp;of&nbsp;the&nbsp;diagonal
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2220"></a>2220</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;entries,&nbsp;which&nbsp;can&nbsp;be&nbsp;computed&nbsp;by&nbsp;`Eigenvalues'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2221"></a>2221</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2222"></a>2222</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Note&nbsp;that&nbsp;the&nbsp;determinant&nbsp;of&nbsp;a&nbsp;virtual&nbsp;character&nbsp;$\chi&nbsp;-&nbsp;\psi$&nbsp;is
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2223"></a>2223</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;well-defined&nbsp;as&nbsp;the&nbsp;quotient&nbsp;of&nbsp;the&nbsp;determinants&nbsp;of&nbsp;the&nbsp;characters&nbsp;$\chi$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2224"></a>2224</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;and&nbsp;$\psi$,&nbsp;since&nbsp;the&nbsp;determinant&nbsp;of&nbsp;a&nbsp;sum&nbsp;of&nbsp;characters&nbsp;is&nbsp;the&nbsp;product
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2225"></a>2225</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;of&nbsp;the&nbsp;determinants&nbsp;of&nbsp;the&nbsp;summands.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2226"></a>2226</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2227"></a>2227</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DeterminantOfCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2228"></a>2228</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2229"></a>2229</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2230"></a>2230</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2231"></a>2231</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;det;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2232"></a>2232</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2233"></a>2233</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;chi[1]&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2234"></a>2234</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;chi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2235"></a>2235</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2236"></a>2236</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;det:=&nbsp;DeterminantOfCharacter(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2237"></a>2237</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2238"></a>2238</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasIsVirtualCharacter(&nbsp;chi&nbsp;)&nbsp;and&nbsp;IsVirtualCharacter(&nbsp;chi&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2239"></a>2239</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetIsCharacter(&nbsp;det,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2240"></a>2240</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2241"></a>2241</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;det;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2242"></a>2242</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2243"></a>2243</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2244"></a>2244</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;DeterminantOfCharacter,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2245"></a>2245</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;nearly&nbsp;character&nbsp;table,&nbsp;and&nbsp;a&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2246"></a>2246</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2247"></a>2247</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chi&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2248"></a>2248</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;det,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;result&nbsp;list
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2249"></a>2249</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ev,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;eigenvalues
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2250"></a>2250</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ord,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;element&nbsp;order
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2251"></a>2251</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;classes
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2252"></a>2252</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2253"></a>2253</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;chi[1]&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2254"></a>2254</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunction(&nbsp;tbl,&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2255"></a>2255</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2256"></a>2256</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2257"></a>2257</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;det:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2258"></a>2258</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2259"></a>2259</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;chi&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2260"></a>2260</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2261"></a>2261</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ev:=&nbsp;EigenvaluesChar(&nbsp;tbl,&nbsp;chi,&nbsp;i&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2262"></a>2262</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ord:=&nbsp;Length(&nbsp;ev&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2263"></a>2263</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2264"></a>2264</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;determinant&nbsp;is&nbsp;'E(ord)'&nbsp;to&nbsp;the&nbsp;'exp'-th&nbsp;power,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2265"></a>2265</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;where&nbsp;$'exp'&nbsp;=&nbsp;\sum_{j=1}^{ord}&nbsp;j&nbsp;'ev'[j]$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2266"></a>2266</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(Note&nbsp;that&nbsp;the&nbsp;$j$-th&nbsp;entry&nbsp;in&nbsp;'ev'&nbsp;is&nbsp;the&nbsp;multiplicity&nbsp;of
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2267"></a>2267</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;'E(ord)^j'&nbsp;as&nbsp;eigenvalue.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2268"></a>2268</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;det[i]:=&nbsp;E(ord)&nbsp;^&nbsp;(&nbsp;[&nbsp;1&nbsp;..&nbsp;ord&nbsp;]&nbsp;*&nbsp;ev&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2269"></a>2269</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2270"></a>2270</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2271"></a>2271</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2272"></a>2272</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunction(&nbsp;tbl,&nbsp;det&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2273"></a>2273</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2274"></a>2274</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2275"></a>2275</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2276"></a>2276</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2277"></a>2277</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2278"></a>2278</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;EigenvaluesChar(&nbsp;[&lt;tbl>,&nbsp;]&lt;char>,&nbsp;&lt;class>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2279"></a>2279</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2280"></a>2280</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;The&nbsp;eigenvalues&nbsp;can&nbsp;be&nbsp;computed&nbsp;from&nbsp;the&nbsp;values&nbsp;of&nbsp;the&nbsp;character
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2281"></a>2281</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&lt;char>&nbsp;together&nbsp;with&nbsp;the&nbsp;power&nbsp;maps&nbsp;up&nbsp;to&nbsp;the&nbsp;order&nbsp;of&nbsp;elements&nbsp;in&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2282"></a>2282</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;&lt;class>-th&nbsp;class&nbsp;of&nbsp;&lt;tbl>,&nbsp;see&nbsp;page~231&nbsp;in~\cite{NPP84};
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2283"></a>2283</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;note&nbsp;that&nbsp;the&nbsp;multiplicity&nbsp;of&nbsp;a&nbsp;given&nbsp;$n$-th&nbsp;root&nbsp;of&nbsp;unity&nbsp;$\zeta$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2284"></a>2284</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;as&nbsp;an&nbsp;eigenvalue&nbsp;of&nbsp;$M$&nbsp;is&nbsp;equal&nbsp;to&nbsp;the&nbsp;multiplicity&nbsp;of&nbsp;the&nbsp;irreducible
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2285"></a>2285</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;character&nbsp;of&nbsp;the&nbsp;cyclic&nbsp;group&nbsp;spanned&nbsp;by&nbsp;$g$&nbsp;that&nbsp;maps&nbsp;$g$&nbsp;to&nbsp;$\zeta$,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2286"></a>2286</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;and&nbsp;this&nbsp;can&nbsp;be&nbsp;computed&nbsp;from&nbsp;the&nbsp;restriction&nbsp;of&nbsp;&lt;char>&nbsp;to&nbsp;this&nbsp;cyclic
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2287"></a>2287</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;subgroup&nbsp;or,&nbsp;equivalently,&nbsp;by&nbsp;the&nbsp;power&nbsp;maps&nbsp;&nbsp;of&nbsp;&lt;tbl>.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2288"></a>2288</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2289"></a>2289</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;>&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;know&nbsp;if&nbsp;there&nbsp;is&nbsp;a&nbsp;quickier&nbsp;way&nbsp;to&nbsp;compute&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2290"></a>2290</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;>&nbsp;characteristic&nbsp;polynomial&nbsp;f=f(G)&nbsp;of&nbsp;a&nbsp;representative&nbsp;G
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2291"></a>2291</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;>&nbsp;of&nbsp;a&nbsp;conjugacy&nbsp;class&nbsp;mentioned
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2292"></a>2292</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;>&nbsp;above,&nbsp;than&nbsp;using&nbsp;Eigenvalues().
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2293"></a>2293</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;>&nbsp;(The&nbsp;latter&nbsp;function&nbsp;involves&nbsp;using&nbsp;algebraic&nbsp;numbers,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2294"></a>2294</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;>&nbsp;whereas&nbsp;&nbsp;it&nbsp;might&nbsp;happen
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2295"></a>2295</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;>&nbsp;that&nbsp;f&nbsp;has&nbsp;rational&nbsp;or&nbsp;integer&nbsp;coefficients&nbsp;,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2296"></a>2296</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;>&nbsp;i.e.&nbsp;all&nbsp;the&nbsp;irrationalies&nbsp;cancel)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2297"></a>2297</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2298"></a>2298</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;For&nbsp;example,&nbsp;if&nbsp;the&nbsp;character&nbsp;values&nbsp;in&nbsp;question&nbsp;are&nbsp;rational
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2299"></a>2299</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;one&nbsp;can&nbsp;use&nbsp;Galois&nbsp;sums&nbsp;of&nbsp;the&nbsp;irreducible&nbsp;characters&nbsp;of&nbsp;the&nbsp;cyclic
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2300"></a>2300</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;subgroup&nbsp;instead&nbsp;of&nbsp;the&nbsp;irreducible&nbsp;characters&nbsp;when&nbsp;computing
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2301"></a>2301</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;scalar&nbsp;products,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2302"></a>2302</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;because&nbsp;the&nbsp;multiplicities&nbsp;of&nbsp;Galois&nbsp;conjugate&nbsp;eigenvalues&nbsp;are&nbsp;equal
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2303"></a>2303</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;in&nbsp;such&nbsp;a&nbsp;case.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2304"></a>2304</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;This&nbsp;avoids&nbsp;computations&nbsp;with&nbsp;non-rational&nbsp;numbers.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2305"></a>2305</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2306"></a>2306</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;EigenvaluesChar,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2307"></a>2307</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function&nbsp;and&nbsp;a&nbsp;positive&nbsp;integer",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2308"></a>2308</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2309"></a>2309</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;class&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2310"></a>2310</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;EigenvaluesChar(&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2311"></a>2311</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;),&nbsp;class&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2312"></a>2312</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2313"></a>2313</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2314"></a>2314</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;EigenvaluesChar,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2315"></a>2315</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table&nbsp;and&nbsp;a&nbsp;hom.&nbsp;list,&nbsp;and&nbsp;a&nbsp;pos.",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2316"></a>2316</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2317"></a>2317</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;char,&nbsp;class&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2318"></a>2318</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,&nbsp;j,&nbsp;n,&nbsp;powers,&nbsp;eigen,&nbsp;e,&nbsp;val;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2319"></a>2319</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2320"></a>2320</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;OrdersClassRepresentatives(&nbsp;tbl&nbsp;)[&nbsp;class&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2321"></a>2321</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;then&nbsp;return&nbsp;[&nbsp;char[&nbsp;class&nbsp;]&nbsp;];&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2322"></a>2322</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2323"></a>2323</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;necessary&nbsp;power&nbsp;maps&nbsp;and&nbsp;the&nbsp;restricted&nbsp;character.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2324"></a>2324</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;powers:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2325"></a>2325</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;powers[n]:=&nbsp;char[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2326"></a>2326</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;n-1&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2327"></a>2327</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsBound(&nbsp;powers[i]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2328"></a>2328</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2329"></a>2329</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;necessarily&nbsp;'i'&nbsp;divides&nbsp;'n',&nbsp;since&nbsp;'i/Gcd(n,i)'&nbsp;is&nbsp;invertible
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2330"></a>2330</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;mod&nbsp;'n',&nbsp;and&nbsp;thus&nbsp;powering&nbsp;with&nbsp;'i'&nbsp;is&nbsp;Galois&nbsp;conjugate&nbsp;to
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2331"></a>2331</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;powering&nbsp;with&nbsp;'Gcd(n,i)'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2332"></a>2332</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;powers[i]:=&nbsp;char[&nbsp;PowerMap(&nbsp;tbl,&nbsp;i,&nbsp;class&nbsp;)&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2333"></a>2333</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;better&nbsp;approach:
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2334"></a>2334</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;only&nbsp;write&nbsp;down&nbsp;values&nbsp;for&nbsp;one&nbsp;representative&nbsp;of&nbsp;each
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2335"></a>2335</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;Galois&nbsp;family,&nbsp;and&nbsp;compute&nbsp;traces;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2336"></a>2336</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;for&nbsp;rational&nbsp;characters,&nbsp;this&nbsp;avoids&nbsp;computation&nbsp;with
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2337"></a>2337</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;non-rational&nbsp;values&nbsp;at&nbsp;all.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2338"></a>2338</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;(how&nbsp;much&nbsp;does&nbsp;this&nbsp;help?)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2339"></a>2339</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;PrimeResidues(&nbsp;n/i&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2340"></a>2340</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2341"></a>2341</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Note&nbsp;that&nbsp;the&nbsp;position&nbsp;cannot&nbsp;be&nbsp;0.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2342"></a>2342</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;powers[&nbsp;(&nbsp;i*j&nbsp;)&nbsp;mod&nbsp;n&nbsp;]:=&nbsp;GaloisCyc(&nbsp;powers[i],&nbsp;j&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2343"></a>2343</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2344"></a>2344</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2345"></a>2345</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2346"></a>2346</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2347"></a>2347</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;compute&nbsp;the&nbsp;scalar&nbsp;products&nbsp;of&nbsp;the&nbsp;characters&nbsp;given&nbsp;by&nbsp;'E(n)->E(n)^i'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2348"></a>2348</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;with&nbsp;the&nbsp;restriction&nbsp;of&nbsp;&lt;char>&nbsp;to&nbsp;the&nbsp;cyclic&nbsp;group&nbsp;generated&nbsp;by
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2349"></a>2349</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&lt;class>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2350"></a>2350</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;eigen:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2351"></a>2351</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2352"></a>2352</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e:=&nbsp;E(n)^(-i);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2353"></a>2353</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val:=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2354"></a>2354</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;]&nbsp;do&nbsp;val:=&nbsp;val&nbsp;+&nbsp;e^j&nbsp;*&nbsp;powers[j];&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2355"></a>2355</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eigen[i]:=&nbsp;val&nbsp;/&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2356"></a>2356</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2357"></a>2357</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2358"></a>2358</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;eigen;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2359"></a>2359</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2360"></a>2360</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2361"></a>2361</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2362"></a>2362</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2363"></a>2363</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2364"></a>2364</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Tensored(&nbsp;&lt;chars1>,&nbsp;&lt;chars2>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;two&nbsp;lists&nbsp;of&nbsp;class&nbsp;functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2365"></a>2365</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2366"></a>2366</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Tensored,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2367"></a>2367</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"method&nbsp;for&nbsp;two&nbsp;homogeneous&nbsp;lists",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2368"></a>2368</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2369"></a>2369</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chars1,&nbsp;chars2&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2370"></a>2370</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,&nbsp;j,&nbsp;k,&nbsp;nccl,&nbsp;tensored,&nbsp;single;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2371"></a>2371</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2372"></a>2372</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;chars1&nbsp;)&nbsp;or&nbsp;IsEmpty(&nbsp;chars2&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2373"></a>2373</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2374"></a>2374</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2375"></a>2375</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2376"></a>2376</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nccl:=&nbsp;Length(&nbsp;chars1[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2377"></a>2377</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tensored:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2378"></a>2378</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2379"></a>2379</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;chars1&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2380"></a>2380</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;chars2&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2381"></a>2381</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2382"></a>2382</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2383"></a>2383</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;nccl&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2384"></a>2384</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single[k]:=&nbsp;i[k]&nbsp;*&nbsp;j[k];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2385"></a>2385</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2386"></a>2386</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2387"></a>2387</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;HasIsCharacter(&nbsp;i&nbsp;)&nbsp;and&nbsp;IsCharacter(&nbsp;i&nbsp;)&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2388"></a>2388</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HasIsCharacter(&nbsp;j&nbsp;)&nbsp;and&nbsp;IsCharacter(&nbsp;j&nbsp;)&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2389"></a>2389</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UnderlyingCharacterTable(&nbsp;i&nbsp;)&nbsp;=&nbsp;UnderlyingCharacterTable(&nbsp;j&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2390"></a>2390</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single:=&nbsp;Character(&nbsp;UnderlyingCharacterTable(&nbsp;i&nbsp;),&nbsp;single&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2391"></a>2391</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;HasIsVirtualCharacter(&nbsp;i&nbsp;)&nbsp;and&nbsp;IsVirtualCharacter(&nbsp;i&nbsp;)&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2392"></a>2392</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HasIsVirtualCharacter(&nbsp;j&nbsp;)&nbsp;and&nbsp;IsVirtualCharacter(&nbsp;j&nbsp;)&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2393"></a>2393</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UnderlyingCharacterTable(&nbsp;i&nbsp;)&nbsp;=&nbsp;UnderlyingCharacterTable(&nbsp;j&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2394"></a>2394</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single:=&nbsp;VirtualCharacter(&nbsp;UnderlyingCharacterTable(&nbsp;i&nbsp;),&nbsp;single&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2395"></a>2395</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsClassFunction(&nbsp;i&nbsp;)&nbsp;and&nbsp;IsClassFunction(&nbsp;j&nbsp;)&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2396"></a>2396</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UnderlyingCharacterTable(&nbsp;i&nbsp;)&nbsp;=&nbsp;UnderlyingCharacterTable(&nbsp;j&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2397"></a>2397</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single:=&nbsp;ClassFunction(&nbsp;UnderlyingCharacterTable(&nbsp;i&nbsp;),&nbsp;single&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2398"></a>2398</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2399"></a>2399</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2400"></a>2400</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;tensored,&nbsp;single&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2401"></a>2401</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2402"></a>2402</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2403"></a>2403</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2404"></a>2404</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2405"></a>2405</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;tensored;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2406"></a>2406</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2407"></a>2407</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2408"></a>2408</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2409"></a>2409</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2410"></a>2410</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2411"></a>2411</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;9.&nbsp;Restricted&nbsp;and&nbsp;Induced&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2412"></a>2412</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2413"></a>2413</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2414"></a>2414</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2415"></a>2415</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2416"></a>2416</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2417"></a>2417</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;RestrictedClassFunction(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>,&nbsp;&lt;H>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2418"></a>2418</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;RestrictedClassFunction(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>,&nbsp;&lt;hom>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2419"></a>2419</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;RestrictedClassFunction(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>,&nbsp;&lt;subtbl>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2420"></a>2420</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2421"></a>2421</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RestrictedClassFunction,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2422"></a>2422</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function,&nbsp;and&nbsp;a&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2423"></a>2423</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2424"></a>2424</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;H&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2425"></a>2425</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;subtbl,&nbsp;tbl,&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2426"></a>2426</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2427"></a>2427</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;subtbl:=&nbsp;OrdinaryCharacterTable(&nbsp;H&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2428"></a>2428</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2429"></a>2429</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2430"></a>2430</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subtbl:=&nbsp;subtbl&nbsp;mod&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2431"></a>2431</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2432"></a>2432</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;subtbl,&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2433"></a>2433</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fus&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2434"></a>2434</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"no&nbsp;fusion&nbsp;from&nbsp;&lt;subtbl>&nbsp;to&nbsp;&lt;tbl>"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2435"></a>2435</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2436"></a>2436</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunctionSameType(&nbsp;subtbl,&nbsp;chi,&nbsp;chi{&nbsp;fus&nbsp;}&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2437"></a>2437</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2438"></a>2438</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2439"></a>2439</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RestrictedClassFunction,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2440"></a>2440</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table,&nbsp;a&nbsp;homogeneous&nbsp;list,&nbsp;and&nbsp;a&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2441"></a>2441</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNearlyCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2442"></a>2442</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chi,&nbsp;H&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2443"></a>2443</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;subtbl,&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2444"></a>2444</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2445"></a>2445</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;subtbl:=&nbsp;OrdinaryCharacterTable(&nbsp;H&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2446"></a>2446</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2447"></a>2447</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subtbl:=&nbsp;subtbl&nbsp;mod&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2448"></a>2448</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2449"></a>2449</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;subtbl,&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2450"></a>2450</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fus&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2451"></a>2451</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"no&nbsp;fusion&nbsp;from&nbsp;&lt;subtbl>&nbsp;to&nbsp;&lt;tbl>"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2452"></a>2452</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2453"></a>2453</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunction(&nbsp;subtbl,&nbsp;chi{&nbsp;fus&nbsp;}&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2454"></a>2454</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2455"></a>2455</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2456"></a>2456</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RestrictedClassFunction,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2457"></a>2457</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function&nbsp;and&nbsp;a&nbsp;group&nbsp;homomorphism",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2458"></a>2458</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsGeneralMapping&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2459"></a>2459</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;hom&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2460"></a>2460</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;subtbl,&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2461"></a>2461</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2462"></a>2462</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;subtbl:=&nbsp;CharacterTable(&nbsp;PreImage(&nbsp;hom&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2463"></a>2463</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2464"></a>2464</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2465"></a>2465</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subtbl:=&nbsp;subtbl&nbsp;mod&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2466"></a>2466</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2467"></a>2467</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;hom,&nbsp;subtbl,&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2468"></a>2468</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fus&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2469"></a>2469</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"no&nbsp;fusion&nbsp;from&nbsp;&lt;subtbl>&nbsp;to&nbsp;&lt;tbl>"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2470"></a>2470</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2471"></a>2471</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunctionSameType(&nbsp;subtbl,&nbsp;chi,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2472"></a>2472</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;){&nbsp;fus&nbsp;}&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2473"></a>2473</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2474"></a>2474</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2475"></a>2475</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RestrictedClassFunction,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2476"></a>2476</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table,&nbsp;a&nbsp;homogeneous&nbsp;list,&nbsp;and&nbsp;a&nbsp;group&nbsp;homomorphism",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2477"></a>2477</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNearlyCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsGeneralMapping&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2478"></a>2478</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chi,&nbsp;hom&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2479"></a>2479</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;subtbl,&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2480"></a>2480</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2481"></a>2481</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;subtbl:=&nbsp;CharacterTable(&nbsp;PreImage(&nbsp;hom&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2482"></a>2482</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2483"></a>2483</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subtbl:=&nbsp;subtbl&nbsp;mod&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2484"></a>2484</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2485"></a>2485</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;hom,&nbsp;subtbl,&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2486"></a>2486</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fus&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2487"></a>2487</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"no&nbsp;fusion&nbsp;from&nbsp;&lt;subtbl>&nbsp;to&nbsp;&lt;tbl>"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2488"></a>2488</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2489"></a>2489</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunction(&nbsp;subtbl,&nbsp;chi{&nbsp;fus&nbsp;}&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2490"></a>2490</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2491"></a>2491</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2492"></a>2492</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RestrictedClassFunction,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2493"></a>2493</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function&nbsp;and&nbsp;nearly&nbsp;character&nbsp;table",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2494"></a>2494</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsNearlyCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2495"></a>2495</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;subtbl&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2496"></a>2496</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2497"></a>2497</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2498"></a>2498</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;subtbl,&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2499"></a>2499</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fus&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2500"></a>2500</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"class&nbsp;fusion&nbsp;not&nbsp;available"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2501"></a>2501</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2502"></a>2502</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunctionSameType(&nbsp;subtbl,&nbsp;chi,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2503"></a>2503</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;){&nbsp;fus&nbsp;}&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2504"></a>2504</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2505"></a>2505</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2506"></a>2506</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RestrictedClassFunction,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2507"></a>2507</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table,&nbsp;a&nbsp;homogeneous&nbsp;list,&nbsp;and&nbsp;a&nbsp;character&nbsp;table",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2508"></a>2508</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNearlyCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsNearlyCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2509"></a>2509</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chi,&nbsp;subtbl&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2510"></a>2510</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2511"></a>2511</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2512"></a>2512</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;subtbl,&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2513"></a>2513</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fus&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2514"></a>2514</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"class&nbsp;fusion&nbsp;not&nbsp;available"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2515"></a>2515</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2516"></a>2516</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunction(&nbsp;subtbl,&nbsp;chi{&nbsp;fus&nbsp;}&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2517"></a>2517</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2518"></a>2518</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2519"></a>2519</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2520"></a>2520</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2521"></a>2521</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2522"></a>2522</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;RestrictedClassFunctions(&nbsp;[&lt;tbl>,&nbsp;]&lt;chars>,&nbsp;&lt;H>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2523"></a>2523</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;RestrictedClassFunctions(&nbsp;[&lt;tbl>,&nbsp;]&lt;chars>,&nbsp;&lt;hom>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2524"></a>2524</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;RestrictedClassFunctions(&nbsp;[&lt;tbl>,&nbsp;]&lt;chars>,&nbsp;&lt;subtbl>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2525"></a>2525</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2526"></a>2526</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RestrictedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2527"></a>2527</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;list&nbsp;and&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2528"></a>2528</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2529"></a>2529</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chars,&nbsp;H&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2530"></a>2530</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;chars,&nbsp;chi&nbsp;->&nbsp;RestrictedClassFunction(&nbsp;chi,&nbsp;H&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2531"></a>2531</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2532"></a>2532</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2533"></a>2533</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RestrictedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2534"></a>2534</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;list&nbsp;and&nbsp;group&nbsp;homomorphism",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2535"></a>2535</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList,&nbsp;IsGeneralMapping&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2536"></a>2536</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chars,&nbsp;hom&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2537"></a>2537</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;chars,&nbsp;chi&nbsp;->&nbsp;RestrictedClassFunction(&nbsp;chi,&nbsp;hom&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2538"></a>2538</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2539"></a>2539</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2540"></a>2540</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RestrictedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2541"></a>2541</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;list&nbsp;and&nbsp;character&nbsp;table",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2542"></a>2542</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList,&nbsp;IsCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2543"></a>2543</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chars,&nbsp;subtbl&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2544"></a>2544</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;chars,&nbsp;chi&nbsp;->&nbsp;RestrictedClassFunction(&nbsp;chi,&nbsp;subtbl&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2545"></a>2545</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2546"></a>2546</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2547"></a>2547</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RestrictedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2548"></a>2548</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table,&nbsp;a&nbsp;list,&nbsp;and&nbsp;a&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2549"></a>2549</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsList,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2550"></a>2550</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chars,&nbsp;H&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2551"></a>2551</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;subtbl,&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2552"></a>2552</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2553"></a>2553</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;subtbl:=&nbsp;OrdinaryCharacterTable(&nbsp;H&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2554"></a>2554</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2555"></a>2555</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subtbl:=&nbsp;subtbl&nbsp;mod&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2556"></a>2556</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2557"></a>2557</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;subtbl,&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2558"></a>2558</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fus&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2559"></a>2559</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"no&nbsp;fusion&nbsp;from&nbsp;&lt;subtbl>&nbsp;to&nbsp;&lt;tbl>"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2560"></a>2560</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2561"></a>2561</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;chars,&nbsp;chi&nbsp;->&nbsp;ClassFunctionSameType(&nbsp;subtbl,&nbsp;chi,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2562"></a>2562</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;){&nbsp;fus&nbsp;}&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2563"></a>2563</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2564"></a>2564</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2565"></a>2565</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RestrictedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2566"></a>2566</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table,&nbsp;a&nbsp;list,&nbsp;and&nbsp;a&nbsp;group&nbsp;homomorphism",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2567"></a>2567</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsList,&nbsp;IsGeneralMapping&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2568"></a>2568</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chars,&nbsp;hom&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2569"></a>2569</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;subtbl,&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2570"></a>2570</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2571"></a>2571</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;subtbl:=&nbsp;CharacterTable(&nbsp;PreImage(&nbsp;hom&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2572"></a>2572</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2573"></a>2573</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subtbl:=&nbsp;subtbl&nbsp;mod&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2574"></a>2574</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2575"></a>2575</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;hom,&nbsp;subtbl,&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2576"></a>2576</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fus&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2577"></a>2577</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"class&nbsp;fusion&nbsp;not&nbsp;available"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2578"></a>2578</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2579"></a>2579</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;chars,&nbsp;chi&nbsp;->&nbsp;ClassFunctionSameType(&nbsp;subtbl,&nbsp;chi,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2580"></a>2580</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;){&nbsp;fus&nbsp;}&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2581"></a>2581</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2582"></a>2582</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2583"></a>2583</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;RestrictedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2584"></a>2584</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table,&nbsp;a&nbsp;list,&nbsp;and&nbsp;a&nbsp;character&nbsp;table",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2585"></a>2585</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsList,&nbsp;IsCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2586"></a>2586</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chars,&nbsp;subtbl&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2587"></a>2587</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2588"></a>2588</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2589"></a>2589</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;subtbl,&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2590"></a>2590</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fus&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2591"></a>2591</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"class&nbsp;fusion&nbsp;not&nbsp;available"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2592"></a>2592</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2593"></a>2593</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;chars,&nbsp;chi&nbsp;->&nbsp;ClassFunctionSameType(&nbsp;subtbl,&nbsp;chi,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2594"></a>2594</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValuesOfClassFunction(&nbsp;chi&nbsp;){&nbsp;fus&nbsp;}&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2595"></a>2595</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2596"></a>2596</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2597"></a>2597</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2598"></a>2598</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2599"></a>2599</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2600"></a>2600</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Restricted(&nbsp;&lt;tbl>,&nbsp;&lt;subtbl>,&nbsp;&lt;chars>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2601"></a>2601</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Restricted(&nbsp;&lt;tbl>,&nbsp;&lt;subtbl>,&nbsp;&lt;chars>,&nbsp;&lt;specification>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2602"></a>2602</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Restricted(&nbsp;&lt;chars>,&nbsp;&lt;fusionmap>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2603"></a>2603</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2604"></a>2604</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;These&nbsp;methods&nbsp;are&nbsp;installed&nbsp;just&nbsp;for&nbsp;compatibility&nbsp;with&nbsp;{\GAP}~3.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2605"></a>2605</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2606"></a>2606</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Restricted,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2607"></a>2607</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNearlyCharacterTable,&nbsp;IsNearlyCharacterTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2608"></a>2608</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;subtbl,&nbsp;chars&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2609"></a>2609</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2610"></a>2610</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2611"></a>2611</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;subtbl,&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2612"></a>2612</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fus&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2613"></a>2613</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"class&nbsp;fusion&nbsp;not&nbsp;available"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2614"></a>2614</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2615"></a>2615</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;chars,&nbsp;row&nbsp;->&nbsp;ClassFunction(&nbsp;subtbl,&nbsp;row{&nbsp;fus&nbsp;}&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2616"></a>2616</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2617"></a>2617</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2618"></a>2618</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Restricted,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2619"></a>2619</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNearlyCharacterTable,&nbsp;IsNearlyCharacterTable,&nbsp;IsMatrix,&nbsp;IsObject&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2620"></a>2620</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;subtbl,&nbsp;chars,&nbsp;specification&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2621"></a>2621</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2622"></a>2622</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2623"></a>2623</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;GetFusionMap(&nbsp;subtbl,&nbsp;tbl,&nbsp;specification&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2624"></a>2624</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fus&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2625"></a>2625</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"class&nbsp;fusion&nbsp;not&nbsp;available"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2626"></a>2626</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2627"></a>2627</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;chars,&nbsp;row&nbsp;->&nbsp;ClassFunction(&nbsp;subtbl,&nbsp;row{&nbsp;fus&nbsp;}&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2628"></a>2628</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2629"></a>2629</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2630"></a>2630</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Restricted,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2631"></a>2631</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList,&nbsp;IsList&nbsp;and&nbsp;IsCyclotomicCollection&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2632"></a>2632</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat,&nbsp;fus&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2633"></a>2633</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAll(&nbsp;mat,&nbsp;IsList&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2634"></a>2634</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;mat,&nbsp;row&nbsp;->&nbsp;row{&nbsp;fus&nbsp;}&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2635"></a>2635</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2636"></a>2636</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;mat>&nbsp;must&nbsp;be&nbsp;a&nbsp;matrix"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2637"></a>2637</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2638"></a>2638</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2639"></a>2639</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2640"></a>2640</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2641"></a>2641</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2642"></a>2642</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Restricted(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>,&nbsp;&lt;H>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2643"></a>2643</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Restricted(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>,&nbsp;&lt;hom>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2644"></a>2644</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Restricted(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>,&nbsp;&lt;tbl>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2645"></a>2645</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Restricted(&nbsp;[&lt;tbl>,&nbsp;]&lt;chars>,&nbsp;&lt;H>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2646"></a>2646</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Restricted(&nbsp;[&lt;tbl>,&nbsp;]&lt;chars>,&nbsp;&lt;hom>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2647"></a>2647</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Restricted(&nbsp;[&lt;tbl>,&nbsp;]&lt;chars>,&nbsp;&lt;tbl>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2648"></a>2648</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2649"></a>2649</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Restricted,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2650"></a>2650</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2651"></a>2651</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;RestrictedClassFunction&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2652"></a>2652</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2653"></a>2653</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Restricted,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2654"></a>2654</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2655"></a>2655</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;list,&nbsp;H&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2656"></a>2656</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsMatrix(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2657"></a>2657</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;RestrictedClassFunctions(&nbsp;tbl,&nbsp;list,&nbsp;H&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2658"></a>2658</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2659"></a>2659</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;RestrictedClassFunction(&nbsp;tbl,&nbsp;list,&nbsp;H&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2660"></a>2660</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2661"></a>2661</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2662"></a>2662</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2663"></a>2663</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Restricted,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2664"></a>2664</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsGroupHomomorphism&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2665"></a>2665</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;RestrictedClassFunction&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2666"></a>2666</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2667"></a>2667</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Restricted,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2668"></a>2668</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsClassFunction,&nbsp;IsGroupHomomorphism&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2669"></a>2669</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;list,&nbsp;hom&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2670"></a>2670</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsMatrix(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2671"></a>2671</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;RestrictedClassFunctions(&nbsp;tbl,&nbsp;list,&nbsp;hom&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2672"></a>2672</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2673"></a>2673</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;RestrictedClassFunction(&nbsp;tbl,&nbsp;list,&nbsp;hom&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2674"></a>2674</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2675"></a>2675</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2676"></a>2676</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2677"></a>2677</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Restricted,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2678"></a>2678</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsNearlyCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2679"></a>2679</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;RestrictedClassFunction&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2680"></a>2680</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2681"></a>2681</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Restricted,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2682"></a>2682</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsClassFunction,&nbsp;IsNearlyCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2683"></a>2683</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;list,&nbsp;subtbl&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2684"></a>2684</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsMatrix(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2685"></a>2685</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;RestrictedClassFunctions(&nbsp;tbl,&nbsp;list,&nbsp;subtbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2686"></a>2686</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2687"></a>2687</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;RestrictedClassFunction(&nbsp;tbl,&nbsp;list,&nbsp;subtbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2688"></a>2688</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2689"></a>2689</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2690"></a>2690</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2691"></a>2691</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Restricted,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2692"></a>2692</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2693"></a>2693</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;list,&nbsp;H&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2694"></a>2694</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAll(&nbsp;list,&nbsp;IsClassFunction&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2695"></a>2695</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;RestrictedClassFunctions(&nbsp;list,&nbsp;H&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2696"></a>2696</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2697"></a>2697</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2698"></a>2698</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2699"></a>2699</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2700"></a>2700</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2701"></a>2701</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Restricted,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2702"></a>2702</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList,&nbsp;IsGroupHomomorphism&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2703"></a>2703</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;list,&nbsp;hom&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2704"></a>2704</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAll(&nbsp;list,&nbsp;IsClassFunction&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2705"></a>2705</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;RestrictedClassFunctions(&nbsp;list,&nbsp;hom&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2706"></a>2706</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2707"></a>2707</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2708"></a>2708</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2709"></a>2709</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2710"></a>2710</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2711"></a>2711</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Restricted,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2712"></a>2712</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList,&nbsp;IsNearlyCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2713"></a>2713</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;list,&nbsp;subtbl&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2714"></a>2714</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAll(&nbsp;list,&nbsp;IsClassFunction&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2715"></a>2715</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;RestrictedClassFunctions(&nbsp;list,&nbsp;subtbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2716"></a>2716</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2717"></a>2717</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2718"></a>2718</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2719"></a>2719</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2720"></a>2720</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2721"></a>2721</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2722"></a>2722</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2723"></a>2723</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2724"></a>2724</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;InducedClassFunctionsByFusionMap(&nbsp;&lt;subtbl>,&nbsp;&lt;tbl>,&nbsp;&lt;chars>,&nbsp;&lt;fusionmap>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2725"></a>2725</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2726"></a>2726</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;InducedClassFunctionsByFusionMap,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2727"></a>2727</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;subtbl,&nbsp;tbl,&nbsp;chars,&nbsp;fusion&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2728"></a>2728</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;j,&nbsp;im,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;variables
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2729"></a>2729</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;centralizers,&nbsp;&nbsp;&nbsp;#&nbsp;centralizer&nbsp;orders&nbsp;in&nbsp;hte&nbsp;supergroup
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2730"></a>2730</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nccl,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;number&nbsp;of&nbsp;conjugacy&nbsp;classes&nbsp;of&nbsp;the&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2731"></a>2731</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subnccl,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;number&nbsp;of&nbsp;conjugacy&nbsp;classes&nbsp;of&nbsp;the&nbsp;subgroup
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2732"></a>2732</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;suborder,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;order&nbsp;of&nbsp;the&nbsp;subgroup
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2733"></a>2733</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;subclasses,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;class&nbsp;lengths&nbsp;in&nbsp;the&nbsp;subgroup
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2734"></a>2734</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;induced,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;induced&nbsp;characters,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2735"></a>2735</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singleinduced,&nbsp;&nbsp;#&nbsp;one&nbsp;induced&nbsp;character
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2736"></a>2736</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;character&nbsp;to&nbsp;be&nbsp;induced
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2737"></a>2737</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2738"></a>2738</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fusion&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2739"></a>2739</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2740"></a>2740</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2741"></a>2741</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2742"></a>2742</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;centralizers:=&nbsp;SizesCentralizers(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2743"></a>2743</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nccl:=&nbsp;Length(&nbsp;centralizers&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2744"></a>2744</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;suborder:=&nbsp;Size(&nbsp;subtbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2745"></a>2745</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;subclasses:=&nbsp;SizesConjugacyClasses(&nbsp;subtbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2746"></a>2746</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;subnccl:=&nbsp;Length(&nbsp;subclasses&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2747"></a>2747</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2748"></a>2748</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;induced:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2749"></a>2749</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2750"></a>2750</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;char&nbsp;in&nbsp;chars&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2751"></a>2751</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2752"></a>2752</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Preset&nbsp;the&nbsp;character&nbsp;with&nbsp;zeros.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2753"></a>2753</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singleinduced:=&nbsp;ListWithIdenticalEntries(&nbsp;nccl,&nbsp;0&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2754"></a>2754</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2755"></a>2755</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Add&nbsp;the&nbsp;contribution&nbsp;of&nbsp;each&nbsp;class&nbsp;of&nbsp;the&nbsp;subgroup.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2756"></a>2756</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;subnccl&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2757"></a>2757</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;char[j]&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2758"></a>2758</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsInt(&nbsp;fusion[j]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2759"></a>2759</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singleinduced[&nbsp;fusion[j]&nbsp;]:=&nbsp;singleinduced[&nbsp;fusion[j]&nbsp;]
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2760"></a>2760</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;char[j]&nbsp;*&nbsp;subclasses[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2761"></a>2761</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2762"></a>2762</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;im&nbsp;in&nbsp;fusion[j]&nbsp;do&nbsp;singleinduced[&nbsp;im&nbsp;]:=&nbsp;Unknown();&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2763"></a>2763</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;only&nbsp;for&nbsp;TableInProgress!
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2764"></a>2764</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2765"></a>2765</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2766"></a>2766</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2767"></a>2767</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2768"></a>2768</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Adjust&nbsp;the&nbsp;values&nbsp;by&nbsp;multiplication.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2769"></a>2769</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;nccl&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2770"></a>2770</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singleinduced[j]:=&nbsp;singleinduced[j]&nbsp;*&nbsp;centralizers[j]&nbsp;/&nbsp;suborder;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2771"></a>2771</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsCycInt(&nbsp;singleinduced[j]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2772"></a>2772</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singleinduced[j]:=&nbsp;Unknown();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2773"></a>2773</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;1,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2774"></a>2774</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Induced:&nbsp;subgroup&nbsp;order&nbsp;not&nbsp;dividing&nbsp;sum&nbsp;in&nbsp;character&nbsp;",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2775"></a>2775</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Length(&nbsp;induced&nbsp;)&nbsp;+&nbsp;1,&nbsp;"&nbsp;at&nbsp;class&nbsp;",&nbsp;j&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2776"></a>2776</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2777"></a>2777</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2778"></a>2778</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2779"></a>2779</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;the&nbsp;class&nbsp;function&nbsp;object.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2780"></a>2780</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;char&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2781"></a>2781</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singleinduced:=&nbsp;ClassFunctionSameType(&nbsp;tbl,&nbsp;char,&nbsp;singleinduced&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2782"></a>2782</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2783"></a>2783</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;singleinduced:=&nbsp;ClassFunction(&nbsp;tbl,&nbsp;singleinduced&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2784"></a>2784</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2785"></a>2785</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2786"></a>2786</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;induced,&nbsp;singleinduced&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2787"></a>2787</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2788"></a>2788</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2789"></a>2789</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2790"></a>2790</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;list&nbsp;of&nbsp;induced&nbsp;characters.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2791"></a>2791</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;induced;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2792"></a>2792</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2793"></a>2793</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2794"></a>2794</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2795"></a>2795</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2796"></a>2796</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2797"></a>2797</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;InducedClassFunction(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>,&nbsp;&lt;H>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2798"></a>2798</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;InducedClassFunction(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>,&nbsp;&lt;hom>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2799"></a>2799</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;InducedClassFunction(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>,&nbsp;&lt;suptbl>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2800"></a>2800</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2801"></a>2801</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedClassFunction,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2802"></a>2802</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function&nbsp;and&nbsp;a&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2803"></a>2803</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2804"></a>2804</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2805"></a>2805</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;suptbl,&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2806"></a>2806</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2807"></a>2807</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;suptbl:=&nbsp;OrdinaryCharacterTable(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2808"></a>2808</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2809"></a>2809</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;suptbl:=&nbsp;suptbl&nbsp;mod&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2810"></a>2810</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2811"></a>2811</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;tbl,&nbsp;suptbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2812"></a>2812</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctionsByFusionMap(&nbsp;tbl,&nbsp;suptbl,&nbsp;[&nbsp;chi&nbsp;],&nbsp;fus&nbsp;)[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2813"></a>2813</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2814"></a>2814</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2815"></a>2815</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedClassFunction,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2816"></a>2816</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table,&nbsp;a&nbsp;homogeneous&nbsp;list,&nbsp;and&nbsp;a&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2817"></a>2817</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2818"></a>2818</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chi,&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2819"></a>2819</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;suptbl,&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2820"></a>2820</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;suptbl:=&nbsp;OrdinaryCharacterTable(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2821"></a>2821</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2822"></a>2822</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;suptbl:=&nbsp;suptbl&nbsp;mod&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2823"></a>2823</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2824"></a>2824</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;tbl,&nbsp;suptbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2825"></a>2825</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctionsByFusionMap(&nbsp;tbl,&nbsp;suptbl,&nbsp;[&nbsp;chi&nbsp;],&nbsp;fus&nbsp;)[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2826"></a>2826</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2827"></a>2827</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2828"></a>2828</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedClassFunction,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2829"></a>2829</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;class&nbsp;function&nbsp;and&nbsp;nearly&nbsp;character&nbsp;table",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2830"></a>2830</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsNearlyCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2831"></a>2831</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;suptbl&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2832"></a>2832</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2833"></a>2833</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2834"></a>2834</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;tbl,&nbsp;suptbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2835"></a>2835</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctionsByFusionMap(&nbsp;tbl,&nbsp;suptbl,&nbsp;[&nbsp;chi&nbsp;],&nbsp;fus&nbsp;)[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2836"></a>2836</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2837"></a>2837</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2838"></a>2838</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedClassFunction,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2839"></a>2839</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;character&nbsp;table,&nbsp;homogeneous&nbsp;list,&nbsp;and&nbsp;nearly&nbsp;character&nbsp;table",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2840"></a>2840</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsNearlyCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2841"></a>2841</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chi,&nbsp;suptbl&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2842"></a>2842</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2843"></a>2843</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;tbl,&nbsp;suptbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2844"></a>2844</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctionsByFusionMap(&nbsp;tbl,&nbsp;suptbl,&nbsp;[&nbsp;chi&nbsp;],&nbsp;fus&nbsp;)[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2845"></a>2845</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2846"></a>2846</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2847"></a>2847</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedClassFunction,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2848"></a>2848</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;class&nbsp;function&nbsp;and&nbsp;a&nbsp;group&nbsp;homomorphism",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2849"></a>2849</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsGeneralMapping&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2850"></a>2850</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chi,&nbsp;hom&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2851"></a>2851</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,&nbsp;suptbl,&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2852"></a>2852</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2853"></a>2853</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;suptbl:=&nbsp;OrdinaryCharacterTable(Image(&nbsp;hom&nbsp;));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2854"></a>2854</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2855"></a>2855</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;suptbl:=&nbsp;suptbl&nbsp;mod&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2856"></a>2856</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2857"></a>2857</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;hom,&nbsp;tbl,&nbsp;suptbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2858"></a>2858</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctionsByFusionMap(&nbsp;tbl,&nbsp;suptbl,&nbsp;[&nbsp;chi&nbsp;],&nbsp;fus&nbsp;)[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2859"></a>2859</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2860"></a>2860</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2861"></a>2861</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedClassFunction,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2862"></a>2862</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table,&nbsp;a&nbsp;homogeneous&nbsp;list,&nbsp;and&nbsp;a&nbsp;group&nbsp;homomorphism",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2863"></a>2863</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsGeneralMapping&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2864"></a>2864</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chi,&nbsp;hom&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2865"></a>2865</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;suptbl,&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2866"></a>2866</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;suptbl:=&nbsp;OrdinaryCharacterTable(Image(&nbsp;hom&nbsp;));
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2867"></a>2867</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2868"></a>2868</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;suptbl:=&nbsp;suptbl&nbsp;mod&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2869"></a>2869</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2870"></a>2870</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;hom,&nbsp;tbl,&nbsp;suptbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2871"></a>2871</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctionsByFusionMap(&nbsp;tbl,&nbsp;suptbl,&nbsp;[&nbsp;chi&nbsp;],&nbsp;fus&nbsp;)[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2872"></a>2872</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2873"></a>2873</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2874"></a>2874</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2875"></a>2875</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2876"></a>2876</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2877"></a>2877</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;InducedClassFunctions(&nbsp;[&lt;tbl>,&nbsp;]&lt;chars>,&nbsp;&lt;H>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2878"></a>2878</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;InducedClassFunctions(&nbsp;[&lt;tbl>,&nbsp;]&lt;chars>,&nbsp;&lt;hom>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2879"></a>2879</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;InducedClassFunctions(&nbsp;[&lt;tbl>,&nbsp;]&lt;chars>,&nbsp;&lt;suptbl>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2880"></a>2880</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2881"></a>2881</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2882"></a>2882</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;list,&nbsp;and&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2883"></a>2883</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2884"></a>2884</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chars,&nbsp;H&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2885"></a>2885</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;chars,&nbsp;chi&nbsp;->&nbsp;InducedClassFunction(&nbsp;chi,&nbsp;H&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2886"></a>2886</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2887"></a>2887</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2888"></a>2888</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2889"></a>2889</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;list,&nbsp;and&nbsp;group&nbsp;homomorphism",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2890"></a>2890</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList,&nbsp;IsGeneralMapping&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2891"></a>2891</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chars,&nbsp;hom&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2892"></a>2892</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;chars,&nbsp;chi&nbsp;->&nbsp;InducedClassFunction(&nbsp;chi,&nbsp;hom&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2893"></a>2893</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2894"></a>2894</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2895"></a>2895</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2896"></a>2896</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;list,&nbsp;and&nbsp;group&nbsp;homomorphism",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2897"></a>2897</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList,&nbsp;IsCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2898"></a>2898</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;chars,&nbsp;suptbl&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2899"></a>2899</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;chars,&nbsp;chi&nbsp;->&nbsp;InducedClassFunction(&nbsp;chi,&nbsp;suptbl&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2900"></a>2900</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2901"></a>2901</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2902"></a>2902</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2903"></a>2903</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table,&nbsp;a&nbsp;homogeneous&nbsp;list,&nbsp;and&nbsp;a&nbsp;group",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2904"></a>2904</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2905"></a>2905</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chars,&nbsp;G&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2906"></a>2906</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;suptbl,&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2907"></a>2907</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;suptbl:=&nbsp;OrdinaryCharacterTable(&nbsp;G&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2908"></a>2908</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2909"></a>2909</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;suptbl:=&nbsp;suptbl&nbsp;mod&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2910"></a>2910</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2911"></a>2911</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;tbl,&nbsp;suptbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2912"></a>2912</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctionsByFusionMap(&nbsp;tbl,&nbsp;suptbl,&nbsp;chars,&nbsp;fus&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2913"></a>2913</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2914"></a>2914</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2915"></a>2915</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2916"></a>2916</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;character&nbsp;table,&nbsp;homogeneous&nbsp;list,&nbsp;and&nbsp;nearly&nbsp;character&nbsp;table",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2917"></a>2917</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsNearlyCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2918"></a>2918</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chars,&nbsp;suptbl&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2919"></a>2919</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2920"></a>2920</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;tbl,&nbsp;suptbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2921"></a>2921</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctionsByFusionMap(&nbsp;tbl,&nbsp;suptbl,&nbsp;chars,&nbsp;fus&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2922"></a>2922</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2923"></a>2923</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2924"></a>2924</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2925"></a>2925</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table,&nbsp;a&nbsp;homogeneous&nbsp;list,&nbsp;and&nbsp;a&nbsp;group&nbsp;homomorphism",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2926"></a>2926</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsGeneralMapping&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2927"></a>2927</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chars,&nbsp;hom&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2928"></a>2928</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;suptbl,&nbsp;fus;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2929"></a>2929</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;suptbl:=&nbsp;Image(&nbsp;hom&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2930"></a>2930</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;)&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2931"></a>2931</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;suptbl:=&nbsp;suptbl&nbsp;mod&nbsp;UnderlyingCharacteristic(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2932"></a>2932</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2933"></a>2933</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fus:=&nbsp;FusionConjugacyClasses(&nbsp;hom,&nbsp;tbl,&nbsp;suptbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2934"></a>2934</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctionsByFusionMap(&nbsp;tbl,&nbsp;suptbl,&nbsp;chars,&nbsp;fus&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2935"></a>2935</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2936"></a>2936</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2937"></a>2937</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2938"></a>2938</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2939"></a>2939</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2940"></a>2940</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Induced(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>,&nbsp;&lt;H>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2941"></a>2941</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Induced(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>,&nbsp;&lt;hom>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2942"></a>2942</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Induced(&nbsp;[&lt;tbl>,&nbsp;]&lt;chi>,&nbsp;&lt;suptbl>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2943"></a>2943</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Induced(&nbsp;[&lt;tbl>,&nbsp;]&lt;chars>,&nbsp;&lt;H>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2944"></a>2944</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Induced(&nbsp;[&lt;tbl>,&nbsp;]&lt;chars>,&nbsp;&lt;hom>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2945"></a>2945</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Induced(&nbsp;[&lt;tbl>,&nbsp;]&lt;chars>,&nbsp;&lt;suptbl>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2946"></a>2946</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2947"></a>2947</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Induced,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2948"></a>2948</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2949"></a>2949</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;InducedClassFunction&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2950"></a>2950</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2951"></a>2951</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Induced,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2952"></a>2952</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2953"></a>2953</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;list,&nbsp;H&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2954"></a>2954</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsMatrix(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2955"></a>2955</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctions(&nbsp;tbl,&nbsp;list,&nbsp;H&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2956"></a>2956</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2957"></a>2957</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunction(&nbsp;tbl,&nbsp;list,&nbsp;H&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2958"></a>2958</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2959"></a>2959</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2960"></a>2960</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2961"></a>2961</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Induced,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2962"></a>2962</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsGroupHomomorphism&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2963"></a>2963</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;InducedClassFunction&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2964"></a>2964</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2965"></a>2965</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Induced,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2966"></a>2966</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsGroupHomomorphism&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2967"></a>2967</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;list,&nbsp;hom&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2968"></a>2968</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsMatrix(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2969"></a>2969</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctions(&nbsp;tbl,&nbsp;list,&nbsp;hom&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2970"></a>2970</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2971"></a>2971</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunction(&nbsp;tbl,&nbsp;list,&nbsp;hom&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2972"></a>2972</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2973"></a>2973</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2974"></a>2974</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2975"></a>2975</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Induced,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2976"></a>2976</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsClassFunction,&nbsp;IsNearlyCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2977"></a>2977</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;InducedClassFunction&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2978"></a>2978</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2979"></a>2979</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Induced,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2980"></a>2980</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsNearlyCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2981"></a>2981</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;list,&nbsp;suptbl&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2982"></a>2982</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsMatrix(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2983"></a>2983</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctions(&nbsp;tbl,&nbsp;list,&nbsp;suptbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2984"></a>2984</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2985"></a>2985</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunction(&nbsp;tbl,&nbsp;list,&nbsp;suptbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2986"></a>2986</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2987"></a>2987</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2988"></a>2988</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2989"></a>2989</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Induced,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2990"></a>2990</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList,&nbsp;IsGroup&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2991"></a>2991</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;list,&nbsp;H&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2992"></a>2992</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAll(&nbsp;list,&nbsp;IsClassFunction&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2993"></a>2993</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctions(&nbsp;list,&nbsp;H&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2994"></a>2994</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2995"></a>2995</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2996"></a>2996</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2997"></a>2997</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2998"></a>2998</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line2999"></a>2999</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Induced,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3000"></a>3000</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList,&nbsp;IsGeneralMapping&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3001"></a>3001</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;list,&nbsp;hom&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3002"></a>3002</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAll(&nbsp;list,&nbsp;IsClassFunction&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3003"></a>3003</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctions(&nbsp;list,&nbsp;hom&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3004"></a>3004</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3005"></a>3005</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3006"></a>3006</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3007"></a>3007</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3008"></a>3008</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3009"></a>3009</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Induced,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3010"></a>3010</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList,&nbsp;IsCharacterTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3011"></a>3011</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;list,&nbsp;suptbl&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3012"></a>3012</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAll(&nbsp;list,&nbsp;IsClassFunction&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3013"></a>3013</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctions(&nbsp;list,&nbsp;suptbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3014"></a>3014</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3015"></a>3015</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3016"></a>3016</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3017"></a>3017</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3018"></a>3018</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3019"></a>3019</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3020"></a>3020</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3021"></a>3021</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3022"></a>3022</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Induced(&nbsp;&lt;subtbl>,&nbsp;&lt;tbl>,&nbsp;&lt;chars>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3023"></a>3023</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Induced(&nbsp;&lt;subtbl>,&nbsp;&lt;tbl>,&nbsp;&lt;chars>,&nbsp;&lt;specification>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3024"></a>3024</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;Induced(&nbsp;&lt;subtbl>,&nbsp;&lt;tbl>,&nbsp;&lt;chars>,&nbsp;&lt;fusionmap>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3025"></a>3025</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3026"></a>3026</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;These&nbsp;methods&nbsp;are&nbsp;installed&nbsp;just&nbsp;for&nbsp;compatibility&nbsp;with&nbsp;{\GAP}~3.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3027"></a>3027</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3028"></a>3028</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Induced,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3029"></a>3029</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;nearly&nbsp;character&nbsp;tables,&nbsp;and&nbsp;homog&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3030"></a>3030</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNearlyCharacterTable,&nbsp;IsNearlyCharacterTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3031"></a>3031</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;subtbl,&nbsp;tbl,&nbsp;chars&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3032"></a>3032</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctionsByFusionMap(&nbsp;subtbl,&nbsp;tbl,&nbsp;chars,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3033"></a>3033</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FusionConjugacyClasses(&nbsp;subtbl,&nbsp;tbl&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3034"></a>3034</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3035"></a>3035</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3036"></a>3036</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Induced,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3037"></a>3037</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;nearly&nbsp;character&nbsp;tables,&nbsp;homog&nbsp;list,&nbsp;and&nbsp;string",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3038"></a>3038</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNearlyCharacterTable,&nbsp;IsNearlyCharacterTable,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3039"></a>3039</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsHomogeneousList,&nbsp;IsString&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3040"></a>3040</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;subtbl,&nbsp;tbl,&nbsp;chars,&nbsp;specification&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3041"></a>3041</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedClassFunctionsByFusionMap(&nbsp;subtbl,&nbsp;tbl,&nbsp;chars,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3042"></a>3042</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FusionConjugacyClasses(&nbsp;subtbl,&nbsp;tbl,&nbsp;specification&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3043"></a>3043</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3044"></a>3044</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3045"></a>3045</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Induced,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3046"></a>3046</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;nearly&nbsp;character&nbsp;tables&nbsp;and&nbsp;two&nbsp;homog.&nbsp;lists",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3047"></a>3047</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsNearlyCharacterTable,&nbsp;IsNearlyCharacterTable,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3048"></a>3048</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsHomogeneousList,&nbsp;IsHomogeneousList&nbsp;and&nbsp;IsCyclotomicCollection&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3049"></a>3049</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;InducedClassFunctionsByFusionMap&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3050"></a>3050</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3051"></a>3051</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3052"></a>3052</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3053"></a>3053</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3054"></a>3054</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;InducedCyclic(&nbsp;&lt;tbl>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3055"></a>3055</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;InducedCyclic(&nbsp;&lt;tbl>,&nbsp;\"all\"&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3056"></a>3056</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;InducedCyclic(&nbsp;&lt;tbl>,&nbsp;&lt;classes>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3057"></a>3057</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;InducedCyclic(&nbsp;&lt;tbl>,&nbsp;&lt;classes>,&nbsp;\"all\"&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3058"></a>3058</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3059"></a>3059</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedCyclic,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3060"></a>3060</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3061"></a>3061</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3062"></a>3062</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl&nbsp;->&nbsp;InducedCyclic(&nbsp;tbl,&nbsp;[&nbsp;1&nbsp;..&nbsp;NrConjugacyClasses(&nbsp;tbl&nbsp;)&nbsp;]&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3063"></a>3063</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3064"></a>3064</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedCyclic,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3065"></a>3065</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table&nbsp;and&nbsp;a&nbsp;string",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3066"></a>3066</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsString&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3067"></a>3067</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;`string'&nbsp;should&nbsp;overrule&nbsp;over&nbsp;the&nbsp;`homogeneous&nbsp;list'&nbsp;installed&nbsp;in
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3068"></a>3068</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;next&nbsp;method
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3069"></a>3069</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;1,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3070"></a>3070</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;all&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3071"></a>3071</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;InducedCyclic(&nbsp;tbl,&nbsp;[&nbsp;1&nbsp;..&nbsp;NrConjugacyClasses(&nbsp;tbl&nbsp;)&nbsp;],&nbsp;all&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3072"></a>3072</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3073"></a>3073</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3074"></a>3074</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedCyclic,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3075"></a>3075</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table&nbsp;and&nbsp;a&nbsp;hom.&nbsp;list",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3076"></a>3076</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3077"></a>3077</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;classes&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3078"></a>3078</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;centralizers,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3079"></a>3079</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orders,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3080"></a>3080</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;independent,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3081"></a>3081</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inducedcyclic,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3082"></a>3082</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3083"></a>3083</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fusion,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3084"></a>3084</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3085"></a>3085</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3086"></a>3086</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3087"></a>3087</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;centralizers:=&nbsp;SizesCentralizers(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3088"></a>3088</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;orders:=&nbsp;OrdersClassRepresentatives(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3089"></a>3089</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;independent:=&nbsp;List(&nbsp;orders,&nbsp;x&nbsp;->&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3090"></a>3090</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;inducedcyclic:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3091"></a>3091</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;classes&nbsp;do&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;induce&nbsp;from&nbsp;i-th&nbsp;class
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3092"></a>3092</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;independent[i]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3093"></a>3093</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fusion:=&nbsp;[&nbsp;i&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3094"></a>3094</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;2&nbsp;..&nbsp;orders[i]&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3095"></a>3095</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fusion[j]:=&nbsp;PowerMap(&nbsp;tbl,&nbsp;j,&nbsp;i&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;j-th&nbsp;powermap&nbsp;at&nbsp;class&nbsp;i
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3096"></a>3096</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3097"></a>3097</td><td></td><td></td><td></td><td><span><tt>	single:=&nbsp;ListWithIdenticalEntries(Length(orders),0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3098"></a>3098</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;fusion&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3099"></a>3099</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;orders[j]&nbsp;=&nbsp;orders[i]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3100"></a>3100</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;position&nbsp;is&nbsp;Galois&nbsp;conjugate&nbsp;to&nbsp;'i'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3101"></a>3101</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;independent[j]:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3102"></a>3102</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3103"></a>3103</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single[j]:=&nbsp;single[j]&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3104"></a>3104</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3105"></a>3105</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;orders&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3106"></a>3106</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single[j]:=&nbsp;single[j]&nbsp;*&nbsp;centralizers[j]&nbsp;/&nbsp;orders[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3107"></a>3107</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsInt(&nbsp;single[j]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3108"></a>3108</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single[j]:=&nbsp;Unknown();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3109"></a>3109</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;1,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3110"></a>3110</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"InducedCyclic:&nbsp;subgroup&nbsp;order&nbsp;not&nbsp;dividing&nbsp;sum",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3111"></a>3111</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;(induce&nbsp;from&nbsp;class&nbsp;",&nbsp;i,&nbsp;")"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3112"></a>3112</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3113"></a>3113</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3114"></a>3114</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;inducedcyclic,&nbsp;Character(&nbsp;tbl,&nbsp;single&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3115"></a>3115</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3116"></a>3116</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3117"></a>3117</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;inducedcyclic;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3118"></a>3118</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3119"></a>3119</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3120"></a>3120</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;InducedCyclic,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3121"></a>3121</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;character&nbsp;table,&nbsp;a&nbsp;hom.&nbsp;list,&nbsp;and&nbsp;a&nbsp;string",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3122"></a>3122</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList,&nbsp;IsString&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3123"></a>3123</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;classes,&nbsp;all&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3124"></a>3124</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;centralizers,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3125"></a>3125</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orders,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3126"></a>3126</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;independent,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3127"></a>3127</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inducedcyclic,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3128"></a>3128</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3129"></a>3129</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fusion,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3130"></a>3130</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3131"></a>3131</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3132"></a>3132</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3133"></a>3133</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3134"></a>3134</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;centralizers:=&nbsp;SizesCentralizers(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3135"></a>3135</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;orders:=&nbsp;OrdersClassRepresentatives(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3136"></a>3136</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;independent:=&nbsp;List(&nbsp;orders,&nbsp;x&nbsp;->&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3137"></a>3137</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;inducedcyclic:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3138"></a>3138</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;classes&nbsp;do&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;induce&nbsp;from&nbsp;i-th&nbsp;class
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3139"></a>3139</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;independent[i]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3140"></a>3140</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fusion:=&nbsp;[&nbsp;i&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3141"></a>3141</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;2&nbsp;..&nbsp;orders[i]&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3142"></a>3142</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fusion[j]:=&nbsp;PowerMap(&nbsp;tbl,&nbsp;j,&nbsp;i&nbsp;);&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;j-th&nbsp;powermap&nbsp;at&nbsp;class&nbsp;i
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3143"></a>3143</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3144"></a>3144</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3145"></a>3145</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;[&nbsp;0&nbsp;..&nbsp;orders[i]&nbsp;-&nbsp;1&nbsp;]&nbsp;do&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;induce&nbsp;k-th&nbsp;character
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3146"></a>3146</td><td></td><td></td><td></td><td><span><tt>	&nbsp;&nbsp;single:=&nbsp;ListWithIdenticalEntries(Length(orders),0);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3147"></a>3147</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single[i]:=&nbsp;E(&nbsp;orders[i]&nbsp;)&nbsp;^&nbsp;(&nbsp;k&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3148"></a>3148</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;2&nbsp;..&nbsp;orders[i]&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3149"></a>3149</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;orders[&nbsp;fusion[j]&nbsp;]&nbsp;=&nbsp;orders[i]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3150"></a>3150</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3151"></a>3151</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;position&nbsp;is&nbsp;Galois&nbsp;conjugate
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3152"></a>3152</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;independent[&nbsp;fusion[j]&nbsp;]:=&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3153"></a>3153</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3154"></a>3154</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single[&nbsp;fusion[j]&nbsp;]:=
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3155"></a>3155</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single[&nbsp;fusion[j]&nbsp;]&nbsp;+&nbsp;E(&nbsp;orders[i]&nbsp;)^(&nbsp;k*j&nbsp;mod&nbsp;orders[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3156"></a>3156</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3157"></a>3157</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;orders&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3158"></a>3158</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single[j]:=&nbsp;single[j]&nbsp;*&nbsp;centralizers[j]&nbsp;/&nbsp;orders[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3159"></a>3159</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsCycInt(&nbsp;single[j]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3160"></a>3160</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single[j]:=&nbsp;Unknown();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3161"></a>3161</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;1,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3162"></a>3162</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"InducedCyclic:&nbsp;subgroup&nbsp;order&nbsp;not&nbsp;dividing&nbsp;sum",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3163"></a>3163</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;(induce&nbsp;from&nbsp;class&nbsp;",&nbsp;i,&nbsp;")"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3164"></a>3164</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3165"></a>3165</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3166"></a>3166</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;inducedcyclic,&nbsp;Character(&nbsp;tbl,&nbsp;single&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3167"></a>3167</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3168"></a>3168</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3169"></a>3169</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3170"></a>3170</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;inducedcyclic;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3171"></a>3171</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3172"></a>3172</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3173"></a>3173</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3174"></a>3174</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3175"></a>3175</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3176"></a>3176</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;10.&nbsp;Reducing&nbsp;Virtual&nbsp;Characters
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3177"></a>3177</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3178"></a>3178</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3179"></a>3179</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3180"></a>3180</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3181"></a>3181</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3182"></a>3182</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ReducedClassFunctions(&nbsp;[&lt;ordtbl>,&nbsp;]&lt;constituents>,&nbsp;&lt;reducibles>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3183"></a>3183</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ReducedClassFunctions(&nbsp;[&lt;ordtbl>,&nbsp;]&lt;reducibles>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3184"></a>3184</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3185"></a>3185</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ReducedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3186"></a>3186</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;lists&nbsp;(of&nbsp;class&nbsp;functions)",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3187"></a>3187</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3188"></a>3188</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;constituents,&nbsp;reducibles&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3189"></a>3189</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;constituents&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3190"></a>3190</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(&nbsp;irreducibles:=&nbsp;[],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3191"></a>3191</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remainders:=&nbsp;ShallowCopy(&nbsp;reducibles&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3192"></a>3192</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsClassFunction(&nbsp;constituents[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3193"></a>3193</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ReducedClassFunctions(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3194"></a>3194</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UnderlyingCharacterTable(&nbsp;constituents[1]&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3195"></a>3195</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constituents,&nbsp;reducibles&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3196"></a>3196</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3197"></a>3197</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3198"></a>3198</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3199"></a>3199</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3200"></a>3200</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3201"></a>3201</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ReducedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3202"></a>3202</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;list&nbsp;(of&nbsp;class&nbsp;functions)",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3203"></a>3203</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3204"></a>3204</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;reducibles&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3205"></a>3205</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;reducibles&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3206"></a>3206</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(&nbsp;irreducibles:=&nbsp;[],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3207"></a>3207</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remainders:=&nbsp;[]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3208"></a>3208</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsClassFunction(&nbsp;reducibles[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3209"></a>3209</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ReducedClassFunctions(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3210"></a>3210</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UnderlyingCharacterTable(&nbsp;reducibles[1]&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3211"></a>3211</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reducibles&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3212"></a>3212</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3213"></a>3213</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3214"></a>3214</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3215"></a>3215</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3216"></a>3216</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3217"></a>3217</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ReducedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3218"></a>3218</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;ordinary&nbsp;character&nbsp;table,&nbsp;and&nbsp;two&nbsp;lists&nbsp;(of&nbsp;class&nbsp;functions)",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3219"></a>3219</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3220"></a>3220</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;ordtbl,&nbsp;constituents,&nbsp;reducibles&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3221"></a>3221</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,&nbsp;j,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3222"></a>3222</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normsquare,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3223"></a>3223</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;upper,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3224"></a>3224</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;found&nbsp;irreducible&nbsp;characters
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3225"></a>3225</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remainders,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;reducible&nbsp;remainders&nbsp;after&nbsp;reduction
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3226"></a>3226</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3227"></a>3227</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduced,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3228"></a>3228</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3229"></a>3229</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3230"></a>3230</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;upper:=&nbsp;Length(&nbsp;constituents&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3231"></a>3231</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;upper:=&nbsp;List(&nbsp;reducibles,&nbsp;x&nbsp;->&nbsp;upper&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3232"></a>3232</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;normsquare:=&nbsp;List(&nbsp;constituents,&nbsp;x&nbsp;->&nbsp;ScalarProduct(&nbsp;ordtbl,&nbsp;x,&nbsp;x&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3233"></a>3233</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;found:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3234"></a>3234</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;remainders:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3235"></a>3235</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3236"></a>3236</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;reducibles&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3237"></a>3237</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single:=&nbsp;reducibles[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3238"></a>3238</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;upper[i]&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3239"></a>3239</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr:=&nbsp;ScalarProduct(&nbsp;ordtbl,&nbsp;single,&nbsp;constituents[j]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3240"></a>3240</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsInt(&nbsp;scpr&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3241"></a>3241</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr:=&nbsp;Int(&nbsp;scpr&nbsp;/&nbsp;normsquare[j]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3242"></a>3242</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;scpr&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3243"></a>3243</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single:=&nbsp;single&nbsp;-&nbsp;scpr&nbsp;*&nbsp;constituents[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3244"></a>3244</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3245"></a>3245</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3246"></a>3246</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;1,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3247"></a>3247</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ReducedClassFunctions:&nbsp;scalar&nbsp;product&nbsp;of&nbsp;X[",&nbsp;j,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3248"></a>3248</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"]&nbsp;with&nbsp;Y[",&nbsp;i,&nbsp;"]&nbsp;not&nbsp;integral&nbsp;(ignore)"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3249"></a>3249</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3250"></a>3250</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3251"></a>3251</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAny(&nbsp;single,&nbsp;x&nbsp;->&nbsp;x&nbsp;&lt;>&nbsp;0&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3252"></a>3252</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;single[1]&nbsp;&lt;&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3253"></a>3253</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single:=&nbsp;-&nbsp;single;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3254"></a>3254</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3255"></a>3255</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ScalarProduct(&nbsp;ordtbl,&nbsp;single,&nbsp;single&nbsp;)&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3256"></a>3256</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;single&nbsp;in&nbsp;found&nbsp;and&nbsp;not&nbsp;single&nbsp;in&nbsp;constituents&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3257"></a>3257</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;2,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3258"></a>3258</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ReducedClassFunctions:&nbsp;irreducible&nbsp;character&nbsp;of&nbsp;degree&nbsp;",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3259"></a>3259</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single[1],&nbsp;"&nbsp;found"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3260"></a>3260</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;single&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3261"></a>3261</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetIsCharacter(&nbsp;single,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3262"></a>3262</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3263"></a>3263</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;found,&nbsp;single&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3264"></a>3264</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3265"></a>3265</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3266"></a>3266</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;remainders,&nbsp;single&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3267"></a>3267</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3268"></a>3268</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3269"></a>3269</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3270"></a>3270</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3271"></a>3271</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;no&nbsp;irreducibles&nbsp;were&nbsp;found,&nbsp;return&nbsp;the&nbsp;remainders.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3272"></a>3272</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;found&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3273"></a>3273</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(&nbsp;remainders:=&nbsp;remainders,&nbsp;irreducibles:=&nbsp;[]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3274"></a>3274</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3275"></a>3275</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3276"></a>3276</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Try&nbsp;to&nbsp;find&nbsp;new&nbsp;irreducibles&nbsp;by&nbsp;recursively&nbsp;calling&nbsp;the&nbsp;reduction.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3277"></a>3277</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;reduced:=&nbsp;ReducedClassFunctions(&nbsp;ordtbl,&nbsp;found,&nbsp;remainders&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3278"></a>3278</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3279"></a>3279</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;result.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3280"></a>3280</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(&nbsp;remainders:=&nbsp;reduced.remainders,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3281"></a>3281</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irreducibles:=&nbsp;Union(&nbsp;found,&nbsp;reduced.irreducibles&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3282"></a>3282</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3283"></a>3283</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3284"></a>3284</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ReducedClassFunctions,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3285"></a>3285</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;ordinary&nbsp;character&nbsp;table,&nbsp;and&nbsp;list&nbsp;of&nbsp;class&nbsp;functions",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3286"></a>3286</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3287"></a>3287</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;ordtbl,&nbsp;reducibles&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3288"></a>3288</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;upper,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3289"></a>3289</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normsquare,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3290"></a>3290</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;found&nbsp;irreducible&nbsp;characters
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3291"></a>3291</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remainders,&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;reducible&nbsp;remainders&nbsp;after&nbsp;reduction
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3292"></a>3292</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;j,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3293"></a>3293</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3294"></a>3294</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduced,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3295"></a>3295</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3296"></a>3296</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3297"></a>3297</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;upper:=&nbsp;[&nbsp;0&nbsp;..&nbsp;Length(&nbsp;reducibles&nbsp;)&nbsp;-&nbsp;1&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3298"></a>3298</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;normsquare:=&nbsp;List(&nbsp;reducibles,&nbsp;x&nbsp;->&nbsp;ScalarProduct(&nbsp;ordtbl,&nbsp;x,&nbsp;x&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3299"></a>3299</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;found:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3300"></a>3300</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;remainders:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3301"></a>3301</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3302"></a>3302</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;reducibles&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3303"></a>3303</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;normsquare[i]&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3304"></a>3304</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;0&nbsp;&lt;&nbsp;reducibles[i][1]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3305"></a>3305</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;found,&nbsp;reducibles[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3306"></a>3306</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3307"></a>3307</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;found,&nbsp;-&nbsp;reducibles[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3308"></a>3308</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3309"></a>3309</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3310"></a>3310</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3311"></a>3311</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3312"></a>3312</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;reducibles&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3313"></a>3313</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single:=&nbsp;reducibles[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3314"></a>3314</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;upper[i]&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3315"></a>3315</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr:=&nbsp;ScalarProduct(&nbsp;ordtbl,&nbsp;single,&nbsp;reducibles[j]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3316"></a>3316</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsInt(&nbsp;scpr&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3317"></a>3317</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr:=&nbsp;Int(&nbsp;scpr&nbsp;/&nbsp;normsquare[j]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3318"></a>3318</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;scpr&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3319"></a>3319</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single:=&nbsp;single&nbsp;-&nbsp;scpr&nbsp;*&nbsp;reducibles[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3320"></a>3320</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3321"></a>3321</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3322"></a>3322</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;1,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3323"></a>3323</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ReducedClassFunctions:&nbsp;scalar&nbsp;product&nbsp;of&nbsp;X[",&nbsp;j,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3324"></a>3324</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"]&nbsp;with&nbsp;Y[",&nbsp;i,&nbsp;"]&nbsp;not&nbsp;integral&nbsp;(ignore)"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3325"></a>3325</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3326"></a>3326</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3327"></a>3327</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAny(&nbsp;single,&nbsp;x&nbsp;->&nbsp;x&nbsp;&lt;>&nbsp;0&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3328"></a>3328</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;single[1]&nbsp;&lt;&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3329"></a>3329</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single:=&nbsp;-&nbsp;single;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3330"></a>3330</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3331"></a>3331</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ScalarProduct(&nbsp;ordtbl,&nbsp;single,&nbsp;single&nbsp;)&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3332"></a>3332</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;single&nbsp;in&nbsp;found&nbsp;and&nbsp;not&nbsp;single&nbsp;in&nbsp;reducibles&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3333"></a>3333</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;2,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3334"></a>3334</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ReducedClassFunctions:&nbsp;irreducible&nbsp;character&nbsp;of&nbsp;degree&nbsp;",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3335"></a>3335</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single[1],&nbsp;"&nbsp;found"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3336"></a>3336</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;single&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3337"></a>3337</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetIsCharacter(&nbsp;single,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3338"></a>3338</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3339"></a>3339</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;found,&nbsp;single&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3340"></a>3340</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3341"></a>3341</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3342"></a>3342</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;remainders,&nbsp;single&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3343"></a>3343</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3344"></a>3344</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3345"></a>3345</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3346"></a>3346</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3347"></a>3347</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;no&nbsp;irreducibles&nbsp;were&nbsp;found,&nbsp;return&nbsp;the&nbsp;remainders.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3348"></a>3348</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;found&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3349"></a>3349</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(&nbsp;remainders:=&nbsp;remainders,&nbsp;irreducibles:=&nbsp;[]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3350"></a>3350</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3351"></a>3351</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3352"></a>3352</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Try&nbsp;to&nbsp;find&nbsp;new&nbsp;irreducibles&nbsp;by&nbsp;recursively&nbsp;calling&nbsp;the&nbsp;reduction.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3353"></a>3353</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;reduced:=&nbsp;ReducedClassFunctions(&nbsp;ordtbl,&nbsp;found,&nbsp;remainders&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3354"></a>3354</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3355"></a>3355</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;result.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3356"></a>3356</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(&nbsp;remainders:=&nbsp;reduced.remainders,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3357"></a>3357</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irreducibles:=&nbsp;Union(&nbsp;found,&nbsp;reduced.irreducibles&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3358"></a>3358</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3359"></a>3359</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3360"></a>3360</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3361"></a>3361</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3362"></a>3362</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3363"></a>3363</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ReducedCharacters(&nbsp;[&lt;ordtbl>,&nbsp;]&lt;constituents>,&nbsp;&lt;reducibles>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3364"></a>3364</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3365"></a>3365</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ReducedCharacters,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3366"></a>3366</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;two&nbsp;lists&nbsp;(of&nbsp;characters)",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3367"></a>3367</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList&nbsp;,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3368"></a>3368</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;constituents,&nbsp;reducibles&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3369"></a>3369</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;constituents&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3370"></a>3370</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(&nbsp;irreducibles:=&nbsp;[],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3371"></a>3371</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remainders:=&nbsp;ShallowCopy(&nbsp;reducibles&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3372"></a>3372</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsClassFunction(&nbsp;constituents[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3373"></a>3373</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ReducedCharacters(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3374"></a>3374</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UnderlyingCharacterTable(&nbsp;constituents[1]&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3375"></a>3375</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constituents,&nbsp;reducibles&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3376"></a>3376</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3377"></a>3377</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3378"></a>3378</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3379"></a>3379</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3380"></a>3380</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3381"></a>3381</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;ReducedCharacters,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3382"></a>3382</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;ordinary&nbsp;character&nbsp;table,&nbsp;and&nbsp;two&nbsp;lists&nbsp;of&nbsp;characters",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3383"></a>3383</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsOrdinaryTable,&nbsp;IsHomogeneousList&nbsp;,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3384"></a>3384</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;ordtbl,&nbsp;constituents,&nbsp;reducibles&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3385"></a>3385</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;normsquare,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3386"></a>3386</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;found,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3387"></a>3387</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;remainders,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3388"></a>3388</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3389"></a>3389</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;j,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3390"></a>3390</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nchars,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3391"></a>3391</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduced,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3392"></a>3392</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3393"></a>3393</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3394"></a>3394</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;normsquare:=&nbsp;List(&nbsp;constituents,&nbsp;x&nbsp;->&nbsp;ScalarProduct(&nbsp;ordtbl,&nbsp;x,&nbsp;x&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3395"></a>3395</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;found:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3396"></a>3396</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;remainders:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3397"></a>3397</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nchars:=&nbsp;Length(&nbsp;constituents&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3398"></a>3398</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;reducibles&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3399"></a>3399</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3400"></a>3400</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single:=&nbsp;reducibles[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3401"></a>3401</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;nchars&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3402"></a>3402</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;constituents[j][1]&nbsp;&lt;=&nbsp;single[1]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3403"></a>3403</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr:=&nbsp;ScalarProduct(&nbsp;ordtbl,&nbsp;single,&nbsp;constituents[j]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3404"></a>3404</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsInt(&nbsp;scpr&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3405"></a>3405</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scpr:=&nbsp;Int(&nbsp;scpr&nbsp;/&nbsp;normsquare[j]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3406"></a>3406</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;scpr&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3407"></a>3407</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single:=&nbsp;single&nbsp;-&nbsp;scpr&nbsp;*&nbsp;constituents[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3408"></a>3408</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3409"></a>3409</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3410"></a>3410</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;1,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3411"></a>3411</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ReducedCharacters:&nbsp;scalar&nbsp;product&nbsp;of&nbsp;X[",&nbsp;j,&nbsp;"]&nbsp;with&nbsp;Y[",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3412"></a>3412</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;"]&nbsp;not&nbsp;integral&nbsp;(ignore)"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3413"></a>3413</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3414"></a>3414</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3415"></a>3415</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3416"></a>3416</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3417"></a>3417</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAny(&nbsp;single,&nbsp;x&nbsp;->&nbsp;x&nbsp;&lt;>&nbsp;0&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3418"></a>3418</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ScalarProduct(&nbsp;ordtbl,&nbsp;single,&nbsp;single&nbsp;)&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3419"></a>3419</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;single[1]&nbsp;&lt;&nbsp;0&nbsp;then&nbsp;single:=&nbsp;-&nbsp;single;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3420"></a>3420</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;single&nbsp;in&nbsp;found&nbsp;and&nbsp;not&nbsp;single&nbsp;in&nbsp;constituents&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3421"></a>3421</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;2,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3422"></a>3422</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ReducedCharacters:&nbsp;irreducible&nbsp;character&nbsp;of",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3423"></a>3423</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;degree&nbsp;",&nbsp;single[1],&nbsp;"&nbsp;found"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3424"></a>3424</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;single&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3425"></a>3425</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetIsCharacter(&nbsp;single,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3426"></a>3426</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3427"></a>3427</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;found,&nbsp;single&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3428"></a>3428</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3429"></a>3429</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3430"></a>3430</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;remainders,&nbsp;single&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3431"></a>3431</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3432"></a>3432</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3433"></a>3433</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3434"></a>3434</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3435"></a>3435</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3436"></a>3436</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;no&nbsp;irreducibles&nbsp;were&nbsp;found,&nbsp;return&nbsp;the&nbsp;remainders.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3437"></a>3437</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;found&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3438"></a>3438</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(&nbsp;remainders:=&nbsp;remainders,&nbsp;irreducibles:=&nbsp;[]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3439"></a>3439</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3440"></a>3440</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3441"></a>3441</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Try&nbsp;to&nbsp;find&nbsp;new&nbsp;irreducibles&nbsp;by&nbsp;recursively&nbsp;calling&nbsp;the&nbsp;reduction.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3442"></a>3442</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;reduced:=&nbsp;ReducedCharacters(&nbsp;ordtbl,&nbsp;found,&nbsp;remainders&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3443"></a>3443</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3444"></a>3444</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;result.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3445"></a>3445</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(&nbsp;remainders:=&nbsp;reduced.remainders,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3446"></a>3446</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irreducibles:=&nbsp;Union(&nbsp;found,&nbsp;reduced.irreducibles&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3447"></a>3447</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3448"></a>3448</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3449"></a>3449</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3450"></a>3450</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3451"></a>3451</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3452"></a>3452</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;IrreducibleDifferences(&nbsp;&lt;tbl>,&nbsp;&lt;reducibles>,&nbsp;&lt;reducibles2>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3453"></a>3453</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;IrreducibleDifferences(&nbsp;&lt;tbl>,&nbsp;&lt;reducibles>,&nbsp;&lt;reducibles2>,&nbsp;&lt;scprmat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3454"></a>3454</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;IrreducibleDifferences(&nbsp;&lt;tbl>,&nbsp;&lt;reducibles>,&nbsp;\"triangle\"&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3455"></a>3455</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;IrreducibleDifferences(&nbsp;&lt;tbl>,&nbsp;&lt;reducibles>,&nbsp;\"triangle\",&nbsp;&lt;scprmat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3456"></a>3456</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3457"></a>3457</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;compute/consider&nbsp;scalar&nbsp;product&nbsp;of&nbsp;i-th&nbsp;and&nbsp;j-th&nbsp;character&nbsp;only&nbsp;if&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3458"></a>3458</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;norms&nbsp;have&nbsp;different&nbsp;parity!
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3459"></a>3459</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3460"></a>3460</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;IrreducibleDifferences,&nbsp;function(&nbsp;arg&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3461"></a>3461</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3462"></a>3462</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reducibles,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3463"></a>3463</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irreducibledifferences,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3464"></a>3464</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scprmatrix,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3465"></a>3465</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;j,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3466"></a>3466</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diff,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3467"></a>3467</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reducibles2,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3468"></a>3468</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;norms,&nbsp;norms2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3469"></a>3469</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3470"></a>3470</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;(&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;in&nbsp;[&nbsp;3,&nbsp;4&nbsp;]&nbsp;and&nbsp;IsOrdinaryTable(&nbsp;arg[1]&nbsp;)&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3471"></a>3471</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsList(&nbsp;arg[2]&nbsp;)&nbsp;and&nbsp;(&nbsp;IsList(&nbsp;arg[3]&nbsp;)&nbsp;or&nbsp;IsString(&nbsp;arg[3]&nbsp;)&nbsp;)&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3472"></a>3472</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;(&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;4&nbsp;and&nbsp;not&nbsp;IsList(&nbsp;arg[4]&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3473"></a>3473</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"usage:&nbsp;IrreducibleDifferences(tbl,reducibles,\"triangle\")\n",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3474"></a>3474</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"resp.&nbsp;&nbsp;&nbsp;IrreducibleDifferences(tbl,reducibles,\"triangle\",scprmat)",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3475"></a>3475</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\n&nbsp;resp.&nbsp;&nbsp;&nbsp;&nbsp;IrreducibleDifferences(tbl,reducibles,reducibles2)\nresp.",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3476"></a>3476</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;&nbsp;&nbsp;IrreducibleDifferences(tbl,reducibles,reducibles2,scprmat)"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3477"></a>3477</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3478"></a>3478</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3479"></a>3479</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3480"></a>3480</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;reducibles:=&nbsp;arg[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3481"></a>3481</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;irreducibledifferences:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3482"></a>3482</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsString(&nbsp;arg[3]&nbsp;)&nbsp;then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;"triangle"
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3483"></a>3483</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;3&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3484"></a>3484</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scprmatrix:=&nbsp;MatScalarProducts(&nbsp;tbl,&nbsp;reducibles&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3485"></a>3485</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3486"></a>3486</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scprmatrix:=&nbsp;arg[4];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3487"></a>3487</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3488"></a>3488</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;scprmatrix&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3489"></a>3489</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;i-1&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3490"></a>3490</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;scprmatrix[i][i]&nbsp;+&nbsp;scprmatrix[j][j]&nbsp;-&nbsp;2*scprmatrix[i][j]&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3491"></a>3491</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;reducibles[i][1]&nbsp;>&nbsp;reducibles[j][1]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3492"></a>3492</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diff:=&nbsp;reducibles[i]&nbsp;-&nbsp;reducibles[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3493"></a>3493</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;2,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3494"></a>3494</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"IrreducibleDifferences:&nbsp;X[",i,&nbsp;"]&nbsp;-&nbsp;X[",j,&nbsp;"]&nbsp;found"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3495"></a>3495</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3496"></a>3496</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diff:=&nbsp;reducibles[j]&nbsp;-&nbsp;reducibles[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3497"></a>3497</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;2,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3498"></a>3498</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"IrreducibleDifferences:&nbsp;X[",j,&nbsp;"]&nbsp;-&nbsp;X[",i,&nbsp;"]&nbsp;found"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3499"></a>3499</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3500"></a>3500</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;diff&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3501"></a>3501</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetIsCharacter(&nbsp;diff,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3502"></a>3502</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3503"></a>3503</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;irreducibledifferences,&nbsp;diff&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3504"></a>3504</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3505"></a>3505</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3506"></a>3506</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3507"></a>3507</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;not&nbsp;"triangle"
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3508"></a>3508</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reducibles2:=&nbsp;arg[3];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3509"></a>3509</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;3&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3510"></a>3510</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scprmatrix:=&nbsp;MatScalarProducts(&nbsp;tbl,&nbsp;reducibles,&nbsp;reducibles2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3511"></a>3511</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3512"></a>3512</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scprmatrix:=&nbsp;arg[4];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3513"></a>3513</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3514"></a>3514</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;norms&nbsp;:=&nbsp;List(&nbsp;reducibles&nbsp;,&nbsp;x&nbsp;->&nbsp;ScalarProduct(tbl,x,x)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3515"></a>3515</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;norms2:=&nbsp;List(&nbsp;reducibles2,&nbsp;x&nbsp;->&nbsp;ScalarProduct(tbl,x,x)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3516"></a>3516</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;norms&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3517"></a>3517</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;norms2&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3518"></a>3518</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;norms[i]&nbsp;+&nbsp;norms2[j]&nbsp;-&nbsp;2&nbsp;*&nbsp;scprmatrix[i][j]&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3519"></a>3519</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;reducibles[j][1]&nbsp;>&nbsp;reducibles2[i][1]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3520"></a>3520</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diff:=&nbsp;reducibles[j]&nbsp;-&nbsp;reducibles2[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3521"></a>3521</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;2,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3522"></a>3522</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"IrreducibleDifferences:&nbsp;X[",j,&nbsp;"]&nbsp;-&nbsp;Y[",i,&nbsp;"]&nbsp;found"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3523"></a>3523</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3524"></a>3524</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diff:=&nbsp;reducibles2[i]&nbsp;-&nbsp;reducibles[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3525"></a>3525</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;2,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3526"></a>3526</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"IrreducibleDifferences:&nbsp;Y[",i,&nbsp;"]&nbsp;-&nbsp;X[",j,&nbsp;"]&nbsp;found"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3527"></a>3527</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3528"></a>3528</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;diff&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3529"></a>3529</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetIsCharacter(&nbsp;diff,&nbsp;true&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3530"></a>3530</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3531"></a>3531</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;irreducibledifferences,&nbsp;diff&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3532"></a>3532</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3533"></a>3533</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3534"></a>3534</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3535"></a>3535</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3536"></a>3536</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;irreducibledifferences;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3537"></a>3537</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3538"></a>3538</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3539"></a>3539</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3540"></a>3540</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3541"></a>3541</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3542"></a>3542</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;11.&nbsp;Symmetrizations&nbsp;of&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3543"></a>3543</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3544"></a>3544</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3545"></a>3545</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3546"></a>3546</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3547"></a>3547</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3548"></a>3548</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;Symmetrizations(&nbsp;[&lt;tbl>,&nbsp;]&lt;characters>,&nbsp;&lt;n>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3549"></a>3549</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;Symmetrizations(&nbsp;[&lt;tbl>,&nbsp;]&lt;characters>,&nbsp;&lt;Sn>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3550"></a>3550</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;Symmetrizations(&nbsp;&lt;tbl>,&nbsp;&lt;characters>,&nbsp;&lt;arec>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3551"></a>3551</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3552"></a>3552</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Symmetrizations,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3553"></a>3553</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;homogeneous&nbsp;list&nbsp;(of&nbsp;class&nbsp;functions)&nbsp;and&nbsp;positive&nbsp;integer",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3554"></a>3554</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3555"></a>3555</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;list,&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3556"></a>3556</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3557"></a>3557</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3558"></a>3558</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsClassFunction(&nbsp;list[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3559"></a>3559</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Symmetrizations(&nbsp;UnderlyingCharacterTable(&nbsp;list[1]&nbsp;),&nbsp;list,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3560"></a>3560</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3561"></a>3561</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3562"></a>3562</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3563"></a>3563</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3564"></a>3564</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3565"></a>3565</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Symmetrizations,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3566"></a>3566</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;homogeneous&nbsp;list&nbsp;(of&nbsp;class&nbsp;functions)&nbsp;and&nbsp;character&nbsp;table",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3567"></a>3567</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList,&nbsp;IsOrdinaryTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3568"></a>3568</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;list,&nbsp;Sn&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3569"></a>3569</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;list&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3570"></a>3570</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3571"></a>3571</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsClassFunction(&nbsp;list[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3572"></a>3572</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Symmetrizations(&nbsp;UnderlyingCharacterTable(&nbsp;list[1]&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3573"></a>3573</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list,&nbsp;Sn&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3574"></a>3574</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3575"></a>3575</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3576"></a>3576</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3577"></a>3577</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3578"></a>3578</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3579"></a>3579</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Symmetrizations,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3580"></a>3580</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;char.&nbsp;table,&nbsp;homog.&nbsp;list&nbsp;(of&nbsp;class&nbsp;functions),&nbsp;and&nbsp;pos.&nbsp;integer",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3581"></a>3581</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsPosInt&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3582"></a>3582</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;characters,&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3583"></a>3583</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;gensymm,&nbsp;classparam,&nbsp;siz,&nbsp;classes;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3584"></a>3584</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3585"></a>3585</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;gensymm:=&nbsp;CharTableSymmetric;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3586"></a>3586</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;classparam:=&nbsp;gensymm.classparam[1](&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3587"></a>3587</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;siz:=&nbsp;gensymm.size(&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3588"></a>3588</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;classes:=&nbsp;List(&nbsp;classparam,&nbsp;p&nbsp;->&nbsp;siz&nbsp;/&nbsp;gensymm.centralizers[1](&nbsp;n,&nbsp;p&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3589"></a>3589</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3590"></a>3590</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Symmetrizations(&nbsp;tbl,&nbsp;characters,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3591"></a>3591</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rec(&nbsp;classparam&nbsp;&nbsp;:=&nbsp;List(&nbsp;classparam,&nbsp;x&nbsp;->&nbsp;[&nbsp;1,&nbsp;x&nbsp;]&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3592"></a>3592</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symmirreds&nbsp;&nbsp;:=&nbsp;gensymm.matrix(&nbsp;n&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3593"></a>3593</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symmclasses&nbsp;:=&nbsp;classes,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3594"></a>3594</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symmorder&nbsp;&nbsp;&nbsp;:=&nbsp;siz&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3595"></a>3595</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3596"></a>3596</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3597"></a>3597</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;Symmetrizations,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3598"></a>3598</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;char.&nbsp;table,&nbsp;homog.&nbsp;list&nbsp;(of&nbsp;class&nbsp;functions),&nbsp;and&nbsp;table&nbsp;of&nbsp;Sn",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3599"></a>3599</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsOrdinaryTable&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3600"></a>3600</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;characters,&nbsp;Sn&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3601"></a>3601</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3602"></a>3602</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;HasClassParameters(&nbsp;Sn&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3603"></a>3603</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"partitions&nbsp;corresponding&nbsp;to&nbsp;classes&nbsp;must&nbsp;be&nbsp;stored",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3604"></a>3604</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;as&nbsp;`ClassParameters(&nbsp;&lt;Sn>&nbsp;)'"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3605"></a>3605</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3606"></a>3606</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3607"></a>3607</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Symmetrizations(&nbsp;tbl,&nbsp;characters,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3608"></a>3608</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rec(&nbsp;classparam&nbsp;&nbsp;:=&nbsp;ClassParameters(&nbsp;Sn&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3609"></a>3609</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symmirreds&nbsp;&nbsp;:=&nbsp;List(&nbsp;Irr(&nbsp;Sn&nbsp;),&nbsp;ValuesOfClassFunction&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3610"></a>3610</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symmclasses&nbsp;:=&nbsp;SizesConjugacyClasses(&nbsp;Sn&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3611"></a>3611</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symmorder&nbsp;&nbsp;&nbsp;:=&nbsp;Size(&nbsp;Sn&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3612"></a>3612</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3613"></a>3613</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3614"></a>3614</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;Symmetrizations,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3615"></a>3615</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;char.&nbsp;table,&nbsp;homog.&nbsp;list&nbsp;(of&nbsp;class&nbsp;functions),&nbsp;and&nbsp;record",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3616"></a>3616</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsCharacterTable,&nbsp;IsHomogeneousList,&nbsp;IsRecord&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3617"></a>3617</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;characters,&nbsp;arec&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3618"></a>3618</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,&nbsp;j,&nbsp;l,&nbsp;n,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3619"></a>3619</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl_powermap,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;computed&nbsp;power&nbsp;maps&nbsp;of&nbsp;'tbl'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3620"></a>3620</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cyclestruct,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3621"></a>3621</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;classparam,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3622"></a>3622</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symmirreds,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3623"></a>3623</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symmclasses,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3624"></a>3624</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symmorder,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3625"></a>3625</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cycl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3626"></a>3626</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symmetrizations,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3627"></a>3627</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chi,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3628"></a>3628</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;psi,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3629"></a>3629</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;powermap,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3630"></a>3630</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prodmatrix,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3631"></a>3631</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3632"></a>3632</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3633"></a>3633</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3634"></a>3634</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3635"></a>3635</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;classparam&nbsp;&nbsp;:=&nbsp;arec.classparam;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3636"></a>3636</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;symmirreds&nbsp;&nbsp;:=&nbsp;arec.symmirreds;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3637"></a>3637</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;symmclasses&nbsp;:=&nbsp;arec.symmclasses;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3638"></a>3638</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;symmorder&nbsp;&nbsp;&nbsp;:=&nbsp;arec.symmorder;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3639"></a>3639</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3640"></a>3640</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;cyclestruct:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3641"></a>3641</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;classparam&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3642"></a>3642</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;classparam[i][2]&nbsp;)&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3643"></a>3643</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;classparam[i][2][1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3644"></a>3644</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3645"></a>3645</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cyclestruct[i]:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3646"></a>3646</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Maximum(&nbsp;classparam[i][2]&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3647"></a>3647</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cyclestruct[i][j]:=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3648"></a>3648</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3649"></a>3649</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;classparam[i][2]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3650"></a>3650</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cyclestruct[i][j]:=&nbsp;cyclestruct[i][j]&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3651"></a>3651</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3652"></a>3652</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3653"></a>3653</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3654"></a>3654</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl_powermap:=&nbsp;ShallowCopy(&nbsp;ComputedPowerMaps(&nbsp;tbl&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3655"></a>3655</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;better&nbsp;do&nbsp;the&nbsp;computation&nbsp;of&nbsp;necessary&nbsp;power&nbsp;maps&nbsp;only&nbsp;once!
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3656"></a>3656</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3657"></a>3657</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;necessary&nbsp;power&nbsp;maps.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3658"></a>3658</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3659"></a>3659</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsBound(&nbsp;tbl_powermap[i]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3660"></a>3660</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl_powermap[i]:=&nbsp;PowerMap(&nbsp;tbl,&nbsp;i&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3661"></a>3661</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3662"></a>3662</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3663"></a>3663</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3664"></a>3664</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;powermap:=&nbsp;tbl_powermap;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3665"></a>3665</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;symmetrizations:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3666"></a>3666</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;chi&nbsp;in&nbsp;characters&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3667"></a>3667</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3668"></a>3668</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Symmetrize&nbsp;the&nbsp;character&nbsp;`chi'&nbsp;of&nbsp;`tbl'&nbsp;...
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3669"></a>3669</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prodmatrix:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3670"></a>3670</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;characters[1]&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3671"></a>3671</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prodmatrix[i]:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3672"></a>3672</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;symmclasses&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3673"></a>3673</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:=&nbsp;symmclasses[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3674"></a>3674</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cycl:=&nbsp;cyclestruct[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3675"></a>3675</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;l&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;cycl&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3676"></a>3676</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;cycl[l]&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3677"></a>3677</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsInt(&nbsp;powermap[l][i]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3678"></a>3678</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:=&nbsp;value&nbsp;*&nbsp;(&nbsp;chi[&nbsp;powermap[l][i]&nbsp;]&nbsp;^&nbsp;cycl[l]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3679"></a>3679</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3680"></a>3680</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val:=&nbsp;CompositionMaps(&nbsp;chi,&nbsp;powermap[l][i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3681"></a>3681</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsInt(&nbsp;val&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3682"></a>3682</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:=&nbsp;value&nbsp;*&nbsp;(&nbsp;val&nbsp;^&nbsp;cycl[l]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3683"></a>3683</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3684"></a>3684</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:=&nbsp;Unknown();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3685"></a>3685</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3686"></a>3686</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3687"></a>3687</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3688"></a>3688</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3689"></a>3689</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prodmatrix[i][j]:=&nbsp;value;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3690"></a>3690</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3691"></a>3691</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3692"></a>3692</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3693"></a>3693</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;...&nbsp;with&nbsp;the&nbsp;character&nbsp;`psi'&nbsp;...
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3694"></a>3694</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;psi&nbsp;in&nbsp;symmirreds&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3695"></a>3695</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3696"></a>3696</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;chi&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3697"></a>3697</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3698"></a>3698</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;...&nbsp;at&nbsp;class&nbsp;`i'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3699"></a>3699</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single[i]:=&nbsp;psi&nbsp;*&nbsp;prodmatrix[i]&nbsp;/&nbsp;symmorder;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3700"></a>3700</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;(&nbsp;IsCycInt(&nbsp;single[i]&nbsp;)&nbsp;or&nbsp;IsUnknown(&nbsp;single[i]&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3701"></a>3701</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single[i]:=&nbsp;Unknown();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3702"></a>3702</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Print(&nbsp;"#E&nbsp;Symmetrizations:&nbsp;value&nbsp;not&nbsp;dividing&nbsp;group&nbsp;order,",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3703"></a>3703</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;set&nbsp;to&nbsp;",&nbsp;single[i],&nbsp;"\n"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3704"></a>3704</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3705"></a>3705</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3706"></a>3706</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3707"></a>3707</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;chi&nbsp;)&nbsp;and&nbsp;single[1]&nbsp;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3708"></a>3708</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single:=&nbsp;ClassFunctionSameType(&nbsp;tbl,&nbsp;chi,&nbsp;single&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3709"></a>3709</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;HasIsVirtualCharacter(&nbsp;chi&nbsp;)&nbsp;and&nbsp;IsVirtualCharacter(&nbsp;chi&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3710"></a>3710</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;single:=&nbsp;VirtualCharacter(&nbsp;tbl,&nbsp;single&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3711"></a>3711</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3712"></a>3712</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;symmetrizations,&nbsp;single&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3713"></a>3713</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3714"></a>3714</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3715"></a>3715</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3716"></a>3716</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3717"></a>3717</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;symmetrizations.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3718"></a>3718</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;symmetrizations;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3719"></a>3719</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3720"></a>3720</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3721"></a>3721</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3722"></a>3722</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3723"></a>3723</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3724"></a>3724</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;SymmetricParts(&nbsp;&lt;tbl>,&nbsp;&lt;characters>,&nbsp;&lt;n>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3725"></a>3725</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3726"></a>3726</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;SymmetricParts,&nbsp;function(&nbsp;tbl,&nbsp;characters,&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3727"></a>3727</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3728"></a>3728</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3729"></a>3729</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3730"></a>3730</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nccl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3731"></a>3731</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exponents,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3732"></a>3732</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symcentralizers,&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;symmetrizations,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3733"></a>3733</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symmetricparts,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3734"></a>3734</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chi,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;'characters'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3735"></a>3735</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sym,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3736"></a>3736</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3737"></a>3737</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factor,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3738"></a>3738</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;powermap;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;computed&nbsp;power&nbsp;maps&nbsp;of&nbsp;'tbl'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3739"></a>3739</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3740"></a>3740</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;characters&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3741"></a>3741</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3742"></a>3742</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3743"></a>3743</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3744"></a>3744</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nccl:=&nbsp;NrConjugacyClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3745"></a>3745</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;exponents:=&nbsp;Partitions(&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3746"></a>3746</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;symcentralizers:=&nbsp;CharTableSymmetric.centralizers[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3747"></a>3747</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;symcentralizers:=&nbsp;List(&nbsp;exponents,&nbsp;x&nbsp;->&nbsp;symcentralizers(&nbsp;n,&nbsp;x&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3748"></a>3748</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3749"></a>3749</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;exponents&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3750"></a>3750</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3751"></a>3751</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Transform&nbsp;partitions&nbsp;to&nbsp;exponent&nbsp;vectors.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3752"></a>3752</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;At&nbsp;position&nbsp;$i$&nbsp;we&nbsp;store&nbsp;the&nbsp;number&nbsp;of&nbsp;cycles&nbsp;of&nbsp;length&nbsp;$i$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3753"></a>3753</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3754"></a>3754</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Maximum(&nbsp;exponents[i]&nbsp;)&nbsp;]&nbsp;do&nbsp;exp[j]:=&nbsp;0;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3755"></a>3755</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;exponents[i]&nbsp;do&nbsp;exp[j]:=&nbsp;exp[j]&nbsp;+&nbsp;1;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3756"></a>3756</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exponents[i]:=&nbsp;exp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3757"></a>3757</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3758"></a>3758</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3759"></a>3759</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3760"></a>3760</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;necessary&nbsp;power&nbsp;maps.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3761"></a>3761</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;powermap:=&nbsp;ComputedPowerMaps(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3762"></a>3762</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3763"></a>3763</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsBound(&nbsp;powermap[i]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3764"></a>3764</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;powermap[i]:=&nbsp;PowerMap(&nbsp;tbl,&nbsp;i&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3765"></a>3765</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3766"></a>3766</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3767"></a>3767</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3768"></a>3768</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;symmetricparts:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3769"></a>3769</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;chi&nbsp;in&nbsp;characters&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3770"></a>3770</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3771"></a>3771</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;2,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3772"></a>3772</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"SymmetricParts:&nbsp;chi[.]"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3773"></a>3773</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sym:=&nbsp;List(&nbsp;chi,&nbsp;x&nbsp;->&nbsp;0&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3774"></a>3774</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3775"></a>3775</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Loop&nbsp;over&nbsp;the&nbsp;conjugacy&nbsp;classes&nbsp;of&nbsp;the&nbsp;symmetric&nbsp;group.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3776"></a>3776</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;symcentralizers&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3777"></a>3777</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3778"></a>3778</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp:=&nbsp;exponents[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3779"></a>3779</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3780"></a>3780</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;nccl&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3781"></a>3781</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factor:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3782"></a>3782</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;exp&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3783"></a>3783</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(&nbsp;exp[i]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3784"></a>3784</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factor:=&nbsp;factor&nbsp;*&nbsp;chi[&nbsp;powermap[i][k]&nbsp;]^exp[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3785"></a>3785</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3786"></a>3786</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3787"></a>3787</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sym[k]:=&nbsp;sym[k]&nbsp;+&nbsp;factor&nbsp;/&nbsp;symcentralizers[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3788"></a>3788</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3789"></a>3789</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3790"></a>3790</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3791"></a>3791</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;chi&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3792"></a>3792</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sym:=&nbsp;ClassFunctionSameType(&nbsp;tbl,&nbsp;chi,&nbsp;sym&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3793"></a>3793</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3794"></a>3794</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;symmetricparts,&nbsp;sym&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3795"></a>3795</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3796"></a>3796</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3797"></a>3797</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3798"></a>3798</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;symmetrizations.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3799"></a>3799</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;symmetricparts;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3800"></a>3800</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3801"></a>3801</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3802"></a>3802</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3803"></a>3803</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3804"></a>3804</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3805"></a>3805</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;AntiSymmetricParts(&nbsp;&lt;tbl>,&nbsp;&lt;character>,&nbsp;&lt;n>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3806"></a>3806</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3807"></a>3807</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;AntiSymmetricParts,&nbsp;function(&nbsp;tbl,&nbsp;characters,&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3808"></a>3808</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3809"></a>3809</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3810"></a>3810</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3811"></a>3811</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nccl,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3812"></a>3812</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exponents,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3813"></a>3813</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symcentralizers,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3814"></a>3814</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;antisymmetricparts,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3815"></a>3815</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chi,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3816"></a>3816</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sym,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3817"></a>3817</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3818"></a>3818</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factor,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3819"></a>3819</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;powermap;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3820"></a>3820</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3821"></a>3821</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;characters&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3822"></a>3822</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3823"></a>3823</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3824"></a>3824</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3825"></a>3825</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nccl:=&nbsp;NrConjugacyClasses(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3826"></a>3826</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;exponents:=&nbsp;Partitions(&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3827"></a>3827</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;symcentralizers:=&nbsp;CharTableSymmetric.centralizers[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3828"></a>3828</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;symcentralizers:=&nbsp;List(&nbsp;exponents,&nbsp;x&nbsp;->&nbsp;symcentralizers(&nbsp;n,&nbsp;x&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3829"></a>3829</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3830"></a>3830</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;exponents&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3831"></a>3831</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3832"></a>3832</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Transform&nbsp;partitions&nbsp;to&nbsp;exponent&nbsp;vectors.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3833"></a>3833</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;At&nbsp;position&nbsp;$i$&nbsp;we&nbsp;store&nbsp;the&nbsp;number&nbsp;of&nbsp;cycles&nbsp;of&nbsp;length&nbsp;$i$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3834"></a>3834</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3835"></a>3835</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3836"></a>3836</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Maximum(&nbsp;exponents[i]&nbsp;)&nbsp;]&nbsp;do&nbsp;exp[j]:=&nbsp;0;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3837"></a>3837</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;exponents[i]&nbsp;do&nbsp;exp[j]:=&nbsp;exp[j]&nbsp;+&nbsp;1;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3838"></a>3838</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exponents[i]:=&nbsp;exp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3839"></a>3839</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3840"></a>3840</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3841"></a>3841</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3842"></a>3842</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;necessary&nbsp;power&nbsp;maps.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3843"></a>3843</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;powermap:=&nbsp;ComputedPowerMaps(&nbsp;tbl&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3844"></a>3844</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;n&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3845"></a>3845</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsBound(&nbsp;powermap[i]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3846"></a>3846</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;powermap[i]:=&nbsp;PowerMap(&nbsp;tbl,&nbsp;i&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3847"></a>3847</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3848"></a>3848</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3849"></a>3849</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3850"></a>3850</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;symmetrizations.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3851"></a>3851</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;antisymmetricparts:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3852"></a>3852</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;chi&nbsp;in&nbsp;characters&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3853"></a>3853</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3854"></a>3854</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoCharacterTable,&nbsp;2,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3855"></a>3855</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"AntiSymmetricParts:&nbsp;chi[.]"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3856"></a>3856</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sym:=&nbsp;List(&nbsp;chi,&nbsp;x&nbsp;->&nbsp;0&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3857"></a>3857</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;exponents&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3858"></a>3858</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3859"></a>3859</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp:=&nbsp;exponents[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3860"></a>3860</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3861"></a>3861</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;nccl&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3862"></a>3862</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factor:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3863"></a>3863</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;exp&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3864"></a>3864</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(&nbsp;exp[i]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3865"></a>3865</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i&nbsp;mod&nbsp;2&nbsp;=&nbsp;0&nbsp;and&nbsp;exp[i]&nbsp;mod&nbsp;2&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3866"></a>3866</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factor:=&nbsp;-factor&nbsp;*&nbsp;chi[&nbsp;powermap[i][k]&nbsp;]^exp[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3867"></a>3867</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3868"></a>3868</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;factor:=&nbsp;&nbsp;factor&nbsp;*&nbsp;chi[&nbsp;powermap[i][k]&nbsp;]^exp[i];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3869"></a>3869</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3870"></a>3870</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3871"></a>3871</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3872"></a>3872</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sym[k]:=&nbsp;sym[k]&nbsp;+&nbsp;factor&nbsp;/&nbsp;symcentralizers[j];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3873"></a>3873</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3874"></a>3874</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3875"></a>3875</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3876"></a>3876</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;chi&nbsp;)&nbsp;and&nbsp;sym[1]&nbsp;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3877"></a>3877</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sym:=&nbsp;ClassFunctionSameType(&nbsp;tbl,&nbsp;chi,&nbsp;sym&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3878"></a>3878</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;HasIsVirtualCharacter(&nbsp;chi&nbsp;)&nbsp;and&nbsp;IsVirtualCharacter(&nbsp;chi&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3879"></a>3879</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sym:=&nbsp;VirtualCharacter(&nbsp;tbl,&nbsp;sym&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3880"></a>3880</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3881"></a>3881</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;antisymmetricparts,&nbsp;sym&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3882"></a>3882</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3883"></a>3883</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3884"></a>3884</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3885"></a>3885</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;symmetrizations.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3886"></a>3886</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;antisymmetricparts;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3887"></a>3887</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3888"></a>3888</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3889"></a>3889</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3890"></a>3890</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3891"></a>3891</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3892"></a>3892</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;RefinedSymmetrizations(&nbsp;&lt;tbl>,&nbsp;&lt;chars>,&nbsp;&lt;m>,&nbsp;&lt;func>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3893"></a>3893</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3894"></a>3894</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;(Note:&nbsp;It&nbsp;suffices&nbsp;to&nbsp;change&nbsp;`F2'&nbsp;and&nbsp;`F4'&nbsp;in&nbsp;order&nbsp;to&nbsp;get&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3895"></a>3895</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;symplectic&nbsp;components&nbsp;from&nbsp;the&nbsp;orthogonal&nbsp;ones.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3896"></a>3896</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3897"></a>3897</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;We&nbsp;have&nbsp;(see&nbsp;J.S.&nbsp;Frame,&nbsp;Recursive&nbsp;computation&nbsp;of&nbsp;tensor&nbsp;power
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3898"></a>3898</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;components,&nbsp;Bayreuther&nbsp;Mathematische&nbsp;Schriften&nbsp;10,&nbsp;153--159)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3899"></a>3899</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3900"></a>3900</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;\begintt
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3901"></a>3901</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;component&nbsp;&nbsp;&nbsp;orthogonal&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;symplectic
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3902"></a>3902</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L0&nbsp;&nbsp;(&nbsp;=&nbsp;1&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3903"></a>3903</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L1
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3904"></a>3904</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L11-L0
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3905"></a>3905</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L2-L0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L2
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3906"></a>3906</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M111&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L111&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L111-L1
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3907"></a>3907</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L21-L1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L21-L1
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3908"></a>3908</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L3-L1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L3
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3909"></a>3909</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M1111&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L1111&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L1111-L11
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3910"></a>3910</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M211&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L211-L11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L211-L11-L2+L0
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3911"></a>3911</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L22-L2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L22-L11
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3912"></a>3912</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M31&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L31-L2-L11+L0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L31-L2
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3913"></a>3913</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L4-L2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L4
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3914"></a>3914</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M11111&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L11111&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L11111-L111
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3915"></a>3915</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M2111&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L2111-L111&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L2111-L111-L21+L1
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3916"></a>3916</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M221&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L221-L21&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L221-L111-L21+L1
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3917"></a>3917</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M311&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L311-L21-L111+L1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L311-L21-L3+L1
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3918"></a>3918</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L32-L3-L21+L1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L32-L21
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3919"></a>3919</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M41&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L41-L3-L21+L1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L41-L3
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3920"></a>3920</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L5-L3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L5
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3921"></a>3921</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M111111&nbsp;&nbsp;&nbsp;=&nbsp;L111111&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L111111-L1111
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3922"></a>3922</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M21111&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L21111-L1111&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L21111-L1111-L211+L11
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3923"></a>3923</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M2211&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L2211-L211&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L2211-L1111-L211-L22+L11+L2
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3924"></a>3924</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M3111&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L3111-L211-L1111+L11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L3111-L211-L31+L11+L2-L0
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3925"></a>3925</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M222&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L222-L22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L222-L211+L11-L0
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3926"></a>3926</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M321&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L321-L31-L22-L211+L2+L11&nbsp;&nbsp;L321-L31-L22-L211+L2+L11
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3927"></a>3927</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L33-L31+L2-L0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L33-L22
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3928"></a>3928</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M411&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L411-L31-L211+L2+L11-L0&nbsp;&nbsp;&nbsp;L411-L31-L4+L2
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3929"></a>3929</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M42&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L42-L4-L31-L22+L2+L11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L42-L31
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3930"></a>3930</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L51-L4-L31+L2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L51-L4
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3931"></a>3931</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;M6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;L6-L4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L6
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3932"></a>3932</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;\endtt
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3933"></a>3933</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3934"></a>3934</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;RefinedSymmetrizations,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3935"></a>3935</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;tbl,&nbsp;chars,&nbsp;m,&nbsp;func&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3936"></a>3936</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,&nbsp;classes,&nbsp;components,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3937"></a>3937</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F2,&nbsp;F3,&nbsp;F4,&nbsp;F5,&nbsp;F6,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3938"></a>3938</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M1,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3939"></a>3939</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M2,&nbsp;M11,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3940"></a>3940</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M3,&nbsp;M21,&nbsp;M111,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3941"></a>3941</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M4,&nbsp;M31,&nbsp;M22,&nbsp;M211,&nbsp;M1111,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3942"></a>3942</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M5,&nbsp;M41,&nbsp;M32,&nbsp;M311,&nbsp;M221,&nbsp;M2111,&nbsp;M11111,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3943"></a>3943</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M6,&nbsp;M51,&nbsp;M42,&nbsp;M411,&nbsp;M33,&nbsp;M321,&nbsp;M3111,&nbsp;M222,&nbsp;M2211,&nbsp;M21111,&nbsp;M111111;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3944"></a>3944</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3945"></a>3945</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Linear&nbsp;characters&nbsp;are&nbsp;not&nbsp;allowed&nbsp;since&nbsp;their&nbsp;symmetrizations&nbsp;need&nbsp;not
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3946"></a>3946</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;to&nbsp;be&nbsp;proper&nbsp;characters.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3947"></a>3947</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;chars:=&nbsp;Filtered(&nbsp;chars,&nbsp;x&nbsp;->&nbsp;1&nbsp;&lt;&nbsp;x[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3948"></a>3948</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;components:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3949"></a>3949</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;classes:=&nbsp;[&nbsp;1&nbsp;..&nbsp;NrConjugacyClasses(&nbsp;tbl&nbsp;)&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3950"></a>3950</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3951"></a>3951</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;M1&nbsp;in&nbsp;chars&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3952"></a>3952</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3953"></a>3953</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F2&nbsp;:=&nbsp;MinusCharacter(&nbsp;M1,&nbsp;PowerMap(&nbsp;tbl,&nbsp;2&nbsp;),&nbsp;2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3954"></a>3954</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3955"></a>3955</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;orthogonal&nbsp;case:&nbsp;'M11&nbsp;=&nbsp;F2'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3956"></a>3956</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;symplectic&nbsp;case:&nbsp;'M11&nbsp;=&nbsp;F2&nbsp;-&nbsp;1'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3957"></a>3957</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M11:=&nbsp;func(&nbsp;F2,&nbsp;1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3958"></a>3958</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M2&nbsp;:=&nbsp;List(&nbsp;classes,&nbsp;x&nbsp;->&nbsp;M1[x]^2&nbsp;-&nbsp;M11[x]&nbsp;-&nbsp;1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3959"></a>3959</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3960"></a>3960</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;components,&nbsp;M11&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3961"></a>3961</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;components,&nbsp;M2&nbsp;&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3962"></a>3962</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3963"></a>3963</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;>&nbsp;2&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3964"></a>3964</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3965"></a>3965</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F3:=&nbsp;&nbsp;&nbsp;&nbsp;MinusCharacter(&nbsp;M1,&nbsp;PowerMap(&nbsp;tbl,&nbsp;3&nbsp;),&nbsp;3&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3966"></a>3966</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M21:=&nbsp;&nbsp;&nbsp;F3&nbsp;-&nbsp;M1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3967"></a>3967</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M111:=&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x&nbsp;->&nbsp;M1[x]&nbsp;*&nbsp;M11[x]&nbsp;-&nbsp;F3[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3968"></a>3968</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M3:=&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x&nbsp;->&nbsp;M1[x]&nbsp;*&nbsp;M2[x]&nbsp;&nbsp;-&nbsp;F3[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3969"></a>3969</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3970"></a>3970</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;components,&nbsp;[&nbsp;M21,&nbsp;M111,&nbsp;M3&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3971"></a>3971</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3972"></a>3972</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;>&nbsp;3&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3973"></a>3973</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3974"></a>3974</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F4:=&nbsp;&nbsp;&nbsp;&nbsp;MinusCharacter(&nbsp;F2,&nbsp;PowerMap(&nbsp;tbl,&nbsp;2&nbsp;),&nbsp;2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3975"></a>3975</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3976"></a>3976</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;orthogonal&nbsp;case:&nbsp;'F4&nbsp;:=&nbsp;F4'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3977"></a>3977</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;symplectic&nbsp;case:&nbsp;'F4&nbsp;:=&nbsp;F4&nbsp;-&nbsp;M2'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3978"></a>3978</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F4:=&nbsp;&nbsp;&nbsp;&nbsp;func(&nbsp;F4,&nbsp;M2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3979"></a>3979</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M211:=&nbsp;&nbsp;F4&nbsp;-&nbsp;M11;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3980"></a>3980</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M31:=&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x&nbsp;->&nbsp;M11[x]*M2[x]-F4[x]-M2[x]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3981"></a>3981</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M22:=&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x&nbsp;->&nbsp;M1[x]*M21[x]-F4[x]-M2[x]-M31[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3982"></a>3982</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M1111:=&nbsp;List(&nbsp;classes,&nbsp;x&nbsp;->&nbsp;M1[x]*M111[x]-F4[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3983"></a>3983</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M4:=&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x&nbsp;->&nbsp;M1[x]*M3[x]-M31[x]-M2[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3984"></a>3984</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3985"></a>3985</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;components,&nbsp;[&nbsp;M211,&nbsp;M31,&nbsp;M22,&nbsp;M1111,&nbsp;M4&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3986"></a>3986</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3987"></a>3987</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;>&nbsp;4&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3988"></a>3988</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3989"></a>3989</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F5:=&nbsp;MinusCharacter(&nbsp;M1,&nbsp;PowerMap(&nbsp;tbl,&nbsp;5&nbsp;),&nbsp;5&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3990"></a>3990</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M2111:=&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;F5[x]-M2[x]*F3[x]-M1[x]*M11[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3991"></a>3991</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M311:=&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;M2[x]*M111[x]-M2111[x]-M21[x]
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3992"></a>3992</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-M111[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3993"></a>3993</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M221:=&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;M1[x]*M211[x]-M2[x]*M111[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3994"></a>3994</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M11111:=&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;M1[x]*M1111[x]-M2111[x]-M111[x]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3995"></a>3995</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M32:=&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;M1[x]*M22[x]-M221[x]-M21[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3996"></a>3996</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M41:=&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;M11[x]*M3[x]-M311[x]-M21[x]
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3997"></a>3997</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-M3[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3998"></a>3998</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M5:=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;M1[x]*M4[x]-M41[x]-M3[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line3999"></a>3999</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4000"></a>4000</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;components,&nbsp;[&nbsp;M2111,&nbsp;M311,&nbsp;M221,&nbsp;M11111,&nbsp;M32,&nbsp;M41,&nbsp;M5&nbsp;]);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4001"></a>4001</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4002"></a>4002</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m&nbsp;=&nbsp;6&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4003"></a>4003</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4004"></a>4004</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F6:=&nbsp;MinusCharacter(&nbsp;F2,&nbsp;PowerMap(&nbsp;tbl,&nbsp;3&nbsp;),&nbsp;3&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4005"></a>4005</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M3111:=&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;M21[x]*M111[x]-F6[x]+F2[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4006"></a>4006</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M411:=&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;M3[x]*M111[x]-M3111[x]-M31[x]
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4007"></a>4007</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-M211[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4008"></a>4008</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M21111:=&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;M2[x]*M1111[x]-M3111[x]
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4009"></a>4009</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-M211[x]-M1111[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4010"></a>4010</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M111111:=&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;M1[x]*M11111[x]-M21111[x]
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4011"></a>4011</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-M1111[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4012"></a>4012</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M2211:=&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;M1[x]*M2111[x]-M3111[x]
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4013"></a>4013</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-M21111[x]-M211[x]-M1111[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4014"></a>4014</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M321:=&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;M1[x]*M311[x]-M3111[x]
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4015"></a>4015</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-M411[x]-M31[x]-M211[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4016"></a>4016</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M33:=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;F2[x]*M22[x]-M321[x]-M2211[x]
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4017"></a>4017</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-M31[x]-M22[x]-M211[x]-F2[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4018"></a>4018</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M51:=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;F2[x]*M4[x]-M411[x]-M31[x]
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4019"></a>4019</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-M4[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4020"></a>4020</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M42:=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;M1[x]*M41[x]-M411[x]-M51[x]
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4021"></a>4021</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-M31[x]-M4[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4022"></a>4022</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M222:=&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;M2[x]*M22[x]-M321[x]-M42[x]
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4023"></a>4023</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-M31[x]-M22[x]-M211[x]-M2[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4024"></a>4024</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M6:=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;classes,&nbsp;x->&nbsp;M1[x]*M5[x]-M51[x]-M4[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4025"></a>4025</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4026"></a>4026</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append(&nbsp;components,&nbsp;[&nbsp;M3111,&nbsp;M411,&nbsp;M21111,&nbsp;M111111,&nbsp;M2211,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4027"></a>4027</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M321,&nbsp;M33,&nbsp;M51,&nbsp;M42,&nbsp;M222,&nbsp;M6&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4028"></a>4028</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4029"></a>4029</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4030"></a>4030</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4031"></a>4031</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4032"></a>4032</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4033"></a>4033</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4034"></a>4034</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4035"></a>4035</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;List(&nbsp;components,&nbsp;chi&nbsp;->&nbsp;ClassFunction(&nbsp;tbl,&nbsp;chi&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4036"></a>4036</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4037"></a>4037</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4038"></a>4038</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4039"></a>4039</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4040"></a>4040</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4041"></a>4041</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;OrthogonalComponents(&nbsp;&lt;tbl>,&nbsp;&lt;chars>,&nbsp;&lt;m>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4042"></a>4042</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4043"></a>4043</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;OrthogonalComponents,&nbsp;function(&nbsp;tbl,&nbsp;chars,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4044"></a>4044</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsCharacterTable(&nbsp;tbl&nbsp;)&nbsp;and&nbsp;IsList(&nbsp;chars&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4045"></a>4045</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;IsInt(&nbsp;m&nbsp;)&nbsp;and&nbsp;1&nbsp;&lt;&nbsp;m&nbsp;and&nbsp;m&nbsp;&lt;&nbsp;7&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4046"></a>4046</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;RefinedSymmetrizations(&nbsp;tbl,&nbsp;chars,&nbsp;m,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4047"></a>4047</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;x,&nbsp;y&nbsp;)&nbsp;return&nbsp;x;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4048"></a>4048</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4049"></a>4049</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"usage:&nbsp;OrthogonalComponents(&nbsp;&lt;tbl>,&nbsp;&lt;chars>,&nbsp;&lt;m>&nbsp;)&nbsp;with&nbsp;",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4050"></a>4050</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"integer&nbsp;2&nbsp;&lt;=&nbsp;m&nbsp;&lt;=&nbsp;6"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4051"></a>4051</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4052"></a>4052</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4053"></a>4053</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4054"></a>4054</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4055"></a>4055</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4056"></a>4056</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4057"></a>4057</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;SymplecticComponents(&nbsp;&lt;tbl>,&nbsp;&lt;chars>,&nbsp;&lt;m>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4058"></a>4058</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4059"></a>4059</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;SymplecticComponents,&nbsp;function(&nbsp;tbl,&nbsp;chars,&nbsp;m&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4060"></a>4060</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsCharacterTable(&nbsp;tbl&nbsp;)&nbsp;and&nbsp;IsList(&nbsp;chars&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4061"></a>4061</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;IsInt(&nbsp;m&nbsp;)&nbsp;and&nbsp;1&nbsp;&lt;&nbsp;m&nbsp;and&nbsp;m&nbsp;&lt;&nbsp;6&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4062"></a>4062</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;RefinedSymmetrizations(&nbsp;tbl,&nbsp;chars,&nbsp;m,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4063"></a>4063</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;x,&nbsp;y&nbsp;)&nbsp;return&nbsp;x-y;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4064"></a>4064</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4065"></a>4065</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"usage:&nbsp;SymplecticComponents(&nbsp;&lt;tbl>,&nbsp;&lt;chars>,&nbsp;&lt;m>&nbsp;)&nbsp;with&nbsp;",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4066"></a>4066</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"integer&nbsp;2&nbsp;&lt;=&nbsp;m&nbsp;&lt;=&nbsp;5"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4067"></a>4067</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4068"></a>4068</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4069"></a>4069</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4070"></a>4070</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4071"></a>4071</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4072"></a>4072</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4073"></a>4073</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;12.&nbsp;Operations&nbsp;for&nbsp;Brauer&nbsp;Characters
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4074"></a>4074</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4075"></a>4075</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4076"></a>4076</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4077"></a>4077</td><td></td><td></td><td></td><td><span><tt>###############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4078"></a>4078</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4079"></a>4079</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;FrobeniusCharacterValue(&nbsp;&lt;value>,&nbsp;&lt;p>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4080"></a>4080</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4081"></a>4081</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Let&nbsp;$n$&nbsp;be&nbsp;the&nbsp;conductor&nbsp;of&nbsp;$v$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4082"></a>4082</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Let&nbsp;$k$&nbsp;be&nbsp;the&nbsp;order&nbsp;of&nbsp;$p$&nbsp;modulo&nbsp;$n$,&nbsp;that&nbsp;is,&nbsp;$\F_{p^k}$&nbsp;is&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4083"></a>4083</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;smallest&nbsp;field&nbsp;of&nbsp;characteristic&nbsp;$p$&nbsp;containing&nbsp;$n$-th&nbsp;roots&nbsp;of&nbsp;unity.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4084"></a>4084</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Let&nbsp;$m$&nbsp;be&nbsp;minimal&nbsp;with&nbsp;$v^{\ast&nbsp;p^m}&nbsp;=&nbsp;v$,&nbsp;that&nbsp;is,&nbsp;$\F_{p^m}$&nbsp;is&nbsp;a
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4085"></a>4085</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;(not&nbsp;necessarily&nbsp;minimal)&nbsp;field&nbsp;containing&nbsp;the&nbsp;Frobenius&nbsp;character&nbsp;value
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4086"></a>4086</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$\overline{v}$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4087"></a>4087</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4088"></a>4088</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Let&nbsp;$C_k$&nbsp;and&nbsp;$C_m$&nbsp;be&nbsp;the&nbsp;Conway&nbsp;polynomials&nbsp;of&nbsp;degrees&nbsp;$k$&nbsp;and&nbsp;$m$,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4089"></a>4089</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;and&nbsp;$z&nbsp;=&nbsp;X&nbsp;+&nbsp;(C_k)$&nbsp;in&nbsp;$\F_{p^k}&nbsp;=&nbsp;\F_p[X]&nbsp;/&nbsp;(C_k)$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4090"></a>4090</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Then&nbsp;$\hat{y}&nbsp;=&nbsp;z^{\frac{p^k-1}{p^m-1}}$&nbsp;may&nbsp;be&nbsp;identified&nbsp;with
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4091"></a>4091</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$y&nbsp;=&nbsp;X&nbsp;+&nbsp;(C_m)$&nbsp;in&nbsp;$\F_{p^m}&nbsp;=&nbsp;\F_p[X]&nbsp;/&nbsp;(C_m)$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4092"></a>4092</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4093"></a>4093</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;For&nbsp;$v&nbsp;=&nbsp;\sum_{i=1}^n&nbsp;a_i&nbsp;E(n)^i$,&nbsp;a&nbsp;representation&nbsp;of&nbsp;$\overline{v}$&nbsp;in
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4094"></a>4094</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$\F_{p^k}$&nbsp;is&nbsp;$\sum_{i=1}^n&nbsp;\overline{a_i}&nbsp;z^{\frac{p^k-1}{n}&nbsp;i}$&nbsp;where
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4095"></a>4095</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$\overline{a_i}$&nbsp;is&nbsp;the&nbsp;reduction&nbsp;of&nbsp;$a_i$&nbsp;modulo&nbsp;$p$,&nbsp;viewed&nbsp;as
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4096"></a>4096</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;element&nbsp;of&nbsp;$\F_p$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4097"></a>4097</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4098"></a>4098</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;A&nbsp;representation&nbsp;of&nbsp;$\overline{v}$&nbsp;in&nbsp;$\F_{p^m}$&nbsp;can&nbsp;be&nbsp;found&nbsp;by
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4099"></a>4099</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;solving&nbsp;the&nbsp;linear&nbsp;equation&nbsp;system
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4100"></a>4100</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$\overline{v}&nbsp;=&nbsp;\sum_{i=0}^{m-1}&nbsp;c_i&nbsp;\hat{y}^i$&nbsp;over&nbsp;$\F_p$,&nbsp;which
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4101"></a>4101</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;gives&nbsp;us&nbsp;$\overline{v}&nbsp;=&nbsp;\sum{i=0}^{m-1}&nbsp;c_i&nbsp;y^i$&nbsp;in&nbsp;$\F_{p^m}$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4102"></a>4102</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4103"></a>4103</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;FrobeniusCharacterValue,&nbsp;function(&nbsp;value,&nbsp;p&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4104"></a>4104</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;n,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;conductor&nbsp;of&nbsp;`value'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4105"></a>4105</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;degree&nbsp;of&nbsp;smallest&nbsp;field&nbsp;containing&nbsp;`n'-th&nbsp;roots
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4106"></a>4106</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;`p^k'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4107"></a>4107</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;`(&nbsp;size&nbsp;-&nbsp;1&nbsp;)&nbsp;/&nbsp;n'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4108"></a>4108</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ffe,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;primitive&nbsp;`n'-th&nbsp;root&nbsp;in&nbsp;`GF(&nbsp;size&nbsp;)'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4109"></a>4109</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cf,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;canonical&nbsp;basis&nbsp;of&nbsp;`CF(n)'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4110"></a>4110</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;degree&nbsp;of&nbsp;some&nbsp;field&nbsp;containing&nbsp;the&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4111"></a>4111</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;image&nbsp;of&nbsp;`value'&nbsp;under&nbsp;Galois&nbsp;conjugation
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4112"></a>4112</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;primefield,&nbsp;&nbsp;&nbsp;#&nbsp;`GF(p)'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4113"></a>4113</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;zero&nbsp;of&nbsp;`primefield'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4114"></a>4114</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;identity&nbsp;of&nbsp;`primefield'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4115"></a>4115</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conwaypol,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;coeffs.&nbsp;of&nbsp;the&nbsp;`k'-th&nbsp;Conway&nbsp;pol.&nbsp;in&nbsp;char.&nbsp;`p'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4116"></a>4116</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;coeffs.&nbsp;of&nbsp;an&nbsp;indeterminate
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4117"></a>4117</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4118"></a>4118</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lastvalue,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4119"></a>4119</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fieldbase,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4120"></a>4120</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4121"></a>4121</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4122"></a>4122</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;&lt;value>&nbsp;belongs&nbsp;to&nbsp;a&nbsp;&lt;p>-singular&nbsp;element&nbsp;then&nbsp;return&nbsp;`fail'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4123"></a>4123</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;Conductor(&nbsp;value&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4124"></a>4124</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;n&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4125"></a>4125</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4126"></a>4126</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;n&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4127"></a>4127</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;DenominatorRat(&nbsp;value&nbsp;)&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4128"></a>4128</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4129"></a>4129</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4130"></a>4130</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value&nbsp;*&nbsp;One(&nbsp;GF(p)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4131"></a>4131</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4132"></a>4132</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsCycInt(&nbsp;value&nbsp;/&nbsp;p&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4133"></a>4133</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Zero(&nbsp;GF(p)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4134"></a>4134</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4135"></a>4135</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4136"></a>4136</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;size&nbsp;$p^k$&nbsp;of&nbsp;the&nbsp;smallest&nbsp;finite&nbsp;field&nbsp;of&nbsp;characteristic
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4137"></a>4137</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;`p'&nbsp;that&nbsp;contains&nbsp;'n'-th&nbsp;roots&nbsp;of&nbsp;unity.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4138"></a>4138</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;k:=&nbsp;OrderMod(&nbsp;p,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4139"></a>4139</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;size:=&nbsp;p^k;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4140"></a>4140</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4141"></a>4141</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;root&nbsp;`E(n)'&nbsp;is&nbsp;identified&nbsp;with&nbsp;the&nbsp;smallest&nbsp;primitive&nbsp;`n'-th
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4142"></a>4142</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;root&nbsp;in&nbsp;the&nbsp;finite&nbsp;field,&nbsp;that&nbsp;is,&nbsp;the&nbsp;`(size-1)&nbsp;/&nbsp;n'-th&nbsp;power&nbsp;of
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4143"></a>4143</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;primitive&nbsp;root&nbsp;of&nbsp;the&nbsp;field
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4144"></a>4144</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(which&nbsp;is&nbsp;given&nbsp;by&nbsp;the&nbsp;Conway&nbsp;polynomial).
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4145"></a>4145</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;power:=&nbsp;(&nbsp;size&nbsp;-&nbsp;1&nbsp;)&nbsp;/&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4146"></a>4146</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4147"></a>4147</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;size&nbsp;&lt;=&nbsp;MAXSIZE_GF_INTERNAL&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4148"></a>4148</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4149"></a>4149</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Use&nbsp;GAP's&nbsp;internal&nbsp;finite&nbsp;fields.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4150"></a>4150</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(Express&nbsp;the&nbsp;Brauer&nbsp;character&nbsp;value&nbsp;in&nbsp;terms&nbsp;of&nbsp;the&nbsp;Zumbroich&nbsp;basis
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4151"></a>4151</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;of&nbsp;the&nbsp;underlying&nbsp;cyclotomic&nbsp;field.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4152"></a>4152</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ffe:=&nbsp;PrimitiveRoot(&nbsp;GF(&nbsp;size&nbsp;)&nbsp;)&nbsp;^&nbsp;power;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4153"></a>4153</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cf:=&nbsp;CanonicalBasis(&nbsp;CF(&nbsp;n&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4154"></a>4154</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:=&nbsp;Coefficients(&nbsp;cf,&nbsp;value&nbsp;)&nbsp;*
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4155"></a>4155</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;ZumbroichBase(&nbsp;n,&nbsp;1&nbsp;),&nbsp;exp&nbsp;->&nbsp;ffe&nbsp;^&nbsp;exp&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4156"></a>4156</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4157"></a>4157</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;not&nbsp;IsCheapConwayPolynomial(&nbsp;p,&nbsp;k&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4158"></a>4158</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4159"></a>4159</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Give&nbsp;up&nbsp;if&nbsp;the&nbsp;required&nbsp;Conway&nbsp;polynomial&nbsp;is&nbsp;hard&nbsp;to&nbsp;compute.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4160"></a>4160</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoWarning,&nbsp;1,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4161"></a>4161</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"the&nbsp;Conway&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;",&nbsp;k,&nbsp;"&nbsp;for&nbsp;p&nbsp;=&nbsp;",&nbsp;p,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4162"></a>4162</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;is&nbsp;not&nbsp;known"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4163"></a>4163</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4164"></a>4164</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4165"></a>4165</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4166"></a>4166</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4167"></a>4167</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;a&nbsp;finite&nbsp;field&nbsp;that&nbsp;contains&nbsp;the&nbsp;Frobenius&nbsp;character&nbsp;value.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4168"></a>4168</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;An&nbsp;upper&nbsp;bound&nbsp;is&nbsp;given&nbsp;by&nbsp;the&nbsp;field&nbsp;of&nbsp;order&nbsp;$p^m$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4169"></a>4169</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;where&nbsp;$m$&nbsp;is&nbsp;the&nbsp;smallest&nbsp;number&nbsp;such&nbsp;that&nbsp;&lt;value>&nbsp;is&nbsp;fixed
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4170"></a>4170</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;by&nbsp;the&nbsp;Galois&nbsp;automorphism&nbsp;that&nbsp;raises&nbsp;roots&nbsp;of&nbsp;unity
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4171"></a>4171</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;to&nbsp;the&nbsp;$p^m$-th&nbsp;power.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4172"></a>4172</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4173"></a>4173</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image:=&nbsp;GaloisCyc(&nbsp;value,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4174"></a>4174</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;image&nbsp;&lt;>&nbsp;value&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4175"></a>4175</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m:=&nbsp;m+1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4176"></a>4176</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image:=&nbsp;GaloisCyc(&nbsp;image,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4177"></a>4177</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4178"></a>4178</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4179"></a>4179</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;representation&nbsp;of&nbsp;the&nbsp;Frobenius&nbsp;character&nbsp;value
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4180"></a>4180</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;in&nbsp;the&nbsp;field&nbsp;$\F_{p^k}$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4181"></a>4181</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;primefield:=&nbsp;GF(p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4182"></a>4182</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero:=&nbsp;Zero(&nbsp;primefield&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4183"></a>4183</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one:=&nbsp;One(&nbsp;primefield&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4184"></a>4184</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4185"></a>4185</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conwaypol:=&nbsp;ConwayPol(&nbsp;p,&nbsp;k&nbsp;)&nbsp;*&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4186"></a>4186</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x:=&nbsp;[&nbsp;zero,&nbsp;one&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4187"></a>4187</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:=&nbsp;COEFFS_CYC(&nbsp;value&nbsp;)&nbsp;*&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4188"></a>4188</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4189"></a>4189</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;conwaypol,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4190"></a>4190</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;x,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4191"></a>4191</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;value,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4192"></a>4192</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4193"></a>4193</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:=&nbsp;PowerModEvalPol(&nbsp;conwaypol,&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4194"></a>4194</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4195"></a>4195</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PowerModCoeffs(&nbsp;x,&nbsp;2,&nbsp;power,&nbsp;conwaypol,&nbsp;k+1&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4196"></a>4196</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;value&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4197"></a>4197</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;zero;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4198"></a>4198</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4199"></a>4199</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PadCoeffs(&nbsp;value,&nbsp;k,&nbsp;zero&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4200"></a>4200</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4201"></a>4201</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;a&nbsp;$\F_p$-basis&nbsp;$(\hat{y}^i;&nbsp;0\leq&nbsp;i\leq&nbsp;m-1)$&nbsp;of
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4202"></a>4202</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;subfield&nbsp;of&nbsp;$\F_{p^k}$&nbsp;isomorphic&nbsp;with&nbsp;$\F_{p^m}$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4203"></a>4203</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y:=&nbsp;PowerModCoeffs(&nbsp;x,&nbsp;2,&nbsp;(size&nbsp;-&nbsp;1)&nbsp;/&nbsp;(p^m&nbsp;-&nbsp;1),&nbsp;conwaypol,&nbsp;k+1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4204"></a>4204</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4205"></a>4205</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lastvalue:=&nbsp;[&nbsp;one&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4206"></a>4206</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fieldbase:=&nbsp;[&nbsp;[&nbsp;one&nbsp;]&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4207"></a>4207</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PadCoeffs(&nbsp;fieldbase[1],&nbsp;k,&nbsp;zero&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4208"></a>4208</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;fieldbase[1],&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4209"></a>4209</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4210"></a>4210</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;2&nbsp;..&nbsp;m&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4211"></a>4211</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lastvalue:=&nbsp;ProductCoeffs(&nbsp;y,&nbsp;lastvalue&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4212"></a>4212</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReduceCoeffs(&nbsp;lastvalue,&nbsp;conwaypol&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4213"></a>4213</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;bad&nbsp;that&nbsp;ReduceCoeffs&nbsp;does&nbsp;not&nbsp;predict&nbsp;how&nbsp;it&nbsp;deals&nbsp;with&nbsp;trailing&nbsp;zeros
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4214"></a>4214</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PadCoeffs(&nbsp;lastvalue,&nbsp;k,&nbsp;zero&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4215"></a>4215</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fieldbase[i]:=&nbsp;lastvalue;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4216"></a>4216</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;fieldbase[i],&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4217"></a>4217</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4218"></a>4218</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4219"></a>4219</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:=&nbsp;ValuePol(&nbsp;SolutionMatDestructive(&nbsp;fieldbase,&nbsp;value&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4220"></a>4220</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Z(&nbsp;p,&nbsp;m&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4221"></a>4221</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4222"></a>4222</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4223"></a>4223</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4224"></a>4224</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;Frobenius&nbsp;character&nbsp;value.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4225"></a>4225</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4226"></a>4226</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4227"></a>4227</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4228"></a>4228</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4229"></a>4229</td><td></td><td></td><td></td><td><span><tt>##############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4230"></a>4230</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4231"></a>4231</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;ReductionToFiniteField(&nbsp;&lt;value>,&nbsp;&lt;p>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4232"></a>4232</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4233"></a>4233</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;ReductionToFiniteField,&nbsp;function(&nbsp;value,&nbsp;p&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4234"></a>4234</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;n,&nbsp;primefield,&nbsp;one,&nbsp;zero,&nbsp;k,&nbsp;size,&nbsp;power,&nbsp;ffe,&nbsp;cf,&nbsp;frob,&nbsp;d,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4235"></a>4235</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conwaypol,&nbsp;x,&nbsp;m,&nbsp;primes,&nbsp;sol,&nbsp;l,&nbsp;mc,&nbsp;y,&nbsp;leny,&nbsp;lastvalue,&nbsp;fieldbase,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4236"></a>4236</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;redsol;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4237"></a>4237</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4238"></a>4238</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;&lt;value>&nbsp;belongs&nbsp;to&nbsp;a&nbsp;&lt;p>-singular&nbsp;element&nbsp;then&nbsp;return&nbsp;`fail'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4239"></a>4239</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;Conductor(&nbsp;value&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4240"></a>4240</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4241"></a>4241</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4242"></a>4242</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4243"></a>4243</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4244"></a>4244</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;primefield:=&nbsp;GF(p);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4245"></a>4245</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4246"></a>4246</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Catch&nbsp;the&nbsp;case&nbsp;where&nbsp;the&nbsp;reduction&nbsp;trivially&nbsp;lies&nbsp;in&nbsp;the&nbsp;prime&nbsp;field.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4247"></a>4247</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4248"></a>4248</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;DenominatorRat(&nbsp;value&nbsp;)&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4249"></a>4249</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4250"></a>4250</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4251"></a>4251</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;value&nbsp;*&nbsp;One(&nbsp;Indeterminate(&nbsp;primefield&nbsp;)&nbsp;),&nbsp;1&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4252"></a>4252</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4253"></a>4253</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsCycInt(&nbsp;value&nbsp;/&nbsp;p&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4254"></a>4254</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;Zero(&nbsp;Indeterminate(&nbsp;primefield&nbsp;)&nbsp;),&nbsp;1&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4255"></a>4255</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4256"></a>4256</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4257"></a>4257</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;one:=&nbsp;One(&nbsp;primefield&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4258"></a>4258</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;zero:=&nbsp;Zero(&nbsp;primefield&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4259"></a>4259</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4260"></a>4260</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;size&nbsp;$p^k$&nbsp;of&nbsp;the&nbsp;smallest&nbsp;finite&nbsp;field&nbsp;of&nbsp;characteristic
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4261"></a>4261</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;`p'&nbsp;that&nbsp;contains&nbsp;`n'-th&nbsp;roots&nbsp;of&nbsp;unity.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4262"></a>4262</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;k:=&nbsp;OrderMod(&nbsp;p,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4263"></a>4263</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;size:=&nbsp;p^k;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4264"></a>4264</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4265"></a>4265</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;root&nbsp;`E(n)'&nbsp;is&nbsp;identified&nbsp;with&nbsp;the&nbsp;smallest&nbsp;primitive&nbsp;`n'-th
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4266"></a>4266</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;root&nbsp;in&nbsp;the&nbsp;finite&nbsp;field,&nbsp;that&nbsp;is,&nbsp;the&nbsp;`(size-1)&nbsp;/&nbsp;n'-th&nbsp;power&nbsp;of
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4267"></a>4267</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;primitive&nbsp;root&nbsp;of&nbsp;the&nbsp;field
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4268"></a>4268</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(which&nbsp;is&nbsp;given&nbsp;by&nbsp;the&nbsp;Conway&nbsp;polynomial).
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4269"></a>4269</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;power:=&nbsp;(&nbsp;size&nbsp;-&nbsp;1&nbsp;)&nbsp;/&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4270"></a>4270</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4271"></a>4271</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;size&nbsp;&lt;=&nbsp;MAXSIZE_GF_INTERNAL&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4272"></a>4272</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Use&nbsp;GAP's&nbsp;internal&nbsp;finite&nbsp;fields.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4273"></a>4273</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;(Compute&nbsp;the&nbsp;Frobenius&nbsp;character&nbsp;value&nbsp;and&nbsp;the&nbsp;corresponding&nbsp;pol.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4274"></a>4274</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ffe:=&nbsp;PrimitiveRoot(&nbsp;GF(&nbsp;size&nbsp;)&nbsp;)&nbsp;^&nbsp;power;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4275"></a>4275</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cf:=&nbsp;CanonicalBasis(&nbsp;CF(&nbsp;n&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4276"></a>4276</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frob:=&nbsp;Coefficients(&nbsp;cf,&nbsp;value&nbsp;)&nbsp;*
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4277"></a>4277</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List(&nbsp;ZumbroichBase(&nbsp;n,&nbsp;1&nbsp;),&nbsp;exp&nbsp;->&nbsp;ffe&nbsp;^&nbsp;exp&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4278"></a>4278</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsZero(&nbsp;frob&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4279"></a>4279</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;Zero(&nbsp;Indeterminate(&nbsp;primefield&nbsp;)&nbsp;),&nbsp;1&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4280"></a>4280</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4281"></a>4281</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4282"></a>4282</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d:=&nbsp;DegreeFFE(&nbsp;frob&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4283"></a>4283</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;d&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4284"></a>4284</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;frob&nbsp;*&nbsp;One(&nbsp;Indeterminate(&nbsp;primefield&nbsp;)&nbsp;),&nbsp;1&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4285"></a>4285</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4286"></a>4286</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4287"></a>4287</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Note&nbsp;that&nbsp;`LogFFE'&nbsp;returns&nbsp;a&nbsp;nonzero&nbsp;value.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4288"></a>4288</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conwaypol:=&nbsp;ConwayPol(&nbsp;p,&nbsp;d&nbsp;)&nbsp;*&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4289"></a>4289</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x:=&nbsp;[&nbsp;zero,&nbsp;one&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4290"></a>4290</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;conwaypol,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4291"></a>4291</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;x,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4292"></a>4292</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frob:=&nbsp;PowerModCoeffs(&nbsp;x,&nbsp;2,&nbsp;LogFFE(&nbsp;frob,&nbsp;Z(&nbsp;p,&nbsp;d&nbsp;)&nbsp;),&nbsp;conwaypol,&nbsp;d+1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4293"></a>4293</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;UnivariatePolynomialByCoefficients(&nbsp;FamilyObj(&nbsp;one&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4294"></a>4294</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frob,&nbsp;1&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4295"></a>4295</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4296"></a>4296</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;not&nbsp;IsCheapConwayPolynomial(&nbsp;p,&nbsp;k&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4297"></a>4297</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Give&nbsp;up&nbsp;if&nbsp;the&nbsp;required&nbsp;Conway&nbsp;polynomial&nbsp;is&nbsp;hard&nbsp;to&nbsp;compute.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4298"></a>4298</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoWarning,&nbsp;1,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4299"></a>4299</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"the&nbsp;Conway&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;",&nbsp;k,&nbsp;"&nbsp;for&nbsp;p&nbsp;=&nbsp;",&nbsp;p,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4300"></a>4300</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;is&nbsp;not&nbsp;known"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4301"></a>4301</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4302"></a>4302</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4303"></a>4303</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4304"></a>4304</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;conwaypol:=&nbsp;ConwayPol(&nbsp;p,&nbsp;k&nbsp;)&nbsp;*&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4305"></a>4305</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4306"></a>4306</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;x:=&nbsp;[&nbsp;zero,&nbsp;one&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4307"></a>4307</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;value:=&nbsp;COEFFS_CYC(&nbsp;value&nbsp;)&nbsp;*&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4308"></a>4308</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4309"></a>4309</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;conwaypol,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4310"></a>4310</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;x,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4311"></a>4311</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;value,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4312"></a>4312</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4313"></a>4313</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;value:=&nbsp;PowerModEvalPol(&nbsp;conwaypol,&nbsp;value,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4314"></a>4314</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PowerModCoeffs(&nbsp;x,&nbsp;2,&nbsp;power,&nbsp;conwaypol,&nbsp;k+1&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4315"></a>4315</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;value&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4316"></a>4316</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;Zero(&nbsp;Indeterminate(&nbsp;primefield&nbsp;)&nbsp;),&nbsp;1&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4317"></a>4317</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4318"></a>4318</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;PadCoeffs(&nbsp;value,&nbsp;k,&nbsp;zero&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4319"></a>4319</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4320"></a>4320</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Reduce&nbsp;the&nbsp;representation&nbsp;into&nbsp;the&nbsp;smallest&nbsp;finite&nbsp;field.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4321"></a>4321</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;currently&nbsp;known&nbsp;field&nbsp;has&nbsp;size&nbsp;`p^k'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4322"></a>4322</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m:=&nbsp;k;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4323"></a>4323</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4324"></a>4324</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;k&nbsp;&lt;>&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4325"></a>4325</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4326"></a>4326</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;primes:=&nbsp;Set(&nbsp;Factors(&nbsp;m&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4327"></a>4327</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sol:=&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4328"></a>4328</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4329"></a>4329</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;not&nbsp;IsEmpty(&nbsp;primes&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4330"></a>4330</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4331"></a>4331</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;l&nbsp;in&nbsp;ShallowCopy(&nbsp;primes&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4332"></a>4332</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4333"></a>4333</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;`p^(m/l)'&nbsp;is&nbsp;the&nbsp;candidate&nbsp;for&nbsp;next&nbsp;smaller&nbsp;field.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4334"></a>4334</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mc:=&nbsp;m&nbsp;/&nbsp;l;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4335"></a>4335</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4336"></a>4336</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;a&nbsp;$\F_p$-basis&nbsp;$(\hat{y}^i;&nbsp;0&nbsp;\leq&nbsp;i&nbsp;\leq&nbsp;m/l&nbsp;-&nbsp;1)$&nbsp;of
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4337"></a>4337</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;subfield&nbsp;of&nbsp;$\F_{p^k}$&nbsp;isomorphic&nbsp;with&nbsp;$\F_{p^{(m/l)}}$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4338"></a>4338</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y:=&nbsp;PowerModCoeffs(&nbsp;x,&nbsp;2,&nbsp;(size&nbsp;-&nbsp;1)&nbsp;/&nbsp;(p^mc&nbsp;-&nbsp;1),&nbsp;conwaypol,&nbsp;k+1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4339"></a>4339</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leny:=&nbsp;Length(&nbsp;y&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4340"></a>4340</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4341"></a>4341</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lastvalue:=&nbsp;[&nbsp;one&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4342"></a>4342</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PadCoeffs(&nbsp;lastvalue,&nbsp;k,&nbsp;zero&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4343"></a>4343</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fieldbase:=&nbsp;[&nbsp;[&nbsp;one&nbsp;]&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4344"></a>4344</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PadCoeffs(&nbsp;fieldbase[1],&nbsp;k,&nbsp;zero&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4345"></a>4345</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;lastvalue,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4346"></a>4346</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;fieldbase[1],&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4347"></a>4347</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4348"></a>4348</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;2&nbsp;..&nbsp;mc&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4349"></a>4349</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lastvalue:=&nbsp;ProductCoeffs(&nbsp;y,&nbsp;leny,&nbsp;lastvalue,&nbsp;k&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4350"></a>4350</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReduceCoeffs(&nbsp;lastvalue,&nbsp;conwaypol&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4351"></a>4351</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PadCoeffs(&nbsp;lastvalue,&nbsp;k,&nbsp;zero&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4352"></a>4352</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;lastvalue,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4353"></a>4353</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;needed?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4354"></a>4354</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fieldbase[i]:=&nbsp;lastvalue;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4355"></a>4355</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4356"></a>4356</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4357"></a>4357</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Check&nbsp;whether&nbsp;`value'&nbsp;is&nbsp;a&nbsp;linear&nbsp;combination&nbsp;of&nbsp;this&nbsp;basis.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4358"></a>4358</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redsol:=&nbsp;SolutionMatDestructive(&nbsp;fieldbase,&nbsp;ShallowCopy(&nbsp;value&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4359"></a>4359</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;redsol&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4360"></a>4360</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RemoveSet(&nbsp;primes,&nbsp;l&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4361"></a>4361</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4362"></a>4362</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sol:=&nbsp;redsol;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4363"></a>4363</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m:=&nbsp;mc;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4364"></a>4364</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4365"></a>4365</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4366"></a>4366</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4367"></a>4367</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4368"></a>4368</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IntersectSet(&nbsp;primes,&nbsp;Factors(&nbsp;m&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4369"></a>4369</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4370"></a>4370</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4371"></a>4371</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4372"></a>4372</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sol&nbsp;&lt;>&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4373"></a>4373</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;We&nbsp;have&nbsp;found&nbsp;a&nbsp;smaller&nbsp;field.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4374"></a>4374</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:=&nbsp;sol;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4375"></a>4375</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4376"></a>4376</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4377"></a>4377</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4378"></a>4378</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4379"></a>4379</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;reduction&nbsp;into&nbsp;the&nbsp;minimal&nbsp;field.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4380"></a>4380</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;UnivariatePolynomialByCoefficients(&nbsp;FamilyObj(&nbsp;one&nbsp;),&nbsp;value,&nbsp;1&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4381"></a>4381</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4382"></a>4382</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4383"></a>4383</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4384"></a>4384</td><td></td><td></td><td></td><td><span><tt>#&nbsp;#&nbsp;alternative&nbsp;implementation
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4385"></a>4385</td><td></td><td></td><td></td><td><span><tt>#&nbsp;ReductionToFiniteField2:=&nbsp;function(&nbsp;value,&nbsp;p&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4386"></a>4386</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;frob,&nbsp;d,&nbsp;z,&nbsp;one,&nbsp;zero,&nbsp;conwaypol,&nbsp;x;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4387"></a>4387</td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4388"></a>4388</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frob:=&nbsp;FrobeniusCharacterValue(&nbsp;value,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4389"></a>4389</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;frob&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4390"></a>4390</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4391"></a>4391</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsZero(&nbsp;frob&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4392"></a>4392</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;Zero(&nbsp;Indeterminate(&nbsp;GF(p)&nbsp;)&nbsp;),&nbsp;1&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4393"></a>4393</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4394"></a>4394</td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4395"></a>4395</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d:=&nbsp;DegreeFFE(&nbsp;frob&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4396"></a>4396</td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4397"></a>4397</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;d&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4398"></a>4398</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;frob&nbsp;*&nbsp;One(&nbsp;Indeterminate(&nbsp;GF(p)&nbsp;)&nbsp;),&nbsp;1&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4399"></a>4399</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;p^d&nbsp;&lt;=&nbsp;MAXSIZE_GF_INTERNAL&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4400"></a>4400</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z:=&nbsp;Z(&nbsp;p,&nbsp;d&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4401"></a>4401</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one:=&nbsp;One(&nbsp;z&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4402"></a>4402</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero:=&nbsp;Zero(&nbsp;z&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4403"></a>4403</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conwaypol:=&nbsp;ConwayPol(&nbsp;p,&nbsp;d&nbsp;)&nbsp;*&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4404"></a>4404</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x:=&nbsp;[&nbsp;zero,&nbsp;one&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4405"></a>4405</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;conwaypol,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4406"></a>4406</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ConvertToVectorRepNC(&nbsp;x,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4407"></a>4407</td><td></td><td></td><td></td><td><span><tt>#&nbsp;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4408"></a>4408</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Note&nbsp;that&nbsp;`LogFFE'&nbsp;returns&nbsp;a&nbsp;nonzero&nbsp;value.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4409"></a>4409</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frob:=&nbsp;PowerModCoeffs(&nbsp;x,&nbsp;2,&nbsp;LogFFE(&nbsp;frob,&nbsp;z&nbsp;),&nbsp;conwaypol,&nbsp;d+1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4410"></a>4410</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frob:=&nbsp;UnivariatePolynomialByCoefficients(&nbsp;FamilyObj(&nbsp;one&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4411"></a>4411</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frob,&nbsp;1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4412"></a>4412</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsCoeffsModConwayPolRep(&nbsp;frob&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4413"></a>4413</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frob:=&nbsp;UnivariatePolynomialByCoefficients(&nbsp;FamilyObj(&nbsp;Z(p)&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4414"></a>4414</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frob![1],&nbsp;1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4415"></a>4415</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4416"></a>4416</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;This&nbsp;should&nbsp;never&nbsp;happen,&nbsp;since&nbsp;`FrobeniusCharacterValue'&nbsp;worked.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4417"></a>4417</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoWarning,&nbsp;1,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4418"></a>4418</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"no&nbsp;coefficients&nbsp;w.r.t.&nbsp;the&nbsp;Conway&nbsp;polynomial&nbsp;available"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4419"></a>4419</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4420"></a>4420</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4421"></a>4421</td><td></td><td></td><td></td><td><span><tt>#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;[&nbsp;frob,&nbsp;d&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4422"></a>4422</td><td></td><td></td><td></td><td><span><tt>#&nbsp;end;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4423"></a>4423</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4424"></a>4424</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4425"></a>4425</td><td></td><td></td><td></td><td><span><tt>##############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4426"></a>4426</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4427"></a>4427</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;SizeOfFieldOfDefinition(&nbsp;&lt;val>,&nbsp;&lt;p>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4428"></a>4428</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4429"></a>4429</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;If&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;the&nbsp;Zumbroich&nbsp;basis&nbsp;representation&nbsp;of&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4430"></a>4430</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;difference&nbsp;$\alpha^{\ast&nbsp;p}&nbsp;-&nbsp;\alpha$&nbsp;are&nbsp;divisible&nbsp;by&nbsp;$p$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4431"></a>4431</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;then&nbsp;$\alpha$&nbsp;is&nbsp;mapped&nbsp;to&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;prime&nbsp;field&nbsp;under
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4432"></a>4432</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;the&nbsp;reduction&nbsp;modulo&nbsp;any&nbsp;maximal&nbsp;ideal.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4433"></a>4433</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;(This&nbsp;covers&nbsp;the&nbsp;special&nbsp;cases&nbsp;that&nbsp;$\alpha$&nbsp;is&nbsp;fixed&nbsp;under&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4434"></a>4434</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;automorphism&nbsp;$\ast&nbsp;p$&nbsp;or&nbsp;that&nbsp;all&nbsp;coefficients&nbsp;of&nbsp;$\alpha$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4435"></a>4435</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;are&nbsp;divisible&nbsp;by&nbsp;$p$.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4436"></a>4436</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4437"></a>4437</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Otherwise,&nbsp;I&nbsp;do&nbsp;not&nbsp;know&nbsp;a&nbsp;better&nbsp;way&nbsp;to&nbsp;compute&nbsp;the&nbsp;size&nbsp;than&nbsp;explicitly
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4438"></a>4438</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;computing&nbsp;the&nbsp;reductions.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4439"></a>4439</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4440"></a>4440</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;SizeOfFieldOfDefinition,&nbsp;function(&nbsp;val,&nbsp;p&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4441"></a>4441</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;values,&nbsp;entry;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4442"></a>4442</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4443"></a>4443</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;first&nbsp;argument&nbsp;may&nbsp;be&nbsp;a&nbsp;cyclotomic&nbsp;or&nbsp;a&nbsp;list&nbsp;of&nbsp;cyclotomics.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4444"></a>4444</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;IsInt(&nbsp;val&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4445"></a>4445</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;p;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4446"></a>4446</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsCyc(&nbsp;val&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4447"></a>4447</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;DenominatorCyc(&nbsp;val&nbsp;)&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4448"></a>4448</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4449"></a>4449</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4450"></a>4450</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values:=&nbsp;[&nbsp;val&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4451"></a>4451</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;IsList(&nbsp;val&nbsp;)&nbsp;and&nbsp;IsCyclotomicCollection(&nbsp;val&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4452"></a>4452</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4453"></a>4453</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;entry&nbsp;in&nbsp;val&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4454"></a>4454</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&nbsp;not&nbsp;IsRat(&nbsp;entry&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4455"></a>4455</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;values,&nbsp;entry&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4456"></a>4456</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;DenominatorCyc(&nbsp;entry&nbsp;)&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4457"></a>4457</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4458"></a>4458</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4459"></a>4459</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4460"></a>4460</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4461"></a>4461</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;val>&nbsp;must&nbsp;be&nbsp;a&nbsp;cyclotomic&nbsp;or&nbsp;a&nbsp;list&nbsp;of&nbsp;cyclotomics"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4462"></a>4462</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4463"></a>4463</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4464"></a>4464</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAll(&nbsp;values,&nbsp;x&nbsp;->&nbsp;IsCycInt(&nbsp;(&nbsp;GaloisCyc(&nbsp;x,&nbsp;p&nbsp;)&nbsp;-&nbsp;x&nbsp;)&nbsp;/&nbsp;p&nbsp;)&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4465"></a>4465</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;p;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4466"></a>4466</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4467"></a>4467</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4468"></a>4468</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;values:=&nbsp;List(&nbsp;values,&nbsp;x&nbsp;->&nbsp;FrobeniusCharacterValue(&nbsp;x,&nbsp;p&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4469"></a>4469</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fail&nbsp;in&nbsp;values&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4470"></a>4470</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4471"></a>4471</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4472"></a>4472</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;p&nbsp;^&nbsp;DegreeFFE(&nbsp;values&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4473"></a>4473</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4474"></a>4474</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4475"></a>4475</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4476"></a>4476</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4477"></a>4477</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4478"></a>4478</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;BrauerCharacterValue(&nbsp;&lt;mat>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4479"></a>4479</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4480"></a>4480</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Let&nbsp;$M$&nbsp;be&nbsp;a&nbsp;matrix&nbsp;of&nbsp;order&nbsp;$n$,&nbsp;with&nbsp;entries&nbsp;in&nbsp;the&nbsp;finite&nbsp;field&nbsp;$F$,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4481"></a>4481</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;and&nbsp;suppose&nbsp;that&nbsp;$M$&nbsp;is&nbsp;diagonalizable&nbsp;over&nbsp;the&nbsp;extension&nbsp;field&nbsp;$K$&nbsp;with
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4482"></a>4482</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;$p^d$&nbsp;elements.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4483"></a>4483</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4484"></a>4484</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;It&nbsp;could&nbsp;in&nbsp;principle&nbsp;be&nbsp;computed&nbsp;by&nbsp;determining&nbsp;the&nbsp;diagonal&nbsp;form,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4485"></a>4485</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;identifying&nbsp;the&nbsp;entries&nbsp;in&nbsp;the&nbsp;diagonal&nbsp;with&nbsp;$(p^d&nbsp;-1)$-th&nbsp;complex&nbsp;roots
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4486"></a>4486</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;of&nbsp;unity,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4487"></a>4487</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;and&nbsp;then&nbsp;summing&nbsp;up&nbsp;these&nbsp;roots.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4488"></a>4488</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4489"></a>4489</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;But&nbsp;one&nbsp;can&nbsp;do&nbsp;better.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4490"></a>4490</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;(This&nbsp;is&nbsp;the&nbsp;approach&nbsp;used&nbsp;by&nbsp;the&nbsp;C-{\MeatAxe}.)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4491"></a>4491</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;For&nbsp;each&nbsp;irreducible&nbsp;factor&nbsp;$f$&nbsp;of&nbsp;$X^n&nbsp;-&nbsp;1$&nbsp;over&nbsp;$F$,&nbsp;the&nbsp;multiplicities
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4492"></a>4492</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;of&nbsp;its&nbsp;roots&nbsp;over&nbsp;$K$&nbsp;as&nbsp;eigenvalues&nbsp;of&nbsp;$M$&nbsp;are&nbsp;equal,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4493"></a>4493</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;hence&nbsp;one&nbsp;needs&nbsp;to&nbsp;compute&nbsp;these&nbsp;multiplicities&nbsp;and&nbsp;the&nbsp;corresponding
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4494"></a>4494</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;sums&nbsp;of&nbsp;roots&nbsp;of&nbsp;unity.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4495"></a>4495</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;The&nbsp;former&nbsp;means&nbsp;to&nbsp;solve&nbsp;an&nbsp;equation&nbsp;system&nbsp;over&nbsp;$F$,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4496"></a>4496</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;and&nbsp;the&nbsp;latter&nbsp;depends&nbsp;only&nbsp;on&nbsp;$n$&nbsp;and&nbsp;$F$,&nbsp;but&nbsp;not&nbsp;on&nbsp;$M$;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4497"></a>4497</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;so&nbsp;one&nbsp;can&nbsp;use&nbsp;a&nbsp;database&nbsp;for&nbsp;speeding&nbsp;up&nbsp;the&nbsp;computations.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4498"></a>4498</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;This&nbsp;database&nbsp;is&nbsp;implemented&nbsp;by&nbsp;the&nbsp;global&nbsp;variable&nbsp;`ZEV_DATA'&nbsp;and&nbsp;the
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4499"></a>4499</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;functions&nbsp;`ZevData'&nbsp;and&nbsp;`ZevDataValue'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4500"></a>4500</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4501"></a>4501</td><td></td><td></td><td></td><td><span><tt>InstallMethod(&nbsp;BrauerCharacterValue,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4502"></a>4502</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;matrix",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4503"></a>4503</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsMatrix&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4504"></a>4504</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;mat&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4505"></a>4505</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;n,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;order&nbsp;of&nbsp;`mat'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4506"></a>4506</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;characteristic&nbsp;of&nbsp;`mat'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4507"></a>4507</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;info,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;pairs&nbsp;returned&nbsp;by&nbsp;`ZevData'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4508"></a>4508</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Brauer&nbsp;character&nbsp;value,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4509"></a>4509</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pair,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;`info'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4510"></a>4510</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;polynomial&nbsp;part&nbsp;of&nbsp;`pair'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4511"></a>4511</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nullity;&nbsp;&nbsp;#&nbsp;dimension&nbsp;of&nbsp;a&nbsp;nullspace
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4512"></a>4512</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4513"></a>4513</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;Order(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4514"></a>4514</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4515"></a>4515</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Handle&nbsp;the&nbsp;trivial&nbsp;cases&nbsp;first.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4516"></a>4516</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4517"></a>4517</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;Length(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4518"></a>4518</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4519"></a>4519</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4520"></a>4520</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;p:=&nbsp;Characteristic(&nbsp;mat&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4521"></a>4521</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;mod&nbsp;p&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4522"></a>4522</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4523"></a>4523</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4524"></a>4524</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4525"></a>4525</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Get&nbsp;the&nbsp;complex&nbsp;values&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;irreducible
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4526"></a>4526</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;factors&nbsp;of&nbsp;$X^n&nbsp;-&nbsp;1$&nbsp;over&nbsp;$F$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4527"></a>4527</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;info:=&nbsp;ZevData(&nbsp;p^DegreeFFE(&nbsp;mat&nbsp;),&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4528"></a>4528</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4529"></a>4529</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;the&nbsp;complex&nbsp;summands,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4530"></a>4530</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;as&nbsp;quotients&nbsp;of&nbsp;nullities&nbsp;and&nbsp;degrees.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4531"></a>4531</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;value:=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4532"></a>4532</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pair&nbsp;in&nbsp;info&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4533"></a>4533</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f:=&nbsp;pair[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4534"></a>4534</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nullity:=&nbsp;Length(&nbsp;NullspaceMat(&nbsp;ValuePol(&nbsp;f,&nbsp;mat&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4535"></a>4535</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;nullity&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4536"></a>4536</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nullity:=&nbsp;nullity&nbsp;/&nbsp;(&nbsp;Length(&nbsp;f&nbsp;)&nbsp;-&nbsp;1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4537"></a>4537</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assert(&nbsp;1,&nbsp;IsInt(&nbsp;nullity&nbsp;),&nbsp;"degree&nbsp;of&nbsp;&lt;f>&nbsp;must&nbsp;divide&nbsp;&lt;nullity>"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4538"></a>4538</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:=&nbsp;value&nbsp;+&nbsp;nullity&nbsp;*&nbsp;pair[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4539"></a>4539</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4540"></a>4540</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4541"></a>4541</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4542"></a>4542</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4543"></a>4543</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4544"></a>4544</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4545"></a>4545</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4546"></a>4546</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4547"></a>4547</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4548"></a>4548</td><td></td><td></td><td></td><td><span><tt>#V&nbsp;&nbsp;ZEV_DATA
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4549"></a>4549</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4550"></a>4550</td><td></td><td></td><td></td><td><span><tt>InstallFlushableValue(&nbsp;ZEV_DATA,&nbsp;[&nbsp;[],&nbsp;[]&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4551"></a>4551</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4552"></a>4552</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4553"></a>4553</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4554"></a>4554</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4555"></a>4555</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;ZevDataValue(&nbsp;&lt;q>,&nbsp;&lt;n>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4556"></a>4556</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4557"></a>4557</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;ZevDataValue,&nbsp;function(&nbsp;q,&nbsp;n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4558"></a>4558</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;F,&nbsp;dimext,&nbsp;extfieldsize,&nbsp;Ee,&nbsp;value,&nbsp;K,&nbsp;z,&nbsp;quot,&nbsp;R,&nbsp;f,&nbsp;y,&nbsp;fac,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4559"></a>4559</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p,&nbsp;one,&nbsp;conw,&nbsp;conwlen,&nbsp;x,&nbsp;zpol,&nbsp;zpollen,&nbsp;zeta,&nbsp;zetalen,&nbsp;coeffs,&nbsp;l,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4560"></a>4560</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power,&nbsp;powerlen,&nbsp;i,&nbsp;exp,&nbsp;res,&nbsp;reslen,&nbsp;j;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4561"></a>4561</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4562"></a>4562</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;field&nbsp;$F$&nbsp;of&nbsp;matrix&nbsp;entries&nbsp;and&nbsp;the&nbsp;smallest&nbsp;field&nbsp;$K
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4563"></a>4563</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;over&nbsp;which&nbsp;a&nbsp;matrix&nbsp;of&nbsp;order&nbsp;`n'&nbsp;is&nbsp;diagonalizable.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4564"></a>4564</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;F:=&nbsp;GF(&nbsp;q&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4565"></a>4565</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;dimext:=&nbsp;DegreeOverPrimeField(&nbsp;F&nbsp;)&nbsp;*&nbsp;OrderMod(&nbsp;q,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4566"></a>4566</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;extfieldsize:=&nbsp;Characteristic(&nbsp;F&nbsp;)&nbsp;^&nbsp;dimext;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4567"></a>4567</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;Ee:=&nbsp;E(&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4568"></a>4568</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;value:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4569"></a>4569</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4570"></a>4570</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;extfieldsize&nbsp;&lt;=&nbsp;MAXSIZE_GF_INTERNAL&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4571"></a>4571</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4572"></a>4572</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;splitting&nbsp;field&nbsp;is&nbsp;supported&nbsp;in&nbsp;{\GAP},
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4573"></a>4573</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;and&nbsp;the&nbsp;stored&nbsp;primitive&nbsp;root&nbsp;is&nbsp;given&nbsp;by&nbsp;the&nbsp;Conway&nbsp;polynomial.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4574"></a>4574</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K:=&nbsp;GF(&nbsp;extfieldsize&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4575"></a>4575</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z:=&nbsp;PrimitiveRoot(&nbsp;K&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4576"></a>4576</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quot:=&nbsp;(&nbsp;extfieldsize&nbsp;-&nbsp;1&nbsp;)&nbsp;/&nbsp;n;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4577"></a>4577</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4578"></a>4578</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R:=&nbsp;PolynomialRing(&nbsp;K&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4579"></a>4579</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;f&nbsp;in&nbsp;Factors(&nbsp;PolynomialRing(&nbsp;F&nbsp;),&nbsp;Indeterminate(F)^n&nbsp;-&nbsp;1&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4580"></a>4580</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4581"></a>4581</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y:=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4582"></a>4582</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;fac&nbsp;in&nbsp;Factors(&nbsp;R,&nbsp;f&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4583"></a>4583</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4584"></a>4584</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;factors&nbsp;are&nbsp;all&nbsp;linear,&nbsp;i.e.,&nbsp;of&nbsp;the&nbsp;form&nbsp;$X&nbsp;-&nbsp;\alpha$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4585"></a>4585</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Sum&nbsp;up&nbsp;the&nbsp;lifts&nbsp;of&nbsp;the&nbsp;numbers&nbsp;$\alpha$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4586"></a>4586</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y:=&nbsp;y&nbsp;+&nbsp;Ee^&nbsp;(&nbsp;LogFFE(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4587"></a>4587</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-CoefficientsOfLaurentPolynomial(&nbsp;fac&nbsp;)[1][1],&nbsp;z&nbsp;)&nbsp;/&nbsp;quot&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4588"></a>4588</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4589"></a>4589</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4590"></a>4590</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;value,&nbsp;[&nbsp;CoefficientsOfLaurentPolynomial(&nbsp;f&nbsp;)[1],&nbsp;y&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4591"></a>4591</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4592"></a>4592</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4593"></a>4593</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4594"></a>4594</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4595"></a>4595</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4596"></a>4596</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;splitting&nbsp;field&nbsp;is&nbsp;not&nbsp;available&nbsp;in&nbsp;{\GAP},
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4597"></a>4597</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;use&nbsp;computations&nbsp;with&nbsp;polynomials.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4598"></a>4598</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p:=&nbsp;Characteristic(&nbsp;F&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4599"></a>4599</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z:=&nbsp;PrimitiveRoot(&nbsp;F&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4600"></a>4600</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4601"></a>4601</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;one:=&nbsp;One(&nbsp;F&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4602"></a>4602</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conw:=&nbsp;ConwayPol(&nbsp;p,&nbsp;dimext&nbsp;)&nbsp;*&nbsp;one;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4603"></a>4603</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conwlen:=&nbsp;dimext&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4604"></a>4604</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x:=&nbsp;[&nbsp;Zero(&nbsp;F&nbsp;),&nbsp;one&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4605"></a>4605</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4606"></a>4606</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;polynomial&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;primitive&nbsp;root&nbsp;of&nbsp;`F'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4607"></a>4607</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zpol:=&nbsp;PowerModCoeffs(&nbsp;x,&nbsp;2,&nbsp;(&nbsp;extfieldsize-1&nbsp;)&nbsp;/&nbsp;(&nbsp;Size(F)-1&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4608"></a>4608</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conw,&nbsp;conwlen&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4609"></a>4609</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zpollen:=&nbsp;Length(&nbsp;zpol&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4610"></a>4610</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4611"></a>4611</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;polynomial&nbsp;corresponding&nbsp;to&nbsp;a&nbsp;primitive&nbsp;`n'-th&nbsp;root&nbsp;$\zeta$
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4612"></a>4612</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeta:=&nbsp;PowerModCoeffs(&nbsp;x,&nbsp;2,&nbsp;(&nbsp;extfieldsize-1&nbsp;)&nbsp;/&nbsp;n,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4613"></a>4613</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conw,&nbsp;conwlen&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4614"></a>4614</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zetalen:=&nbsp;Length(&nbsp;zeta&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4615"></a>4615</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4616"></a>4616</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;f&nbsp;in&nbsp;Factors(&nbsp;PolynomialRing(&nbsp;F&nbsp;),&nbsp;Indeterminate(F)^n&nbsp;-&nbsp;1&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4617"></a>4617</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4618"></a>4618</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y:=&nbsp;0;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4619"></a>4619</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coeffs:=&nbsp;CoefficientsOfUnivariatePolynomial(&nbsp;f&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4620"></a>4620</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l:=&nbsp;Length(&nbsp;coeffs&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4621"></a>4621</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;power:=&nbsp;[&nbsp;one&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4622"></a>4622</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;powerlen:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4623"></a>4623</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4624"></a>4624</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;0&nbsp;..&nbsp;n-1&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4625"></a>4625</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4626"></a>4626</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;$\sum_{j=0}^{l-1}&nbsp;c_j&nbsp;\zeta^{i&nbsp;j}$,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4627"></a>4627</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;where&nbsp;`f'&nbsp;has&nbsp;the&nbsp;form&nbsp;$\sum_{j=0}^{l-1}&nbsp;c_j&nbsp;X^j$.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4628"></a>4628</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp:=&nbsp;LogFFE(&nbsp;coeffs[l],&nbsp;z&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4629"></a>4629</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;exp&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4630"></a>4630</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res:=&nbsp;[&nbsp;one&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4631"></a>4631</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4632"></a>4632</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res:=&nbsp;PowerModCoeffs(&nbsp;zpol,&nbsp;zpollen,&nbsp;exp,&nbsp;conw,&nbsp;conwlen&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4633"></a>4633</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4634"></a>4634</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reslen:=&nbsp;Length(&nbsp;res&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4635"></a>4635</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;l-1&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4636"></a>4636</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reslen:=&nbsp;MultCoeffs(&nbsp;res,&nbsp;res,&nbsp;reslen,&nbsp;power,&nbsp;powerlen&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4637"></a>4637</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsZero(&nbsp;coeffs[l-j]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4638"></a>4638</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exp:=&nbsp;LogFFE(&nbsp;coeffs[l-j],&nbsp;z&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4639"></a>4639</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;exp&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4640"></a>4640</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res:=&nbsp;res&nbsp;+&nbsp;[&nbsp;one&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4641"></a>4641</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4642"></a>4642</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res:=&nbsp;res&nbsp;+&nbsp;PowerModCoeffs(&nbsp;zpol,&nbsp;zpollen,&nbsp;exp,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4643"></a>4643</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conw,&nbsp;conwlen&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4644"></a>4644</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4645"></a>4645</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4646"></a>4646</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reslen:=&nbsp;ReduceCoeffs(&nbsp;res,&nbsp;Length(&nbsp;res&nbsp;),&nbsp;conw,&nbsp;conwlen&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4647"></a>4647</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ShrinkRowVector(&nbsp;res&nbsp;);&nbsp;&nbsp;#&nbsp;needed?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4648"></a>4648</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reslen:=&nbsp;Length(&nbsp;res&nbsp;);&nbsp;&nbsp;#&nbsp;needed?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4649"></a>4649</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4650"></a>4650</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4651"></a>4651</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;If&nbsp;$\zeta^i$&nbsp;is&nbsp;a&nbsp;root&nbsp;of&nbsp;`f'&nbsp;then&nbsp;take&nbsp;the&nbsp;corresponding
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4652"></a>4652</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;complex&nbsp;root&nbsp;of&nbsp;unity.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4653"></a>4653</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;reslen&nbsp;=&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4654"></a>4654</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y:=&nbsp;y&nbsp;+&nbsp;Ee^i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4655"></a>4655</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4656"></a>4656</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4657"></a>4657</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;powerlen:=&nbsp;MultCoeffs(&nbsp;power,&nbsp;power,&nbsp;powerlen,&nbsp;zeta,&nbsp;zetalen&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4658"></a>4658</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;powerlen:=&nbsp;ReduceCoeffs(&nbsp;power,&nbsp;powerlen,&nbsp;conw,&nbsp;conwlen&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4659"></a>4659</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4660"></a>4660</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4661"></a>4661</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4662"></a>4662</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;value,&nbsp;[&nbsp;coeffs,&nbsp;y&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4663"></a>4663</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4664"></a>4664</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4665"></a>4665</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4666"></a>4666</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4667"></a>4667</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4668"></a>4668</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4669"></a>4669</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4670"></a>4670</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4671"></a>4671</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4672"></a>4672</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4673"></a>4673</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4674"></a>4674</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;ZevData(&nbsp;&lt;q>,&nbsp;&lt;n>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4675"></a>4675</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;ZevData(&nbsp;&lt;q>,&nbsp;&lt;n>,&nbsp;&lt;listofpairs>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4676"></a>4676</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4677"></a>4677</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;ZevData,&nbsp;function(&nbsp;arg&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4678"></a>4678</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;q,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4679"></a>4679</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4680"></a>4680</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4681"></a>4681</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos2;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4682"></a>4682</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4683"></a>4683</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;q:=&nbsp;arg[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4684"></a>4684</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;n:=&nbsp;arg[2];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4685"></a>4685</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4686"></a>4686</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pos:=&nbsp;Position(&nbsp;ZEV_DATA[1],&nbsp;q&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4687"></a>4687</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pos&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4688"></a>4688</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;ZEV_DATA[1],&nbsp;q&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4689"></a>4689</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;ZEV_DATA[2],&nbsp;[&nbsp;[],&nbsp;[]&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4690"></a>4690</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos:=&nbsp;Length(&nbsp;ZEV_DATA[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4691"></a>4691</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4692"></a>4692</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4693"></a>4693</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pos2:=&nbsp;Position(&nbsp;ZEV_DATA[2][&nbsp;pos&nbsp;][1],&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4694"></a>4694</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pos2&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4695"></a>4695</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;ZEV_DATA[2][&nbsp;pos&nbsp;][1],&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4696"></a>4696</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos2:=&nbsp;Length(&nbsp;ZEV_DATA[2][&nbsp;pos&nbsp;][1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4697"></a>4697</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4698"></a>4698</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4699"></a>4699</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;arg&nbsp;)&nbsp;=&nbsp;3&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4700"></a>4700</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4701"></a>4701</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Store&nbsp;the&nbsp;third&nbsp;argument&nbsp;at&nbsp;this&nbsp;position.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4702"></a>4702</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsBound(&nbsp;ZEV_DATA[2][&nbsp;pos&nbsp;][2][&nbsp;pos2&nbsp;]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4703"></a>4703</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ZEV_DATA[2][&nbsp;pos&nbsp;][2][&nbsp;pos2&nbsp;]&nbsp;=&nbsp;arg[3]&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4704"></a>4704</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Info(&nbsp;InfoWarning,&nbsp;1,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4705"></a>4705</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ZevData(&nbsp;",&nbsp;q,&nbsp;",&nbsp;",&nbsp;n,&nbsp;"&nbsp;)&nbsp;was&nbsp;already&nbsp;stored"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4706"></a>4706</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4707"></a>4707</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"incompatible&nbsp;ZevData(&nbsp;",&nbsp;q,&nbsp;",&nbsp;",&nbsp;n,&nbsp;"&nbsp;)"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4708"></a>4708</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4709"></a>4709</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4710"></a>4710</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEV_DATA[2][&nbsp;pos&nbsp;][2][&nbsp;pos2&nbsp;]:=&nbsp;Immutable(&nbsp;arg[3]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4711"></a>4711</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;arg[3];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4712"></a>4712</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4713"></a>4713</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4714"></a>4714</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4715"></a>4715</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Get&nbsp;the&nbsp;entry.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4716"></a>4716</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsBound(&nbsp;ZEV_DATA[2][&nbsp;pos&nbsp;][2][&nbsp;pos2&nbsp;]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4717"></a>4717</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEV_DATA[2][&nbsp;pos&nbsp;][2][&nbsp;pos2&nbsp;]:=&nbsp;ZevDataValue(&nbsp;q,&nbsp;n&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4718"></a>4718</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4719"></a>4719</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ZEV_DATA[2][&nbsp;pos&nbsp;][2][&nbsp;pos2&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4720"></a>4720</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4721"></a>4721</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4722"></a>4722</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4723"></a>4723</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4724"></a>4724</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4725"></a>4725</td><td></td><td></td><td></td><td><span><tt>##############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4726"></a>4726</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4727"></a>4727</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;RealizableBrauerCharacters(&nbsp;&lt;matrix>,&nbsp;&lt;q>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4728"></a>4728</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4729"></a>4729</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;RealizableBrauerCharacters,&nbsp;function(&nbsp;matrix,&nbsp;q&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4730"></a>4730</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;result,&nbsp;factors,&nbsp;p,&nbsp;m,&nbsp;done,&nbsp;row,&nbsp;d,&nbsp;g,&nbsp;qq,&nbsp;image,&nbsp;newrow,&nbsp;i;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4731"></a>4731</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4732"></a>4732</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;result:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4733"></a>4733</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;factors:=&nbsp;Factors(&nbsp;q&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4734"></a>4734</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;p:=&nbsp;factors[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4735"></a>4735</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;m:=&nbsp;Length(&nbsp;factors&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4736"></a>4736</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;done:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4737"></a>4737</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4738"></a>4738</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;row&nbsp;in&nbsp;matrix&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4739"></a>4739</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;row&nbsp;in&nbsp;done&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4740"></a>4740</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d:=&nbsp;SizeOfFieldOfDefinition(&nbsp;row,&nbsp;p&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4741"></a>4741</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;d&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4742"></a>4742</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4743"></a>4743</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4744"></a>4744</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d:=&nbsp;Length(&nbsp;Factors(&nbsp;d&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4745"></a>4745</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g:=&nbsp;Gcd(&nbsp;d,&nbsp;m&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4746"></a>4746</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qq:=&nbsp;p^g;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4747"></a>4747</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image:=&nbsp;row;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4748"></a>4748</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newrow:=&nbsp;row;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4749"></a>4749</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;done,&nbsp;row&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4750"></a>4750</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4751"></a>4751</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;d/g-1&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4752"></a>4752</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image:=&nbsp;GaloisCyc(&nbsp;image,&nbsp;qq&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4753"></a>4753</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newrow:=&nbsp;newrow&nbsp;+&nbsp;image;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4754"></a>4754</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;done,&nbsp;image&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4755"></a>4755</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4756"></a>4756</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4757"></a>4757</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;newrow&nbsp;in&nbsp;result&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4758"></a>4758</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;result,&nbsp;newrow&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4759"></a>4759</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4760"></a>4760</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4761"></a>4761</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4762"></a>4762</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4763"></a>4763</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4764"></a>4764</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4765"></a>4765</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4766"></a>4766</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4767"></a>4767</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4768"></a>4768</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4769"></a>4769</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;13.&nbsp;Domains&nbsp;Generated&nbsp;by&nbsp;Class&nbsp;Functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4770"></a>4770</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4771"></a>4771</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4772"></a>4772</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4773"></a>4773</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4774"></a>4774</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4775"></a>4775</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;GroupWithGenerators(&nbsp;&lt;classfuns>[,&nbsp;&lt;id>]&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4776"></a>4776</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4777"></a>4777</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;GroupWithGenerators,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4778"></a>4778</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;a&nbsp;homogeneous&nbsp;list&nbsp;(of&nbsp;class&nbsp;functions)",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4779"></a>4779</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4780"></a>4780</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;gens&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4781"></a>4781</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;filter,&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4782"></a>4782</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4783"></a>4783</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Check&nbsp;that&nbsp;the&nbsp;list&nbsp;consists&nbsp;of&nbsp;invertible&nbsp;class&nbsp;functions.
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line4784"></a>4784</td><td>114</td><td>126</td><td>1,087</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsEmpty(&nbsp;gens&nbsp;)&nbsp;or&nbsp;not&nbsp;ForAll(&nbsp;gens,&nbsp;IsClassFunction&nbsp;)&nbsp;then
</tt></span></td><td><span><a href="_opt_gap_gap4r8p7_lib_coll.gi.html#line105">/opt/gap/gap4r8p7/lib/coll.gi:105</a> <a href="_opt_gap_gap4r8p7_lib_coll.gi.html#line1608">ForAll</a> </span></td></tr>
<tr class='exec'><td><a name="line4785"></a>4785</td><td>38</td><td>331</td><td>331</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4786"></a>4786</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;ForAny(&nbsp;gens,&nbsp;psi&nbsp;->&nbsp;Inverse(&nbsp;psi&nbsp;)&nbsp;=&nbsp;fail&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4787"></a>4787</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"class&nbsp;functions&nbsp;in&nbsp;&lt;gens>&nbsp;must&nbsp;be&nbsp;invertible"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4788"></a>4788</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;move&nbsp;to&nbsp;`IsGeneratorsOfGroup'
</tt></span></td><td><span></span></td></tr>
<tr class='exec'><td><a name="line4789"></a>4789</td><td>38</td><td>11</td><td>11</td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4790"></a>4790</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4791"></a>4791</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;filter:=&nbsp;IsGroup&nbsp;and&nbsp;IsAttributeStoringRep;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4792"></a>4792</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsFinite(&nbsp;gens&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4793"></a>4793</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filter:=&nbsp;filter&nbsp;and&nbsp;IsFinitelyGeneratedGroup;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4794"></a>4794</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4795"></a>4795</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4796"></a>4796</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Construct&nbsp;the&nbsp;group.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4797"></a>4797</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;G:=&nbsp;Objectify(&nbsp;NewType(&nbsp;FamilyObj(&nbsp;gens&nbsp;),&nbsp;filter&nbsp;),&nbsp;rec()&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4798"></a>4798</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetGeneratorsOfMagmaWithInverses(&nbsp;G,&nbsp;AsList(&nbsp;gens&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4799"></a>4799</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4800"></a>4800</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4801"></a>4801</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4802"></a>4802</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;GroupWithGenerators,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4803"></a>4803</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;list&nbsp;(of&nbsp;class&nbsp;functions)&nbsp;and&nbsp;class&nbsp;function",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4804"></a>4804</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsCollsElms,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4805"></a>4805</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsHomogeneousList,&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4806"></a>4806</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;gens,&nbsp;id&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4807"></a>4807</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;filter,&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4808"></a>4808</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4809"></a>4809</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Check&nbsp;that&nbsp;the&nbsp;class&nbsp;functions&nbsp;are&nbsp;invertible.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4810"></a>4810</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;ForAll(&nbsp;gens,&nbsp;IsClassFunction&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4811"></a>4811</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4812"></a>4812</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;ForAny(&nbsp;gens,&nbsp;psi&nbsp;->&nbsp;Inverse(&nbsp;psi&nbsp;)&nbsp;=&nbsp;fail&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4813"></a>4813</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"class&nbsp;functions&nbsp;in&nbsp;&lt;gens>&nbsp;must&nbsp;be&nbsp;invertible"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4814"></a>4814</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;move&nbsp;to&nbsp;`IsGeneratorsOfGroup'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4815"></a>4815</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;not&nbsp;IsOne(&nbsp;id&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4816"></a>4816</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;id>&nbsp;must&nbsp;be&nbsp;an&nbsp;identity"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4817"></a>4817</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4818"></a>4818</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4819"></a>4819</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;filter:=&nbsp;IsGroup&nbsp;and&nbsp;IsAttributeStoringRep;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4820"></a>4820</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsFinite(&nbsp;gens&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4821"></a>4821</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filter:=&nbsp;filter&nbsp;and&nbsp;IsFinitelyGeneratedGroup;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4822"></a>4822</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4823"></a>4823</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4824"></a>4824</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Construct&nbsp;the&nbsp;group.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4825"></a>4825</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;G:=&nbsp;Objectify(&nbsp;NewType(&nbsp;FamilyObj(&nbsp;gens&nbsp;),&nbsp;filter),&nbsp;rec()&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4826"></a>4826</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetGeneratorsOfMagmaWithInverses(&nbsp;G,&nbsp;AsList(&nbsp;gens&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4827"></a>4827</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetOne(&nbsp;G,&nbsp;id&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4828"></a>4828</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4829"></a>4829</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4830"></a>4830</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4831"></a>4831</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;GroupWithGenerators,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4832"></a>4832</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;empty&nbsp;list&nbsp;and&nbsp;trivial&nbsp;character",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4833"></a>4833</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsList&nbsp;and&nbsp;IsEmpty,&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4834"></a>4834</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;empty,&nbsp;id&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4835"></a>4835</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4836"></a>4836</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4837"></a>4837</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsOne(&nbsp;id&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4838"></a>4838</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"&lt;id>&nbsp;must&nbsp;be&nbsp;an&nbsp;identity"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4839"></a>4839</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4840"></a>4840</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4841"></a>4841</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Construct&nbsp;the&nbsp;group.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4842"></a>4842</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;G:=&nbsp;Objectify(&nbsp;NewType(&nbsp;CollectionsFamily(&nbsp;FamilyObj(&nbsp;id&nbsp;)&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4843"></a>4843</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsGroup&nbsp;and&nbsp;IsAttributeStoringRep&nbsp;and
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4844"></a>4844</td><td></td><td></td><td></td><td><span><tt>			&nbsp;&nbsp;&nbsp;&nbsp;IsFinitelyGeneratedGroup&nbsp;and&nbsp;IsTrivial&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4845"></a>4845</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4846"></a>4846</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rec()&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4847"></a>4847</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetGeneratorsOfMagmaWithInverses(&nbsp;G,&nbsp;empty&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4848"></a>4848</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetOne(&nbsp;G,&nbsp;id&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4849"></a>4849</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;G;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4850"></a>4850</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4851"></a>4851</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4852"></a>4852</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4853"></a>4853</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4854"></a>4854</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4855"></a>4855</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;5.&nbsp;vector&nbsp;spaces&nbsp;of&nbsp;class&nbsp;functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4856"></a>4856</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4857"></a>4857</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Free&nbsp;left&nbsp;modules&nbsp;and&nbsp;algebras&nbsp;of&nbsp;class&nbsp;functions&nbsp;are&nbsp;handled&nbsp;by&nbsp;nice
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4858"></a>4858</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;bases,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4859"></a>4859</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;for&nbsp;admitting&nbsp;the&nbsp;default&nbsp;procedure&nbsp;of&nbsp;closure&nbsp;under&nbsp;multiplication.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4860"></a>4860</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;In&nbsp;order&nbsp;to&nbsp;apply&nbsp;`NiceVector'&nbsp;and&nbsp;`UglyVector',&nbsp;algebras&nbsp;of&nbsp;class
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4861"></a>4861</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;functions&nbsp;are&nbsp;in&nbsp;the&nbsp;filter&nbsp;`IsClassFunctionsSpace'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4862"></a>4862</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4863"></a>4863</td><td></td><td></td><td></td><td><span><tt>InstallHandlingByNiceBasis(&nbsp;"IsClassFunctionsSpace",&nbsp;rec(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4864"></a>4864</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;detect:=&nbsp;function(&nbsp;R,&nbsp;gens,&nbsp;V,&nbsp;zero&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4865"></a>4865</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4866"></a>4866</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;ForAll(&nbsp;gens,&nbsp;IsClassFunction&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4867"></a>4867</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4868"></a>4868</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;zero&nbsp;=&nbsp;false&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4869"></a>4869</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;gens[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4870"></a>4870</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;not&nbsp;IsClassFunction(&nbsp;zero&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4871"></a>4871</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4872"></a>4872</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4873"></a>4873</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;zero&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4874"></a>4874</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4875"></a>4875</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ForAny(&nbsp;gens,&nbsp;chi&nbsp;->&nbsp;UnderlyingCharacterTable(&nbsp;chi&nbsp;)&nbsp;&lt;>&nbsp;tbl&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4876"></a>4876</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4877"></a>4877</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4878"></a>4878</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4879"></a>4879</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4880"></a>4880</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4881"></a>4881</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;NiceFreeLeftModuleInfo&nbsp;:=&nbsp;function(&nbsp;V&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4882"></a>4882</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;UnderlyingCharacterTable(&nbsp;Zero(&nbsp;V&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4883"></a>4883</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4884"></a>4884</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4885"></a>4885</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;NiceVector&nbsp;:=&nbsp;function(&nbsp;V,&nbsp;v&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4886"></a>4886</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;UnderlyingCharacterTable(&nbsp;v&nbsp;)&nbsp;=&nbsp;NiceFreeLeftModuleInfo(&nbsp;V&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4887"></a>4887</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ValuesOfClassFunction(&nbsp;v&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4888"></a>4888</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4889"></a>4889</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;fail;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4890"></a>4890</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4891"></a>4891</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4892"></a>4892</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4893"></a>4893</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;UglyVector&nbsp;:=&nbsp;function(&nbsp;V,&nbsp;r&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4894"></a>4894</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ClassFunction(&nbsp;NiceFreeLeftModuleInfo(&nbsp;V&nbsp;),&nbsp;r&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4895"></a>4895</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4896"></a>4896</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4897"></a>4897</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4898"></a>4898</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4899"></a>4899</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4900"></a>4900</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ScalarProduct(&nbsp;&lt;V>,&nbsp;&lt;chi>,&nbsp;&lt;psi>&nbsp;)&nbsp;.&nbsp;.&nbsp;.&nbsp;.&nbsp;&nbsp;for&nbsp;module&nbsp;of&nbsp;class&nbsp;functions
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4901"></a>4901</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4902"></a>4902</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Left&nbsp;modules&nbsp;of&nbsp;class&nbsp;functions&nbsp;carry&nbsp;the&nbsp;usual&nbsp;bilinear&nbsp;form.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4903"></a>4903</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4904"></a>4904</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;ScalarProduct,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4905"></a>4905</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;left&nbsp;module&nbsp;of&nbsp;class&nbsp;functions,&nbsp;and&nbsp;two&nbsp;class&nbsp;functions",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4906"></a>4906</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;IsCollsElmsElms,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4907"></a>4907</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsFreeLeftModule,&nbsp;IsClassFunction,&nbsp;IsClassFunction&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4908"></a>4908</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;V,&nbsp;x1,&nbsp;x2&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4909"></a>4909</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;tbl;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4910"></a>4910</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;x1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4911"></a>4911</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;tbl&nbsp;=&nbsp;UnderlyingCharacterTable(&nbsp;x2&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4912"></a>4912</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ScalarProduct(&nbsp;tbl,&nbsp;x1,&nbsp;x2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4913"></a>4913</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4914"></a>4914</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TryNextMethod();
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4915"></a>4915</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4916"></a>4916</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4917"></a>4917</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4918"></a>4918</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4919"></a>4919</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4920"></a>4920</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4921"></a>4921</td><td></td><td></td><td></td><td><span><tt>#M&nbsp;&nbsp;ScalarProduct(&nbsp;&lt;V>,&nbsp;&lt;chivals>,&nbsp;&lt;psivals>&nbsp;)&nbsp;&nbsp;.&nbsp;.&nbsp;for&nbsp;module&nbsp;of&nbsp;class&nbsp;funs.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4922"></a>4922</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4923"></a>4923</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;Left&nbsp;modules&nbsp;of&nbsp;class&nbsp;functions&nbsp;carry&nbsp;the&nbsp;usual&nbsp;bilinear&nbsp;form.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4924"></a>4924</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4925"></a>4925</td><td></td><td></td><td></td><td><span><tt>InstallOtherMethod(&nbsp;ScalarProduct,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4926"></a>4926</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;"for&nbsp;module&nbsp;of&nbsp;class&nbsp;functions,&nbsp;and&nbsp;two&nbsp;values&nbsp;lists",
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4927"></a>4927</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;IsFreeLeftModule&nbsp;and&nbsp;IsClassFunctionsSpace,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4928"></a>4928</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsHomogeneousList,&nbsp;IsHomogeneousList&nbsp;],
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4929"></a>4929</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;function(&nbsp;V,&nbsp;x1,&nbsp;x2&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4930"></a>4930</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ScalarProduct(&nbsp;NiceFreeLeftModuleInfo(&nbsp;V&nbsp;),&nbsp;x1,&nbsp;x2&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4931"></a>4931</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4932"></a>4932</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4933"></a>4933</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4934"></a>4934</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4935"></a>4935</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4936"></a>4936</td><td></td><td></td><td></td><td><span><tt>##&nbsp;&nbsp;14.&nbsp;Auxiliary&nbsp;operations
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4937"></a>4937</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4938"></a>4938</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4939"></a>4939</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4940"></a>4940</td><td></td><td></td><td></td><td><span><tt>##############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4941"></a>4941</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4942"></a>4942</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;OrbitChar(&nbsp;&lt;chi>,&nbsp;&lt;linear>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4943"></a>4943</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4944"></a>4944</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;OrbitChar,&nbsp;function(&nbsp;chi,&nbsp;linear&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4945"></a>4945</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;classes,&nbsp;&nbsp;&nbsp;#&nbsp;range&nbsp;of&nbsp;positions&nbsp;in&nbsp;`chi'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4946"></a>4946</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nofcyc,&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;describes&nbsp;the&nbsp;conductor&nbsp;of&nbsp;values&nbsp;of&nbsp;`chi'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4947"></a>4947</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gens,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;generators&nbsp;of&nbsp;Galois&nbsp;automorphism&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4948"></a>4948</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orb,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;orbit,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4949"></a>4949</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;`gens'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4950"></a>4950</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;image&nbsp;of&nbsp;`chi'&nbsp;under&nbsp;operation
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4951"></a>4951</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4952"></a>4952</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;classes:=&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;chi&nbsp;)&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4953"></a>4953</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nofcyc:=&nbsp;Conductor(&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4954"></a>4954</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4955"></a>4955</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Apply&nbsp;Galois&nbsp;automorphisms&nbsp;if&nbsp;necessary.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4956"></a>4956</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;orb:=&nbsp;[&nbsp;chi&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4957"></a>4957</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;1&nbsp;&lt;&nbsp;nofcyc&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4958"></a>4958</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gens:=&nbsp;Flat(&nbsp;GeneratorsPrimeResidues(&nbsp;nofcyc&nbsp;).generators&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4959"></a>4959</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;chi&nbsp;in&nbsp;orb&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4960"></a>4960</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gen&nbsp;in&nbsp;gens&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4961"></a>4961</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image:=&nbsp;List(&nbsp;chi,&nbsp;x&nbsp;->&nbsp;GaloisCyc(&nbsp;x,&nbsp;gen&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4962"></a>4962</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;image&nbsp;in&nbsp;orb&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4963"></a>4963</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;orb,&nbsp;image&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4964"></a>4964</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4965"></a>4965</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4966"></a>4966</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4967"></a>4967</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4968"></a>4968</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4969"></a>4969</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Apply&nbsp;multiplication&nbsp;with&nbsp;linear&nbsp;characters.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4970"></a>4970</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;chi&nbsp;in&nbsp;orb&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4971"></a>4971</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gen&nbsp;in&nbsp;linear&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4972"></a>4972</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image:=&nbsp;List(&nbsp;classes,&nbsp;x&nbsp;->&nbsp;gen[x]&nbsp;*&nbsp;chi[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4973"></a>4973</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;image&nbsp;in&nbsp;orb&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4974"></a>4974</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;orb,&nbsp;image&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4975"></a>4975</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4976"></a>4976</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4977"></a>4977</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4978"></a>4978</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4979"></a>4979</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;orbit.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4980"></a>4980</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;orb;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4981"></a>4981</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4982"></a>4982</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4983"></a>4983</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4984"></a>4984</td><td></td><td></td><td></td><td><span><tt>##############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4985"></a>4985</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4986"></a>4986</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;OrbitsCharacters(&nbsp;&lt;irr>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4987"></a>4987</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4988"></a>4988</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;OrbitsCharacters,&nbsp;function(&nbsp;irr&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4989"></a>4989</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;irrvals,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;value&nbsp;lists
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4990"></a>4990</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oldirrvals,&nbsp;&nbsp;#&nbsp;store&nbsp;original&nbsp;succession
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4991"></a>4991</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;underlying&nbsp;character&nbsp;table
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4992"></a>4992</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linear,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;linear&nbsp;characters&nbsp;of&nbsp;`tbl'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4993"></a>4993</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orbits,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;orbits,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4994"></a>4994</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indices,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;from&nbsp;1&nbsp;to&nbsp;number&nbsp;of&nbsp;conjugacy&nbsp;classes&nbsp;of&nbsp;`tbl'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4995"></a>4995</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orb,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;orbit
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4996"></a>4996</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gens,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;generators&nbsp;of&nbsp;the&nbsp;acting&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4997"></a>4997</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chi,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;irreducible&nbsp;character
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4998"></a>4998</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gen,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;generator&nbsp;of&nbsp;the&nbsp;acting&nbsp;group
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line4999"></a>4999</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;image&nbsp;of&nbsp;a&nbsp;character
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5000"></a>5000</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;one&nbsp;orbit
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5001"></a>5001</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;position&nbsp;of&nbsp;value&nbsp;list&nbsp;in&nbsp;`oldirrvals'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5002"></a>5002</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5003"></a>5003</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;orbits:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5004"></a>5004</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5005"></a>5005</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsEmpty(&nbsp;irr&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5006"></a>5006</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5007"></a>5007</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsClassFunction(&nbsp;irr[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5008"></a>5008</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5009"></a>5009</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Replace&nbsp;group&nbsp;characters&nbsp;by&nbsp;their&nbsp;value&nbsp;lists.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5010"></a>5010</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Store&nbsp;the&nbsp;succession&nbsp;in&nbsp;the&nbsp;original&nbsp;list.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5011"></a>5011</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irrvals:=&nbsp;List(&nbsp;irr,&nbsp;ValuesOfClassFunction&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5012"></a>5012</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oldirrvals:=&nbsp;ShallowCopy(&nbsp;irrvals&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5013"></a>5013</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irrvals:=&nbsp;Set(&nbsp;irrvals&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5014"></a>5014</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5015"></a>5015</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5016"></a>5016</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irrvals:=&nbsp;Set(&nbsp;irr&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5017"></a>5017</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5018"></a>5018</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5019"></a>5019</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indices:=&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;irrvals[1]&nbsp;)&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5020"></a>5020</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5021"></a>5021</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;orbit&nbsp;of&nbsp;linear&nbsp;characters&nbsp;if&nbsp;there&nbsp;are&nbsp;any.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5022"></a>5022</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linear:=&nbsp;Filtered(&nbsp;irrvals,&nbsp;x&nbsp;->&nbsp;x[1]&nbsp;=&nbsp;1&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5023"></a>5023</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5024"></a>5024</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;0&nbsp;&lt;&nbsp;Length(&nbsp;linear&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5025"></a>5025</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5026"></a>5026</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;The&nbsp;linear&nbsp;characters&nbsp;form&nbsp;an&nbsp;orbit.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5027"></a>5027</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;We&nbsp;remove&nbsp;them&nbsp;from&nbsp;the&nbsp;other&nbsp;characters,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5028"></a>5028</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;and&nbsp;remove&nbsp;the&nbsp;trivial&nbsp;character&nbsp;from&nbsp;`linear'.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5029"></a>5029</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orb:=&nbsp;ShallowCopy(&nbsp;linear&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5030"></a>5030</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SubtractSet(&nbsp;irrvals,&nbsp;linear&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5031"></a>5031</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RemoveSet(&nbsp;linear,&nbsp;List(&nbsp;linear[1],&nbsp;x&nbsp;->&nbsp;1&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5032"></a>5032</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5033"></a>5033</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Make&nbsp;`linear'&nbsp;closed&nbsp;under&nbsp;Galois&nbsp;automorphisms.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5034"></a>5034</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gens:=&nbsp;Flat(&nbsp;GeneratorsPrimeResidues(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5035"></a>5035</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Conductor(&nbsp;Flat(&nbsp;linear&nbsp;)&nbsp;)&nbsp;).generators&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5036"></a>5036</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5037"></a>5037</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;chi&nbsp;in&nbsp;orb&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5038"></a>5038</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gen&nbsp;in&nbsp;gens&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5039"></a>5039</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image:=&nbsp;List(&nbsp;chi,&nbsp;x&nbsp;->&nbsp;GaloisCyc(&nbsp;x,&nbsp;gen&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5040"></a>5040</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;image&nbsp;in&nbsp;orb&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5041"></a>5041</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;orb,&nbsp;image&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5042"></a>5042</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5043"></a>5043</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5044"></a>5044</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5045"></a>5045</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5046"></a>5046</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Make&nbsp;`linear'&nbsp;closed&nbsp;under&nbsp;multiplication&nbsp;with&nbsp;linear&nbsp;characters.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5047"></a>5047</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;chi&nbsp;in&nbsp;orb&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5048"></a>5048</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;gen&nbsp;in&nbsp;linear&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5049"></a>5049</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image:=&nbsp;List(&nbsp;indices,&nbsp;x&nbsp;->&nbsp;gen[x]&nbsp;*&nbsp;chi[x]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5050"></a>5050</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;image&nbsp;in&nbsp;orb&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5051"></a>5051</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;orb,&nbsp;image&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5052"></a>5052</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5053"></a>5053</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5054"></a>5054</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5055"></a>5055</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5056"></a>5056</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orbits[1]:=&nbsp;orb;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5057"></a>5057</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5058"></a>5058</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5059"></a>5059</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5060"></a>5060</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;the&nbsp;other&nbsp;orbits.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5061"></a>5061</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;Length(&nbsp;irrvals&nbsp;)&nbsp;>&nbsp;0&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5062"></a>5062</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5063"></a>5063</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orb:=&nbsp;OrbitChar(&nbsp;irrvals[1],&nbsp;linear&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5064"></a>5064</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;orbits,&nbsp;orb&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5065"></a>5065</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SubtractSet(&nbsp;irrvals,&nbsp;orb&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5066"></a>5066</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5067"></a>5067</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5068"></a>5068</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5069"></a>5069</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Replace&nbsp;the&nbsp;value&nbsp;lists&nbsp;by&nbsp;the&nbsp;group&nbsp;characters
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5070"></a>5070</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;the&nbsp;input&nbsp;was&nbsp;a&nbsp;list&nbsp;of&nbsp;characters.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5071"></a>5071</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Be&nbsp;careful&nbsp;not&nbsp;to&nbsp;copy&nbsp;characters&nbsp;if&nbsp;not&nbsp;necessary.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5072"></a>5072</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsCharacter(&nbsp;irr[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5073"></a>5073</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tbl:=&nbsp;UnderlyingCharacterTable(&nbsp;irr[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5074"></a>5074</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;orb&nbsp;in&nbsp;orbits&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5075"></a>5075</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;orb&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5076"></a>5076</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos:=&nbsp;Position(&nbsp;oldirrvals,&nbsp;orb[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5077"></a>5077</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pos&nbsp;=&nbsp;fail&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5078"></a>5078</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orb[i]:=&nbsp;Character(&nbsp;tbl,&nbsp;orb[i]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5079"></a>5079</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5080"></a>5080</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orb[i]:=&nbsp;irr[&nbsp;pos&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5081"></a>5081</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5082"></a>5082</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5083"></a>5083</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5084"></a>5084</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5085"></a>5085</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5086"></a>5086</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5087"></a>5087</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5088"></a>5088</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;orbits;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5089"></a>5089</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5090"></a>5090</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5091"></a>5091</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5092"></a>5092</td><td></td><td></td><td></td><td><span><tt>##############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5093"></a>5093</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5094"></a>5094</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;OrbitRepresentativesCharacters(&nbsp;&lt;irr>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5095"></a>5095</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5096"></a>5096</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;OrbitRepresentativesCharacters,&nbsp;function(&nbsp;irr&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5097"></a>5097</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;irrvals,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;value&nbsp;lists
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5098"></a>5098</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oldirrvals,&nbsp;&nbsp;#&nbsp;store&nbsp;original&nbsp;succession
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5099"></a>5099</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chi,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;loop&nbsp;over&nbsp;`irrvals'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5100"></a>5100</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linear,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;linear&nbsp;characters&nbsp;in&nbsp;`irr'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5101"></a>5101</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nonlin,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;nonlinear&nbsp;characters&nbsp;in&nbsp;`irr'
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5102"></a>5102</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repres,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;list&nbsp;of&nbsp;representatives,&nbsp;result
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5103"></a>5103</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orb;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;one&nbsp;orbit
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5104"></a>5104</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5105"></a>5105</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;repres:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5106"></a>5106</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5107"></a>5107</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsEmpty(&nbsp;irr&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5108"></a>5108</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5109"></a>5109</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsCharacter(&nbsp;irr[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5110"></a>5110</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5111"></a>5111</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Replace&nbsp;group&nbsp;characters&nbsp;by&nbsp;their&nbsp;value&nbsp;lists.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5112"></a>5112</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Store&nbsp;the&nbsp;succession&nbsp;in&nbsp;the&nbsp;original&nbsp;list.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5113"></a>5113</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irrvals:=&nbsp;List(&nbsp;irr,&nbsp;ValuesOfClassFunction&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5114"></a>5114</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oldirrvals:=&nbsp;ShallowCopy(&nbsp;irrvals&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5115"></a>5115</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irrvals:=&nbsp;Set(&nbsp;irrvals&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5116"></a>5116</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5117"></a>5117</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5118"></a>5118</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irrvals:=&nbsp;Set(&nbsp;irr&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5119"></a>5119</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5120"></a>5120</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5121"></a>5121</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Get&nbsp;the&nbsp;linear&nbsp;characters.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5122"></a>5122</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linear&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5123"></a>5123</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nonlin&nbsp;:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5124"></a>5124</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;chi&nbsp;in&nbsp;irrvals&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5125"></a>5125</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;chi[1]&nbsp;=&nbsp;1&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5126"></a>5126</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;linear,&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5127"></a>5127</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5128"></a>5128</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;nonlin,&nbsp;chi&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5129"></a>5129</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5130"></a>5130</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5131"></a>5131</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;linear&nbsp;)&nbsp;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5132"></a>5132</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repres[1]:=&nbsp;linear[1];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5133"></a>5133</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5134"></a>5134</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5135"></a>5135</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;orbits&nbsp;and&nbsp;remove&nbsp;them&nbsp;until&nbsp;the&nbsp;set&nbsp;is&nbsp;empty.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5136"></a>5136</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;Length(&nbsp;nonlin&nbsp;)&nbsp;>&nbsp;0&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5137"></a>5137</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(&nbsp;repres,&nbsp;nonlin[1]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5138"></a>5138</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;orb:=&nbsp;OrbitChar(&nbsp;nonlin[1],&nbsp;linear&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5139"></a>5139</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SubtractSet(&nbsp;nonlin,&nbsp;orb&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5140"></a>5140</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5141"></a>5141</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5142"></a>5142</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Replace&nbsp;the&nbsp;value&nbsp;lists&nbsp;by&nbsp;the&nbsp;group&nbsp;characters
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5143"></a>5143</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;if&nbsp;the&nbsp;input&nbsp;was&nbsp;a&nbsp;list&nbsp;of&nbsp;characters.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5144"></a>5144</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Do&nbsp;not&nbsp;copy&nbsp;characters!
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5145"></a>5145</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;IsCharacter(&nbsp;irr[1]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5146"></a>5146</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repres:=&nbsp;List(&nbsp;repres,&nbsp;x&nbsp;->&nbsp;irr[&nbsp;Position(&nbsp;oldirrvals,&nbsp;x&nbsp;)&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5147"></a>5147</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5148"></a>5148</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5149"></a>5149</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5150"></a>5150</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5151"></a>5151</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Return&nbsp;the&nbsp;representatives.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5152"></a>5152</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;repres;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5153"></a>5153</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5154"></a>5154</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5155"></a>5155</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5156"></a>5156</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5157"></a>5157</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5158"></a>5158</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;CharacterTableQuaternionic(&nbsp;&lt;4n>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5159"></a>5159</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5160"></a>5160</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;CharacterTableQuaternionic,&nbsp;function(&nbsp;4n&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5161"></a>5161</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;quaternionic;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5162"></a>5162</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5163"></a>5163</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;4n&nbsp;mod&nbsp;4&nbsp;&lt;>&nbsp;0&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5164"></a>5164</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(&nbsp;"argument&nbsp;must&nbsp;be&nbsp;a&nbsp;multiple&nbsp;of&nbsp;4"&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5165"></a>5165</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;4n&nbsp;=&nbsp;4&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5166"></a>5166</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quaternionic:=&nbsp;CharacterTable(&nbsp;"Cyclic",&nbsp;4&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5167"></a>5167</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5168"></a>5168</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quaternionic:=&nbsp;CharacterTableIsoclinic(
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5169"></a>5169</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CharacterTable(&nbsp;"Dihedral",&nbsp;4n&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5170"></a>5170</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;1&nbsp;..&nbsp;4n&nbsp;/&nbsp;4&nbsp;+&nbsp;1&nbsp;]&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5171"></a>5171</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5172"></a>5172</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;ResetFilterObj(&nbsp;quaternionic,&nbsp;HasIdentifier&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5173"></a>5173</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;SetIdentifier(&nbsp;quaternionic,&nbsp;Concatenation(&nbsp;"Q",&nbsp;String(&nbsp;4n&nbsp;)&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5174"></a>5174</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;quaternionic;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5175"></a>5175</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5176"></a>5176</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5177"></a>5177</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5178"></a>5178</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5179"></a>5179</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5180"></a>5180</td><td></td><td></td><td></td><td><span><tt>#F&nbsp;&nbsp;CollapsedMat(&nbsp;&lt;mat>,&nbsp;&lt;maps>&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5181"></a>5181</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5182"></a>5182</td><td></td><td></td><td></td><td><span><tt>InstallGlobalFunction(&nbsp;CollapsedMat,&nbsp;function(&nbsp;mat,&nbsp;maps&nbsp;)
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5183"></a>5183</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;i,&nbsp;j,&nbsp;k,&nbsp;nontrivblock,&nbsp;nontrivblocks,&nbsp;row,&nbsp;newblocks,&nbsp;values,
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5184"></a>5184</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blocks,&nbsp;pos,&nbsp;minima,&nbsp;fusion;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5185"></a>5185</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5186"></a>5186</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Compute&nbsp;successivly&nbsp;the&nbsp;partition&nbsp;of&nbsp;column&nbsp;families&nbsp;defined&nbsp;by
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5187"></a>5187</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;rows&nbsp;already&nbsp;processed.
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5188"></a>5188</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nontrivblocks:=&nbsp;[&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;mat[1]&nbsp;)&nbsp;]&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5189"></a>5189</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;row&nbsp;in&nbsp;Concatenation(&nbsp;maps,&nbsp;mat&nbsp;)&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5190"></a>5190</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newblocks:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5191"></a>5191</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;nontrivblock&nbsp;in&nbsp;nontrivblocks&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5192"></a>5192</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5193"></a>5193</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blocks:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5194"></a>5194</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;nontrivblock&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5195"></a>5195</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5196"></a>5196</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;pos&nbsp;&lt;=&nbsp;Length(&nbsp;values&nbsp;)&nbsp;and&nbsp;values[&nbsp;pos&nbsp;]&nbsp;&lt;>&nbsp;row[k]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5197"></a>5197</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos:=&nbsp;pos&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5198"></a>5198</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5199"></a>5199</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;Length(&nbsp;values&nbsp;)&nbsp;&lt;&nbsp;pos&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5200"></a>5200</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;values[&nbsp;pos&nbsp;]:=&nbsp;row[k];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5201"></a>5201</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blocks[&nbsp;pos&nbsp;]:=&nbsp;[&nbsp;k&nbsp;];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5202"></a>5202</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5203"></a>5203</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddSet(&nbsp;blocks[&nbsp;pos&nbsp;],&nbsp;k&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5204"></a>5204</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5205"></a>5205</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5206"></a>5206</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;k&nbsp;in&nbsp;blocks&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5207"></a>5207</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;1&nbsp;&lt;&nbsp;Length(&nbsp;k&nbsp;)&nbsp;then&nbsp;Add(&nbsp;newblocks,&nbsp;k&nbsp;);&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5208"></a>5208</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5209"></a>5209</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5210"></a>5210</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nontrivblocks:=&nbsp;newblocks;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5211"></a>5211</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5212"></a>5212</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5213"></a>5213</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;minima:=&nbsp;List(&nbsp;nontrivblocks,&nbsp;Minimum&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5214"></a>5214</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;nontrivblocks:=&nbsp;Permuted(&nbsp;nontrivblocks,&nbsp;Sortex(&nbsp;minima&nbsp;)&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5215"></a>5215</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;minima:=&nbsp;Concatenation(&nbsp;[&nbsp;0&nbsp;],&nbsp;minima&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5216"></a>5216</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;fusion:=&nbsp;[];
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5217"></a>5217</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;pos:=&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5218"></a>5218</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;1&nbsp;..&nbsp;Length(&nbsp;minima&nbsp;)&nbsp;-&nbsp;1&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5219"></a>5219</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;[&nbsp;minima[i]&nbsp;+&nbsp;1&nbsp;..&nbsp;minima[i+1]&nbsp;-&nbsp;1&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5220"></a>5220</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsBound(&nbsp;fusion[j]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5221"></a>5221</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fusion[j]:=&nbsp;pos;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5222"></a>5222</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos:=&nbsp;pos&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5223"></a>5223</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5224"></a>5224</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5225"></a>5225</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;nontrivblocks[i]&nbsp;do&nbsp;fusion[j]:=&nbsp;pos;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5226"></a>5226</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos:=&nbsp;pos&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5227"></a>5227</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5228"></a>5228</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;[&nbsp;minima[&nbsp;Length(&nbsp;minima&nbsp;)&nbsp;]&nbsp;+&nbsp;1&nbsp;..&nbsp;Length(&nbsp;mat[1]&nbsp;)&nbsp;]&nbsp;do
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5229"></a>5229</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;IsBound(&nbsp;fusion[i]&nbsp;)&nbsp;then
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5230"></a>5230</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fusion[i]:=&nbsp;pos;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5231"></a>5231</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos:=&nbsp;pos&nbsp;+&nbsp;1;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5232"></a>5232</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5233"></a>5233</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;od;
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5234"></a>5234</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5235"></a>5235</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;values:=&nbsp;ProjectionMap(&nbsp;fusion&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5236"></a>5236</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;rec(&nbsp;mat:=&nbsp;List(&nbsp;mat,&nbsp;x&nbsp;->&nbsp;x{&nbsp;values&nbsp;}&nbsp;),
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5237"></a>5237</td><td></td><td></td><td></td><td><span><tt>#T&nbsp;do&nbsp;I&nbsp;really&nbsp;need&nbsp;the&nbsp;component&nbsp;'mat'?
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5238"></a>5238</td><td></td><td></td><td></td><td><span><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fusion:=&nbsp;fusion&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5239"></a>5239</td><td></td><td></td><td></td><td><span><tt>end&nbsp;);
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5240"></a>5240</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5241"></a>5241</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5242"></a>5242</td><td></td><td></td><td></td><td><span><tt>#############################################################################
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5243"></a>5243</td><td></td><td></td><td></td><td><span><tt>##
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5244"></a>5244</td><td></td><td></td><td></td><td><span><tt>#E
</tt></span></td><td><span></span></td></tr>
<tr class='ignore'><td><a name="line5245"></a>5245</td><td></td><td></td><td></td><td><span><tt>
</tt></span></td><td><span></span></td></tr>
</tbody>
</table></body></html>
